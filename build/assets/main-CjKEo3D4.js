import{_ as w}from"./preload-helper-Tcd9XBoB.js";import{l as H}from"./logger-BTW-zIW3.js";import{l as ye,c as ke,n as j,T as Se,H as _e}from"./highlight-in-textarea-D0Dt3T53.js";import{c as $,r as Ee}from"./_MapCache-DN36xuwU.js";import{i as qe,s as Le}from"./set-DMzY-ey4.js";import{r as B,w as Ce,n as y}from"./runtime-core.esm-bundler-DpP2Prln.js";import"./index-BHzFOpFs.js";import"./index-BbP3371Q.js";(async()=>{var R;var U=/\s/;function G(e){for(var t=e.length;t--&&U.test(e.charAt(t)););return t}var J=/^\s+/;function K(e){return e&&e.slice(0,G(e)+1).replace(J,"")}var A=NaN,Q=/^[-+]0x[0-9a-f]+$/i,X=/^0b[01]+$/i,Y=/^0o[0-7]+$/i,Z=parseInt;function M(e){if(typeof e=="number")return e;if(qe(e))return A;if($(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=$(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=K(e);var a=X.test(e);return a||Y.test(e)?Z(e.slice(2),a?2:8):Q.test(e)?A:+e}var k=function(){return Ee.Date.now()},ee="Expected a function",te=Math.max,ae=Math.min;function ne(e,t,a){var n,o,u,c,i,d,m=0,F=!1,h=!1,L=!0;if(typeof e!="function")throw new TypeError(ee);t=M(t)||0,$(a)&&(F=!!a.leading,h="maxWait"in a,u=h?te(M(a.maxWait)||0,t):u,L="trailing"in a?!!a.trailing:L);function C(r){var l=n,v=o;return n=o=void 0,m=r,c=e.apply(v,l),c}function fe(r){return m=r,i=setTimeout(g,t),F?C(r):c}function be(r){var l=r-d,v=r-m,W=t-l;return h?ae(W,u-v):W}function z(r){var l=r-d,v=r-m;return d===void 0||l>=t||l<0||h&&v>=u}function g(){var r=k();if(z(r))return V(r);i=setTimeout(g,be(r))}function V(r){return i=void 0,L&&n?C(r):(n=o=void 0,c)}function ge(){i!==void 0&&clearTimeout(i),m=0,n=d=o=i=void 0}function we(){return i===void 0?c:V(k())}function T(){var r=k(),l=z(r);if(n=arguments,o=this,d=r,l){if(i===void 0)return fe(d);if(h)return clearTimeout(i),i=setTimeout(g,t),C(d)}return i===void 0&&(i=setTimeout(g,t)),c}return T.cancel=ge,T.flush=we,T}const re=document.querySelector("#app"),f=re.__vue__,S=(R=document.querySelector("#app #iframe"))==null?void 0:R.contentDocument.querySelector("#breakdance_canvas"),x=S.__vue__;(async()=>(await ye(w(()=>import("./wasm-CsTmP73Z.js"),[],import.meta.url)),await ke({themes:[w(()=>import("./dark-plus-KEYLhlmT.js"),[],import.meta.url),w(()=>import("./light-plus-BsvsQ1iS.js"),[],import.meta.url)],langs:[w(()=>import("./css-CbYhyuC0.js"),[],import.meta.url)]})))();const s=document.createRange().createContextualFragment(`
    <textarea id="windpressbreakdance-plc-input" class="windpressbreakdance-plc-input" rows="2" spellcheck="false"></textarea>
`).querySelector("#windpressbreakdance-plc-input"),_=document.createElement("div");_.classList.add("windpressbreakdance-plc-input-container"),_.appendChild(s);const ie=document.createRange().createContextualFragment(`
    <div class="windpressbreakdance-plc-action-container">
        <div class="actions">
        </div>
    </div>
`).querySelector(".windpressbreakdance-plc-action-container"),se=ie.querySelector(".actions"),oe=document.createRange().createContextualFragment(`
    <span id="windpressbreakdance-plc-class-sort" class="bricks-svg-wrapper windpressbreakdance-plc-class-sort" data-balloon="Automatic Class Sorting" data-balloon-pos="bottom-right">
        <svg  xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round" class="bricks-svg icon icon-tabler icons-tabler-outline icon-tabler-reorder"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" /><path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" /><path d="M17 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" /><path d="M5 11v-3a3 3 0 0 1 3 -3h8a3 3 0 0 1 3 3v3" /><path d="M16.5 8.5l2.5 2.5l2.5 -2.5" /></svg>    
    </span>
`).querySelector("#windpressbreakdance-plc-class-sort");se.appendChild(oe);const I=B(!1),N=B(null);let P=null;j(s);let D=[];wp.hooks.addAction("windpressbreakdance-autocomplete-items-refresh","windpressbreakdance",()=>{D=wp.hooks.applyFilters("windpressbreakdance-autocomplete-items",[],s.value)}),wp.hooks.doAction("windpressbreakdance-autocomplete-items-refresh");const p=new Se({menuContainer:document.querySelector("#app"),containerClass:"windpressbreakdance-tribute-container",autocompleteMode:!0,menuItemLimit:50,noMatchTemplate:"",values:async function(e,t){const a=await wp.hooks.applyFilters("windpressbreakdance-autocomplete-items-query",D,e);t(a)},lookup:"value",itemClass:"class-item",menuItemTemplate:function(e){let t="";return e.original.color!==void 0&&(t+=`background-color: ${e.original.color};`),e.original.fontWeight!==void 0&&(t+=`font-weight: ${e.original.fontWeight};`),`
            <span class="class-name" data-tribute-class-name="${e.original.value}">${e.string}</span>
            <span class="class-hint" style="${t}"></span>
        `}});p.setMenuContainer=function(e){this.menuContainer=e};const ce=p.events.callbacks;p.events.callbacks=function(){return{...ce.call(this),up:(e,t)=>{if(this.tribute.isActive&&this.tribute.current.filteredItems){e.preventDefault(),e.stopPropagation();let a=this.tribute.current.filteredItems.length,n=this.tribute.menuSelected;a>n&&n>0?(this.tribute.menuSelected--,this.setActiveLi()):n===0&&(this.tribute.menuSelected=a-1,this.setActiveLi(),this.tribute.menu.scrollTop=this.tribute.menu.scrollHeight),O()}},down:(e,t)=>{if(this.tribute.isActive&&this.tribute.current.filteredItems){e.preventDefault(),e.stopPropagation();let a=this.tribute.current.filteredItems.length-1,n=this.tribute.menuSelected;a>n?(this.tribute.menuSelected++,this.setActiveLi()):a===n&&(this.tribute.menuSelected=0,this.setActiveLi(),this.tribute.menu.scrollTop=0),O()}}}},p.attach(s),f.$store.subscribeAction((e,t)=>{e.type==="ui/activateElement"&&(N.value=e.payload),e.type==="ui/setLeftSidebarState"&&(I.value=e.payload==="elementproperties")}),Ce([N,I],(e,t)=>{e[0]!==t[0]&&y(()=>{le(),me()}),e[0]&&e[1]&&y(()=>{const a=document.querySelector(".breakdance-element-properties-panel .vscroll-scroll .vscroll-scroll");a.querySelector(".windpressbreakdance-plc-input")===null&&a.insertBefore(_,a.firstChild)})}),P=new _e(s,{highlight:[{highlight:new RegExp("(?<=\\s|^)(?:(?!\\s).)+(?=\\s|$)","g"),className:"word"},{highlight:new RegExp("(?<=\\s)\\s","g"),className:"multispace",blank:!0}]});async function le(){var e,t,a,n;s.value=((n=(a=(t=(e=f.$store.getters["ui/activeElement"].data.properties)==null?void 0:e.settings)==null?void 0:t.advanced)==null?void 0:a.classes)==null?void 0:n.join(" "))||""}async function ue(){var n,o,u,c;if((c=(u=(o=(n=f.$store.getters["ui/activeElement"].data)==null?void 0:n.properties)==null?void 0:o.settings)==null?void 0:u.advanced)!=null&&c.classes)return!0;document.querySelector(".properties-panel-tab.breakdance-tab.breakdance-tab--id-settings").click();let e=document.querySelector("#settings .properties-panel-accordion.conditional-control-display-visible>div");for(;e===null;)e=document.querySelector("#settings .properties-panel-accordion.conditional-control-display-visible>div"),await new Promise(i=>setTimeout(i,100));e.parentElement.classList.contains("expanded")||e.click();let t=document.querySelector('#breakdance-class-input-search input[placeholder=".my-cool-class"]');for(;t===null;)t=document.querySelector('#breakdance-class-input-search input[placeholder=".my-cool-class"]'),await new Promise(i=>setTimeout(i,100));t.focus();const a="windpressbreakdance";return t.value=a,t.dispatchEvent(new Event("input",{bubbles:!0})),await new Promise(i=>setTimeout(i,100)),document.querySelector("#breakdance-class-input-search>button").click(),!0}const de=ne(pe,50);async function pe(){if(!await ue()){H("Upstream path not found!",{module:"plain-classes",type:"error"});return}s.focus(),Le(f.$store.getters["ui/activeElement"].data,"properties.settings.advanced.classes",s.value.trim().split(" ").filter(e=>e.trim()!=="")||[])}s.addEventListener("input",function(e){de()});function me(){y(()=>{try{P.handleInput()}catch{}j.update(s),p.hideMenu()})}const he=new MutationObserver(function(e){e.forEach(function(t){t.type==="childList"&&t.addedNodes.length>0&&t.addedNodes.forEach(a=>{const n=a.querySelector(".class-name").dataset.tributeClassName;a.addEventListener("mouseenter",o=>{E(n)}),a.addEventListener("mouseleave",o=>{q()}),a.addEventListener("click",o=>{q(),E(n)})})})});let b=null;s.addEventListener("tribute-active-true",function(e){b===null&&(b=document.querySelector(".windpressbreakdance-tribute-container>ul")),y(()=>{b&&he.observe(b,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class"]})})});function E(e){const t=x.$store.getters["ui/activeElement"].id,a=S.querySelector(`[data-node-id="${t}"]`);a.classList.add(e),a.dataset.tributeClassName=e}function q(){ve()}function O(){let e=p.menu.querySelector("li.highlight>span.class-name");q(),E(e.dataset.tributeClassName)}function ve(){const e=x.$store.getters["ui/activeElement"].id,t=S.querySelector(`[data-node-id="${e}"]`);t.dataset.tributeClassName&&(t.classList.remove(t.dataset.tributeClassName),t.dataset.tributeClassName="")}H("Module loaded!",{module:"plain-classes"})})();
