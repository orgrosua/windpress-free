import{i as ze,l as Me,r as Oe,b as Fe,L as Ve,_ as ee,T as je,P as De,K as Ue,M as He,N as Be,O as Re,__tla as Ne}from"./_plugin-vue_export-helper-B7AYZ_fF.js";import{l as te}from"./logger-BTW-zIW3.js";import{V as Ke}from"./index-DQMxDuq3.js";import{e as S,d as Xe}from"./constant-DeQ1iB0j.js";import{i as A,a as N,q as K,u as M,v as p,x as v,y,C as I,z as f,A as L,F as Ye,r as g,w as X,S as ae,J as W,K as P,E as O,M as F,Q as V,B as Y,G as Ge,H as Je,D as Qe,T as Ze}from"./runtime-core.esm-bundler-CuuCWbwv.js";import{_ as et}from"./lib-FVFXNsp8.js";import{__tla as tt}from"./build-6XnEkjQY.js";import{__tla as at}from"./oxide_parser_wasm-8nf_WcM4.js";import{g as nt}from"./intellisense-DggKt6it.js";import{a as st}from"./index-BtL5O8vF.js";import{s as lt}from"./set-qX46P2hw.js";import"./index-BHzFOpFs.js";import"./isObject-B5R9K1Pz.js";import"./preload-helper-Tcd9XBoB.js";import"./_MapCache-C7aBjWBU.js";import"./isSymbol-DJmTqBMq.js";Promise.all([(()=>{try{return Ne}catch{}})(),(()=>{try{return tt}catch{}})(),(()=>{try{return at}catch{}})()]).then(async()=>{ze({scope:"#windpressbreakdance-variable-app",variables:{bdewhite:"var(--white)",bdedark:"var(--dark)"}}),Me.add(Oe,Fe);const ne={id:"windpressbreakdance-variable-app-header",class:"cursor:grab bb:1|solid|$(gray200)"},se={class:"flex gap:10 align-items:center px:12 py:10 fg:$(bdedark)"},le=["href"],re={class:"text-transform:none font:medium flex gap:10 align-items:center cursor:default"},ie={__name:"PanelHeader",setup(s){const l=A("variableApp"),a=A("isOpen");function t(){const n=l.querySelector("#windpressbreakdance-variable-app-header");let o=g(!1),r=0,m=0;X(o,h=>{h?(document.body.style.userSelect="none",S.querySelector("div.v-application--wrap").style.pointerEvents="none",n.style.cursor="grabbing"):(document.body.style.removeProperty("user-select"),S.querySelector("div.v-application--wrap").style.removeProperty("pointer-events"),n.style.cursor="grab")});const i=h=>{o.value=!0;const u=n.getBoundingClientRect();r=h.clientX-u.left,m=h.clientY-u.top};n.removeEventListener("mousedown",i),n.addEventListener("mousedown",i);const $=h=>{if(!o.value)return;const u=n.getBoundingClientRect(),c=h.clientX,C=h.clientY,k=c-r,E=C-m,w=k<0?0:k>window.innerWidth-u.width?window.innerWidth-u.width:k,b=E<0?0:E>window.innerHeight-u.height?window.innerHeight-u.height:E;l.style.left=`${w}px`,l.style.top=`${b}px`};document.removeEventListener("mousemove",$),document.addEventListener("mousemove",$);const x=h=>{o.value=!1};document.removeEventListener("mouseup",x),document.addEventListener("mouseup",x)}return N(()=>{t()}),(n,o)=>{const r=K("inline-svg"),m=K("font-awesome-icon"),i=M("tooltip");return p(),v("div",ne,[y("div",se,[I((p(),v("a",{href:n.windpressbreakdance.site_meta.admin_url,target:"_blank",class:"flex align-items:center fg:$(bdedark) fg:$(blue600):hover"},[f(r,{src:L(Ve),class:"inline-svg fill:current font:24"},null,8,["src"])],8,le)),[[i,{placement:"top",content:"Open WindPress plugin"}]]),I((p(),v("div",re,[Ye(" WindPress ")])),[[i,{placement:"top",content:`v${n.windpressbreakdance._version}`}]]),I((p(),v("button",{onClick:o[0]||(o[0]=$=>a.value=!L(a)),class:"ml:auto py:4 px:8 r:4 fg:$(blue600):hover bg:$(blue50):hover"},[f(m,{icon:["fas","xmark"],class:"font:16"})])),[[i,{placement:"top",content:"Close"}]])])])}}},oe={class:"flex-grow:1"},ce={key:0,class:"expansion-panel__body"},ue={__name:"ExpansionPanel",props:{namespace:{type:String,required:!0},name:{type:String,required:!0}},setup(s,{expose:l}){const a=s,t=g(null),n=st(`windpressbreakdance-variable-app.ui.expansion-panels.${a.namespace}`,{[`${a.name}`]:!1},void 0,{mergeDefaults:!0});function o(m){n.value[a.name]=m===null?!n.value[a.name]:m}function r(){t.value.scrollIntoView()}return l({togglePanel:o,scrollIntoView:r}),(m,i)=>{const $=K("font-awesome-icon");return p(),v("div",{ref_key:"sectionRef",ref:t,class:"expansion-panel m:10 mr:4"},[y("div",{onClick:i[0]||(i[0]=x=>L(n)[s.name]=!L(n)[s.name]),class:W([{"bg:$(gray300)!":L(n)[s.name]},"expansion-panel__header flex bg:$(gray150) bg:$(gray300):hover justify-content:space-between p:10 r:8 cursor:pointer"])},[y("div",oe,[ae(m.$slots,"header",{},void 0,!0)]),y("div",null,[f($,{icon:["fas","chevron-right"],class:W([{"rotate(-90)":L(n)[s.name]},"~duration:300 font:18"])},null,8,["class"])])],2),f(je,null,{default:P(()=>[L(n)[s.name]?(p(),v("div",ce,[ae(m.$slots,"default",{},void 0,!0)])):O("",!0)]),_:3})],512)}}},j=ee(ue,[["__scopeId","data-v-29e444b4"]]),pe={class:"{m:10;pb:15}>div bb:1|solid|$(gray200)>div:not(:last-child)"},de={class:"variable-section-title font:14 my:10"},ve={class:"variable-section-items flex flex:row gap:8 flex-wrap:wrap"},me=["onClick","onMouseenter"],be={class:"font:14"},G={__name:"CommonVariableItems",props:{variableItems:{type:Object,required:!0}},setup(s){return(l,a)=>{const t=M("tooltip");return p(),v("div",pe,[(p(!0),v(F,null,V(s.variableItems,(n,o)=>(p(),v("div",{key:o,class:""},[y("div",de,Y(o.replace("_","-")),1),y("div",ve,[n.length>0?(p(!0),v(F,{key:0},V(n,(r,m)=>I((p(),v("button",{key:m,onClick:i=>l.$emit("previewChose",i,r.key),onMouseenter:i=>l.$emit("previewEnter",i,r.key),onMouseleave:a[0]||(a[0]=i=>l.$emit("previewLeave")),class:"px:12 py:8 r:8 font:medium fg:$(bdedark) fg:$(accent-normal):hover bg:$(gray150) bg:$(gray300):hover b:0 cursor:pointer {opacity:.5}>span opacity:100:hover>span"},[y("span",be,Y(r.label),1)],40,me)),[[t,{placement:"top",content:`var(${r.key}, ${r.value})`}]])),128)):O("",!0)])]))),128))])}}},ye={class:"{m:10;pb:15}>div bb:1|solid|$(gray200)>div:not(:last-child)"},he={class:"variable-section-title font:14 my:10"},fe={key:0,class:"variable-section-items"},ge=["onClick","onMouseenter"],ke=["onClick","onMouseenter"],we={__name:"ColorVariableItems",props:{variableItems:{type:Object,required:!0}},setup(s){return(l,a)=>{const t=M("tooltip");return p(),v("div",ye,[(p(!0),v(F,null,V(s.variableItems,(n,o)=>(p(),v("div",{key:o,class:""},[y("div",he,Y(o),1),n.DEFAULT?(p(),v("div",fe,[I(y("button",{onClick:r=>l.$emit("previewChose",r,n.DEFAULT.key),onMouseenter:r=>l.$emit("previewEnter",r,n.DEFAULT.key),onMouseleave:a[0]||(a[0]=r=>l.$emit("previewLeave")),class:W([`bg:$(${n.DEFAULT.key.slice(2)})`,"w:full r:4 h:24 border:1|solid|transparent border:white:hover cursor:pointer"])},null,42,ge),[[t,{placement:"top",content:`var(${n.DEFAULT.key}, ${n.DEFAULT.value})`}]])])):O("",!0),n.shades&&Object.keys(n.shades).length>0?(p(),v("div",{key:1,class:W([[{},`grid-template-cols:repeat(${Object.keys(n.shades).length},auto)`],"variable-section-items grid r:4 overflow:hidden"])},[(p(!0),v(F,null,V(n.shades,(r,m)=>(p(),v("div",{key:m,class:"flex gap:10"},[I(y("button",{onClick:i=>l.$emit("previewChose",i,r.key),onMouseenter:i=>l.$emit("previewEnter",i,r.key),onMouseleave:a[1]||(a[1]=i=>l.$emit("previewLeave")),class:W([`bg:$(${r.key.slice(2)})`,"w:full h:24 border:1|solid|transparent border:white:hover cursor:pointer"])},null,42,ke),[[t,{placement:"top",content:`var(${r.key}, ${r.value})`}]])]))),128))],2)):O("",!0)]))),128))])}}},D=s=>(Ge("data-v-c7c83d54"),s=s(),Je(),s),_e={id:"windpressbreakdance-variable-app-body",class:"rel w:full h:full overflow-y:scroll!"},$e=D(()=>y("span",{class:"font:semibold"},"Color",-1)),Ee=D(()=>y("span",{class:"font:semibold"},"Typography",-1)),Le=D(()=>y("span",{class:"font:semibold"},"Sizing",-1)),Pe=1e3,xe={__name:"PanelBody",setup(s){const l=g({colors:{},typography:{},sizing:{}}),a=A("focusedInput"),t=A("recentVariableSelectionTimestamp"),n=A("tempInputValue");async function o(){const u=await Xe.contentWindow.wp.hooks.applyFilters("windpress.module.design_system.main_css"),c=nt(et(u));let C=document.querySelector("#windpressbreakdance-variable-app-body"),k=C.querySelector("style#windpressbreakdance-variable-app-body-style");k||(k=document.createElement("style"),k.id="windpressbreakdance-variable-app-body-style",C.appendChild(k)),k.innerHTML=`
        #windpressbreakdance-variable-app-body {
            ${c.map(e=>`${e.key}:${e.value};`).join("")}
        }
    `;const E={};c.filter(e=>e.key.startsWith("--color")).forEach(e=>{const d=e.key.slice(8),B=d.split("-");let R="";if(B.length>1){const We=B[0],qe=B.slice(1).join("-");R=`${We}.shades.'${qe}'`}else R=`${d}.DEFAULT`;lt(E,R,e)}),l.value.colors=Object.keys(E).sort().reduce((e,d)=>(e[d]=E[d],e),{});const w={font_size:[],line_height:[],letter_spacing:[]};c.filter(e=>e.key.startsWith("--font-size-")&&!e.key.endsWith("--line-height")).forEach(e=>{const d=e.key.slice(12);w.font_size.push({key:e.key,label:d,value:e.value})}),c.filter(e=>e.key.startsWith("--line-height-")||e.key.endsWith("--line-height")).forEach(e=>{const d=e.key.startsWith("--line-height-")?e.key.slice(14):e.key.slice(2,-13);w.line_height.push({key:e.key,label:d,value:e.value})}),w.line_height.sort((e,d)=>e.label.startsWith("font-size-")&&!d.label.startsWith("font-size-")?1:!e.label.startsWith("font-size-")&&d.label.startsWith("font-size-")?-1:0),c.filter(e=>e.key.startsWith("--letter-spacing-")).forEach(e=>{const d=e.key.slice(17);w.letter_spacing.push({key:e.key,label:d,value:e.value})}),l.value.typography=w;const b={spacing:[],width:[],breakpoint:[]};c.filter(e=>e.key.startsWith("--spacing-")).forEach(e=>{const d=e.key.slice(10);b.spacing.push({key:e.key,label:d,value:e.value})}),c.filter(e=>e.key.startsWith("--width-")).forEach(e=>{const d=e.key.slice(8);b.width.push({key:e.key,label:d,value:e.value})}),c.filter(e=>e.key.startsWith("--breakpoint-")).forEach(e=>{const d=e.key.slice(13);b.breakpoint.push({key:e.key,label:d,value:e.value})}),l.value.sizing=b}const r=g(null),m=g(null),i=g(null);X(a,u=>{if(u){const c=u.closest("[data-test-id]"),C=["color"].some(b=>c.getAttribute("data-test-id").includes(b)),k=["fontSize"].some(b=>c.getAttribute("data-test-id").includes(b)),E=["spacing","size-width"].some(b=>c.getAttribute("data-test-id").includes(b));m.value.togglePanel(!1),i.value.togglePanel(!1),r.value.togglePanel(!1);async function w(){for(;u.parentElement.parentElement.parentElement.querySelector("div.dropdown>button.breakdance-unit-input-unit")===null;)await new Promise(b=>setTimeout(b,10));for(u.parentElement.parentElement.parentElement.querySelector("div.dropdown>button.breakdance-unit-input-unit").click();document.querySelector(".v-menu__content.menuable__content__active .dropdown-content .v-list .v-list-item:last-child .v-list-item__title")===null;)await new Promise(b=>setTimeout(b,10));document.querySelector(".v-menu__content.menuable__content__active .dropdown-content .v-list .v-list-item:last-child .v-list-item__title").click(),setTimeout(()=>{u.focus()},100)}C?(r.value.togglePanel(!0),r.value.scrollIntoView()):k?(m.value.togglePanel(!0),m.value.scrollIntoView(),w()):E&&(i.value.togglePanel(!0),i.value.scrollIntoView(),w())}});function $(u,c){performance.now()-t.value<Pe||a.value&&(a.value.value=`var(${c})`,a.value.dispatchEvent(new Event("input")),a.value.focus())}function x(u){!a.value||n.value===null||(a.value.value=n.value,a.value.dispatchEvent(new Event("input")),a.value.focus())}function h(u,c){a.value&&(a.value.value=`var(${c})`,a.value.dispatchEvent(new Event("input")),a.value.focus(),n.value=`var(${c})`,t.value=performance.now())}return N(()=>{o()}),new BroadcastChannel("windpress").addEventListener("message",async u=>{const c=u.data;c.source==="windpress/autocomplete"&&c.task==="windpress.main_css.saved.done"&&setTimeout(()=>{o()},1e3)}),(u,c)=>(p(),v("div",_e,[f(j,{namespace:"variable",name:"color",ref_key:"sectionColor",ref:r},{header:P(()=>[$e]),default:P(()=>[f(we,{variableItems:l.value.colors,onPreviewEnter:$,onPreviewLeave:x,onPreviewChose:h},null,8,["variableItems"])]),_:1},512),f(j,{namespace:"variable",name:"typography",ref_key:"sectionTypography",ref:m},{header:P(()=>[Ee]),default:P(()=>[f(G,{variableItems:l.value.typography,onPreviewEnter:$,onPreviewLeave:x,onPreviewChose:h},null,8,["variableItems"])]),_:1},512),f(j,{namespace:"variable",name:"spacing",ref_key:"sectionSpacing",ref:i,class:""},{header:P(()=>[Le]),default:P(()=>[f(G,{variableItems:l.value.sizing,onPreviewEnter:$,onPreviewLeave:x,onPreviewChose:h},null,8,["variableItems"])]),_:1},512)]))}},Ie=ee(xe,[["__scopeId","data-v-c7c83d54"]]),Ce={__name:"App",setup(s){const l=A("isOpen"),a=g(null);function t(){S.classList.contains("theme--light")?(a.value.classList.add("theme--light"),a.value.classList.remove("theme--dark")):S.classList.contains("theme--dark")&&(a.value.classList.add("theme--dark"),a.value.classList.remove("theme--light"))}return new MutationObserver(n=>{n.forEach(o=>{o.attributeName==="class"&&t()})}).observe(S,{attributes:!0,attributeFilter:["class"],childList:!1,subtree:!1}),N(()=>{t()}),(n,o)=>{const r=M("resizable");return I((p(),v("div",{id:"windpressbreakdance-variable-app-container",ref_key:"containerRef",ref:a,class:"v-application flex flex:column w:full h:full r:10 overflow:hidden outline:1|solid|$(blue200)"},[f(ie),(p(),Qe(Ze,null,{default:P(()=>[f(Ie)]),_:1}))])),[[De,L(l)],[r,{minWidth:300,minHeight:500},void 0,{br:!0}]])}}};function Se({selector:s,callback:l,options:a}){const t=new MutationObserver(l),n=document.querySelector(s);if(!n){te(`Target not found for selector: ${s}`,{module:"variable-picker",type:"error"});return}const o={childList:!0,subtree:!0};t.observe(n,Object.assign(Object.assign({},o),a))}const q=document.createElement("windpressbreakdance-variable-app");q.id="windpressbreakdance-variable-app",S.appendChild(q);const T=g(!1),z=g(null),U=g(null),Ae=g(0);g(null);const _=Ue(Ce);_.config.globalProperties.windpressbreakdance=window.windpressbreakdance,_.provide("variableApp",q),_.provide("isOpen",T),_.provide("focusedInput",z),_.provide("tempInputValue",U),_.provide("recentVariableSelectionTimestamp",Ae),_.use(He,{container:"#windpressbreakdance-variable-app"}).use(Ke),_.component("font-awesome-icon",Be).component("inline-svg",Re),_.mount("#windpressbreakdance-variable-app");function J(s){var l;!s.shiftKey||!s.target||((l=document==null?void 0:document.getSelection())==null||l.removeAllRanges(),s.preventDefault(),s.stopPropagation(),z.value=s.target,U.value=s.target.value,T.value=!0)}function Q(s){z.value=s.target}const Te={includedFields:["div.breakdance-control-wrapper-input-wrapper div.breakdance-text-input-wrapper"],excludedFields:[]};function Z(){setTimeout(()=>{let s=!1;Te.includedFields.forEach(l=>{(typeof l=="string"?[...document.querySelectorAll(l)]:[...document.querySelectorAll(l.selector)].filter(a=>l.hasChild.some(t=>a.querySelector(t)))).forEach(a=>{const t=a.querySelector("input[type='text']");(t==null?void 0:t.getAttribute("windpressbreakdance-variable-app"))!=="true"&&(t==null||t.removeEventListener("click",J),t==null||t.addEventListener("click",J),t==null||t.removeEventListener("focus",Q),t==null||t.addEventListener("focus",Q),t==null||t.setAttribute("windpressbreakdance-variable-app","true"),t==null||t.parentNode.setAttribute("data-tooltip-place","top"),t==null||t.parentNode.setAttribute("data-tooltip-content","Shift + click to open the Variable Picker"),s=!0)})}),s&&(z.value=null,U.value=null)},100)}let H=!1;Se({selector:"div:has(>div.breakdance-add-panel)",options:{subtree:!0,childList:!0},callback(){H||(H=!0,Z(),setTimeout(()=>{H=!1},100))}}),Z(),document.addEventListener("keydown",s=>{s.key==="Escape"&&T.value&&(T.value=!1)}),X(T,s=>{q.style.zIndex=s?"calc(Infinity)":"-1"}),te("Module loaded!",{module:"variable-picker"})});
