import{i as ze,l as Me,r as Oe,b as Fe,L as je,_ as ee,T as Ve,P as De,K as Ue,M as Be,N as He,O as Re}from"./_plugin-vue_export-helper-Cps8Wh2c.js";import{l as te}from"./logger-BTW-zIW3.js";import{e as S,d as Ke}from"./constant-DeQ1iB0j.js";import{i as P,a as R,q as K,u as N,v as p,x as v,y as b,z as f,A as I,C as T,F as Ne,r as g,w as Q,S as ae,J as q,K as L,E as M,M as O,Q as F,B as X,G as Qe,H as Xe,D as Ye,T as Ge}from"./runtime-core.esm-bundler-C0d2UZ6m.js";import{Q as Je}from"./lib-BXT8389d.js";import{__tla as Ze}from"./build-Km0EQ9ar.js";import{__tla as et}from"./oxide_parser_wasm-8nf_WcM4.js";import{g as tt}from"./intellisense-CgzKx6Lg.js";import{a as at}from"./index-B-USwDm2.js";import{s as nt}from"./set-qX46P2hw.js";import"./index-BHzFOpFs.js";import"./isObject-B5R9K1Pz.js";import"./preload-helper-Tcd9XBoB.js";import"./_MapCache-C7aBjWBU.js";import"./isSymbol-DJmTqBMq.js";Promise.all([(()=>{try{return Ze}catch{}})(),(()=>{try{return et}catch{}})()]).then(async()=>{ze({scope:"#windpressbreakdance-variable-app"}),Me.add(Oe,Fe);const ne={id:"windpressbreakdance-variable-app-header",class:"cursor:grab bb:1|solid|$(gray200)"},se={class:"flex gap:10 align-items:center fg:var(dark)"},le={class:"flex align-items:center px:12 py:2"},ie={class:"text-transform:none font:medium text:center flex-grow:1 gap:10 align-items:center cursor:default px:12 py:2"},re={__name:"PanelHeader",setup(s){const l=P("variableApp"),t=P("isOpen");function n(){const a=l.querySelector("#windpressbreakdance-variable-app-header");let r=g(!1),i=0,d=0;Q(r,y=>{y?(document.body.style.userSelect="none",S.querySelector("div.v-application--wrap").style.pointerEvents="none",a.style.cursor="grabbing"):(document.body.style.removeProperty("user-select"),S.querySelector("div.v-application--wrap").style.removeProperty("pointer-events"),a.style.cursor="grab")});const o=y=>{r.value=!0;const h=a.getBoundingClientRect();i=y.clientX-h.left,d=y.clientY-h.top};a.removeEventListener("mousedown",o),a.addEventListener("mousedown",o);const w=y=>{if(!r.value)return;const h=a.getBoundingClientRect(),m=y.clientX,c=y.clientY,k=m-i,E=c-d,$=k<0?0:k>window.innerWidth-h.width?window.innerWidth-h.width:k,x=E<0?0:E>window.innerHeight-h.height?window.innerHeight-h.height:E;l.style.left=`${$}px`,l.style.top=`${x}px`};document.removeEventListener("mousemove",w),document.addEventListener("mousemove",w);const C=y=>{r.value=!1};document.removeEventListener("mouseup",C),document.addEventListener("mouseup",C)}return R(()=>{n()}),(a,r)=>{const i=K("inline-svg"),d=K("font-awesome-icon"),o=N("tooltip");return p(),v("div",ne,[b("div",se,[b("div",le,[f(i,{src:I(je),class:"inline-svg fill:current font:24"},null,8,["src"])]),T((p(),v("div",ie,[Ne(" WindPress ")])),[[o,{placement:"top",content:`v${a.windpressbreakdance._version}`}]]),T((p(),v("button",{onClick:r[0]||(r[0]=w=>t.value=!I(t)),class:"flex align-items:center py:10 px:12 fg:$(blue600):hover bg:$(blue50):hover"},[f(d,{icon:["fas","xmark"],class:"font:16"})])),[[o,{placement:"top",content:"Close"}]])])])}}},oe={class:"flex-grow:1"},ce={key:0,class:"expansion-panel__body"},ue={__name:"ExpansionPanel",props:{namespace:{type:String,required:!0},name:{type:String,required:!0}},setup(s,{expose:l}){const t=s,n=g(null),a=at(`windpressbreakdance-variable-app.ui.expansion-panels.${t.namespace}`,{[`${t.name}`]:!1},void 0,{mergeDefaults:!0});function r(d){a.value[t.name]=d===null?!a.value[t.name]:d}function i(){n.value.scrollIntoView()}return l({togglePanel:r,scrollIntoView:i}),(d,o)=>{const w=K("font-awesome-icon");return p(),v("div",{ref_key:"sectionRef",ref:n,class:"expansion-panel mx:10 py:8 mr:4"},[b("div",{onClick:o[0]||(o[0]=C=>I(a)[s.name]=!I(a)[s.name]),class:q([{},"expansion-panel__header flex justify-content:space-between p:10 r:8 cursor:pointer"])},[b("div",oe,[ae(d.$slots,"header",{},void 0,!0)]),b("div",null,[f(w,{icon:["fas","chevron-right"],class:q([{"rotate(-90)":I(a)[s.name]},"~duration:300 font:18"])},null,8,["class"])])]),f(Ve,null,{default:L(()=>[I(a)[s.name]?(p(),v("div",ce,[ae(d.$slots,"default",{},void 0,!0)])):M("",!0)]),_:3})],512)}}},j=ee(ue,[["__scopeId","data-v-bf8eab20"]]),pe={class:"{m:10;pb:15}>div"},de={class:"variable-section-title font:14 my:10"},ve={class:"variable-section-items flex flex:row gap:8 flex-wrap:wrap"},me=["onClick","onMouseenter"],be={class:"font:14"},Y={__name:"CommonVariableItems",props:{variableItems:{type:Object,required:!0}},setup(s){return(l,t)=>{const n=N("tooltip");return p(),v("div",pe,[(p(!0),v(O,null,F(s.variableItems,(a,r)=>(p(),v("div",{key:r,class:""},[b("div",de,X(r.replace("_","-")),1),b("div",ve,[a.length>0?(p(!0),v(O,{key:0},F(a,(i,d)=>T((p(),v("button",{key:d,onClick:o=>l.$emit("previewChose",o,i.key),onMouseenter:o=>l.$emit("previewEnter",o,i.key),onMouseleave:t[0]||(t[0]=o=>l.$emit("previewLeave")),class:"px:12 py:8 r:8 font:medium fg:$(dark) fg:$(accent-normal):hover bg:$(gray150) bg:$(gray300):hover b:0 flex-grow:1 flex-shrink:1 flex-basis:30% cursor:pointer {opacity:.5}>span opacity:100:hover>span"},[b("span",be,X(i.label),1)],40,me)),[[n,{placement:"top",content:`var(${i.key}, ${i.value})`}]])),128)):M("",!0)])]))),128))])}}},ye={class:"{m:10;pb:15}>div"},fe={class:"variable-section-title font:14 my:10"},he={key:0,class:"variable-section-items"},ke=["onClick","onMouseenter"],ge=["onClick","onMouseenter"],we={__name:"ColorVariableItems",props:{variableItems:{type:Object,required:!0}},setup(s){return(l,t)=>{const n=N("tooltip");return p(),v("div",ye,[(p(!0),v(O,null,F(s.variableItems,(a,r)=>(p(),v("div",{key:r,class:""},[b("div",fe,X(r),1),a.DEFAULT?(p(),v("div",he,[T(b("button",{onClick:i=>l.$emit("previewChose",i,a.DEFAULT.key),onMouseenter:i=>l.$emit("previewEnter",i,a.DEFAULT.key),onMouseleave:t[0]||(t[0]=i=>l.$emit("previewLeave")),class:q([`bg:$(${a.DEFAULT.key.slice(2)})`,"w:full r:4 h:24 border:1|solid|transparent border:white:hover cursor:pointer"])},null,42,ke),[[n,{placement:"top",content:`var(${a.DEFAULT.key}, ${a.DEFAULT.value})`}]])])):M("",!0),a.shades&&Object.keys(a.shades).length>0?(p(),v("div",{key:1,class:q([[{},Object.keys(a.shades).length>1?"rl:4>div:first-child>button rr:4>div:last-child>button":"",`grid-template-cols:repeat(${Object.keys(a.shades).length},auto)`],"variable-section-items grid r:4 overflow:hidden"])},[(p(!0),v(O,null,F(a.shades,(i,d)=>(p(),v("div",{key:d,class:"flex gap:10"},[T(b("button",{onClick:o=>l.$emit("previewChose",o,i.key),onMouseenter:o=>l.$emit("previewEnter",o,i.key),onMouseleave:t[1]||(t[1]=o=>l.$emit("previewLeave")),class:q([`bg:$(${i.key.slice(2)})`,"w:full h:24 border:1|solid|transparent border:white:hover cursor:pointer"])},null,42,ge),[[n,{placement:"top",content:`var(${i.key}, ${i.value})`}]])]))),128))],2)):M("",!0)]))),128))])}}},V=s=>(Qe("data-v-8a2b76be"),s=s(),Xe(),s),_e={id:"windpressbreakdance-variable-app-body",class:"rel w:full h:full overflow-y:scroll! bb:1|solid|$(gray200)>div:not(:last-child)"},Ee=V(()=>b("span",{class:"font:semibold"},"Color",-1)),$e=V(()=>b("span",{class:"font:semibold"},"Typography",-1)),xe=V(()=>b("span",{class:"font:semibold"},"Sizing",-1)),Le=1e3,Ce={__name:"PanelBody",setup(s){const l=g({colors:{},typography:{},sizing:{}}),t=P("focusedInput"),n=P("recentVariableSelectionTimestamp"),a=P("tempInputValue"),r=P("variableApp");async function i(){const m=await Ke.contentWindow.wp.hooks.applyFilters("windpress.module.design_system.main_css"),c=await tt(await Je(m));let k=r.querySelector("style#windpressbreakdance-variable-app-body-style");k||(k=document.createElement("style"),k.id="windpressbreakdance-variable-app-body-style",r.appendChild(k)),k.innerHTML=`
        #windpressbreakdance-variable-app-body {
            ${c.map(e=>`${e.key}:${e.value};`).join("")}
        }
    `;const E={};c.filter(e=>e.key.startsWith("--color")).forEach(e=>{const u=e.key.slice(8),B=u.split("-");let H="";if(B.length>1){const qe=B[0],We=B.slice(1).join("-");H=`${qe}.shades.'${We}'`}else H=`${u}.DEFAULT`;nt(E,H,e)}),l.value.colors=Object.keys(E).sort().reduce((e,u)=>(e[u]=E[u],e),{});const $={font_size:[],line_height:[],letter_spacing:[]};c.filter(e=>e.key.startsWith("--font-size-")&&!e.key.endsWith("--line-height")).forEach(e=>{const u=e.key.slice(12);$.font_size.push({key:e.key,label:u,value:e.value})}),c.filter(e=>e.key.startsWith("--line-height-")||e.key.endsWith("--line-height")).forEach(e=>{const u=e.key.startsWith("--line-height-")?e.key.slice(14):e.key.slice(2,-13);$.line_height.push({key:e.key,label:u,value:e.value})}),$.line_height.sort((e,u)=>e.label.startsWith("font-size-")&&!u.label.startsWith("font-size-")?1:!e.label.startsWith("font-size-")&&u.label.startsWith("font-size-")?-1:0),c.filter(e=>e.key.startsWith("--letter-spacing-")).forEach(e=>{const u=e.key.slice(17);$.letter_spacing.push({key:e.key,label:u,value:e.value})}),l.value.typography=$;const x={spacing:[],width:[],breakpoint:[]};c.filter(e=>e.key.startsWith("--spacing-")).forEach(e=>{const u=e.key.slice(10);x.spacing.push({key:e.key,label:u,value:e.value})}),c.filter(e=>e.key.startsWith("--width-")).forEach(e=>{const u=e.key.slice(8);x.width.push({key:e.key,label:u,value:e.value})}),c.filter(e=>e.key.startsWith("--breakpoint-")).forEach(e=>{const u=e.key.slice(13);x.breakpoint.push({key:e.key,label:u,value:e.value})}),l.value.sizing=x}const d=g(null),o=g(null),w=g(null);Q(t,m=>{if(m){const c=m.closest("[data-test-id]"),k=["color"].some(e=>c.getAttribute("data-test-id").includes(e)),E=["fontSize"].some(e=>c.getAttribute("data-test-id").includes(e)),$=["spacing","size-width"].some(e=>c.getAttribute("data-test-id").includes(e));o.value.togglePanel(!1),w.value.togglePanel(!1),d.value.togglePanel(!1);async function x(){for(;m.parentElement.parentElement.parentElement.querySelector("div.dropdown>button.breakdance-unit-input-unit")===null;)await new Promise(e=>setTimeout(e,10));for(m.parentElement.parentElement.parentElement.querySelector("div.dropdown>button.breakdance-unit-input-unit").click();document.querySelector(".v-menu__content.menuable__content__active .dropdown-content .v-list .v-list-item:last-child .v-list-item__title")===null;)await new Promise(e=>setTimeout(e,10));document.querySelector(".v-menu__content.menuable__content__active .dropdown-content .v-list .v-list-item:last-child .v-list-item__title").click(),setTimeout(()=>{m.focus()},100)}k?(d.value.togglePanel(!0),d.value.scrollIntoView()):E?(o.value.togglePanel(!0),o.value.scrollIntoView(),x()):$&&(w.value.togglePanel(!0),w.value.scrollIntoView(),x())}});function C(m,c){performance.now()-n.value<Le||t.value&&(t.value.value=`var(${c})`,t.value.dispatchEvent(new Event("input")),t.value.focus())}function y(m){!t.value||a.value===null||(t.value.value=a.value,t.value.dispatchEvent(new Event("input")),t.value.focus())}function h(m,c){t.value&&(t.value.value=`var(${c})`,t.value.dispatchEvent(new Event("input")),t.value.focus(),a.value=`var(${c})`,n.value=performance.now())}return R(()=>{i()}),new BroadcastChannel("windpress").addEventListener("message",async m=>{const c=m.data;c.source==="windpress/autocomplete"&&c.task==="windpress.main_css.saved.done"&&setTimeout(()=>{i()},1e3)}),(m,c)=>(p(),v("div",_e,[f(j,{namespace:"variable",name:"color",ref_key:"sectionColor",ref:d},{header:L(()=>[Ee]),default:L(()=>[f(we,{variableItems:l.value.colors,onPreviewEnter:C,onPreviewLeave:y,onPreviewChose:h},null,8,["variableItems"])]),_:1},512),f(j,{namespace:"variable",name:"typography",ref_key:"sectionTypography",ref:o},{header:L(()=>[$e]),default:L(()=>[f(Y,{variableItems:l.value.typography,onPreviewEnter:C,onPreviewLeave:y,onPreviewChose:h},null,8,["variableItems"])]),_:1},512),f(j,{namespace:"variable",name:"spacing",ref_key:"sectionSpacing",ref:w,class:""},{header:L(()=>[xe]),default:L(()=>[f(Y,{variableItems:l.value.sizing,onPreviewEnter:C,onPreviewLeave:y,onPreviewChose:h},null,8,["variableItems"])]),_:1},512)]))}},Pe=ee(Ce,[["__scopeId","data-v-8a2b76be"]]),Ie={__name:"App",setup(s){const l=P("isOpen"),t=g(null);function n(){S.classList.contains("theme--light")?(t.value.classList.add("theme--light"),t.value.classList.remove("theme--dark")):S.classList.contains("theme--dark")&&(t.value.classList.add("theme--dark"),t.value.classList.remove("theme--light"))}return new MutationObserver(a=>{a.forEach(r=>{r.attributeName==="class"&&n()})}).observe(S,{attributes:!0,attributeFilter:["class"],childList:!1,subtree:!1}),R(()=>{n()}),(a,r)=>T((p(),v("div",{id:"windpressbreakdance-variable-app-container",ref_key:"containerRef",ref:t,class:"v-application flex flex:column w:full h:full"},[f(re),(p(),Ye(Ge,null,{default:L(()=>[f(Pe)]),_:1}))],512)),[[De,I(l)]])}};function Se({selector:s,callback:l,options:t}){const n=new MutationObserver(l),a=document.querySelector(s);if(!a){te(`Target not found for selector: ${s}`,{module:"variable-picker",type:"error"});return}const r={childList:!0,subtree:!0};n.observe(a,Object.assign(Object.assign({},r),t))}const W=document.createElement("windpressbreakdance-variable-app");W.id="windpressbreakdance-variable-app",S.appendChild(W);const A=g(!1),z=g(null),D=g(null),Te=g(0),_=Ue(Ie);_.config.globalProperties.windpressbreakdance=window.windpressbreakdance,_.provide("variableApp",W),_.provide("isOpen",A),_.provide("focusedInput",z),_.provide("tempInputValue",D),_.provide("recentVariableSelectionTimestamp",Te),_.use(Be,{container:"#windpressbreakdance-variable-app"}),_.component("font-awesome-icon",He).component("inline-svg",Re),_.mount("#windpressbreakdance-variable-app");function G(s){var l;!s.shiftKey||!s.target||((l=document==null?void 0:document.getSelection())==null||l.removeAllRanges(),s.preventDefault(),s.stopPropagation(),z.value=s.target,D.value=s.target.value,A.value=!0)}function J(s){z.value=s.target}const Ae={includedFields:["div.breakdance-control-wrapper-input-wrapper div.breakdance-text-input-wrapper"],excludedFields:[]};function Z(){setTimeout(()=>{let s=!1;Ae.includedFields.forEach(l=>{(typeof l=="string"?[...document.querySelectorAll(l)]:[...document.querySelectorAll(l.selector)].filter(t=>l.hasChild.some(n=>t.querySelector(n)))).forEach(t=>{const n=t.querySelector("input[type='text']");(n==null?void 0:n.getAttribute("windpressbreakdance-variable-app"))!=="listened"&&(n==null||n.removeEventListener("click",G),n==null||n.addEventListener("click",G),n==null||n.removeEventListener("focus",J),n==null||n.addEventListener("focus",J),n==null||n.setAttribute("windpressbreakdance-variable-app","listened"),s=!0)})}),s&&(z.value=null,D.value=null)},100)}let U=!1;Se({selector:"div:has(>div.breakdance-add-panel)",options:{subtree:!0,childList:!0},callback(){U||(U=!0,Z(),setTimeout(()=>{U=!1},100))}}),Z(),document.addEventListener("keydown",s=>{s.key==="Escape"&&A.value&&(A.value=!1)}),Q(A,s=>{W.style.zIndex=s?"calc(Infinity)":"-1"}),te("Module loaded!",{module:"variable-picker"})});
