import{i as Me,l as Ve,r as je,b as De,L as Fe,_ as ee,T as Be,P as He,K as Ue,M as Re,N as Ke,O as Ne,__tla as Xe}from"./_plugin-vue_export-helper-B7AYZ_fF.js";import{l as Ye}from"./logger-BTW-zIW3.js";import{V as Ge}from"./index-DQMxDuq3.js";import{a as te,u as Je}from"./constant-B0a9M2k0.js";import{i as S,a as se,q as X,u as M,v as u,x as d,y as f,C as L,z as w,A as C,F as Qe,r as _,w as V,S as ae,J as A,K as x,E as j,M as D,Q as F,B as Y,G as Ze,H as et,D as tt,T as st}from"./runtime-core.esm-bundler-CuuCWbwv.js";import{_ as at}from"./lib-FVFXNsp8.js";import{__tla as nt}from"./build-6XnEkjQY.js";import{__tla as lt}from"./oxide_parser_wasm-8nf_WcM4.js";import{g as rt}from"./intellisense-DggKt6it.js";import{a as it}from"./index-BtL5O8vF.js";import{s as ot}from"./set-qX46P2hw.js";import"./index-BHzFOpFs.js";import"./isObject-B5R9K1Pz.js";import"./preload-helper-Tcd9XBoB.js";import"./_MapCache-C7aBjWBU.js";import"./isSymbol-DJmTqBMq.js";Promise.all([(()=>{try{return Xe}catch{}})(),(()=>{try{return nt}catch{}})(),(()=>{try{return lt}catch{}})()]).then(async()=>{Me({scope:"#windpressbuilderius-variable-app"}),Ve.add(je,De);const ne={id:"windpressbuilderius-variable-app-header",class:"bg:$(primary-1) cursor:grab bb:1|solid|$(primary-3)"},le={class:"flex gap:10 align-items:center px:12 py:10 fg:$(base-2)"},re=["href"],ie={class:"text-transform:none font:medium flex gap:10 align-items:center cursor:default"},oe={__name:"PanelHeader",setup(s){const n=S("variableApp"),l=S("isOpen");function c(){const a=n.querySelector("#windpressbuilderius-variable-app-header");let t=_(!1),r=0,v=0;V(t,h=>{h?(document.body.style.userSelect="none",te.style.pointerEvents="none",a.style.cursor="grabbing"):(document.body.style.removeProperty("user-select"),te.style.removeProperty("pointer-events"),a.style.cursor="grab")});const o=h=>{t.value=!0;const k=a.getBoundingClientRect();r=h.clientX-k.left,v=h.clientY-k.top};a.removeEventListener("mousedown",o),a.addEventListener("mousedown",o);const P=h=>{if(!t.value)return;const k=a.getBoundingClientRect(),m=h.clientX,i=h.clientY,g=m-r,y=i-v,$=g<0?0:g>window.innerWidth-k.width?window.innerWidth-k.width:g,b=y<0?0:y>window.innerHeight-k.height?window.innerHeight-k.height:y;n.style.left=`${$}px`,n.style.top=`${b}px`};document.removeEventListener("mousemove",P),document.addEventListener("mousemove",P);const I=h=>{t.value=!1};document.removeEventListener("mouseup",I),document.addEventListener("mouseup",I)}return se(()=>{c()}),(a,t)=>{const r=X("inline-svg"),v=X("font-awesome-icon"),o=M("tooltip");return u(),d("div",ne,[f("div",le,[L((u(),d("a",{href:a.windpressbuilderius.site_meta.admin_url,target:"_blank",class:"flex align-items:center fg:$(base-2) fg:$(accent-normal):hover"},[w(r,{src:C(Fe),class:"inline-svg fill:current font:24"},null,8,["src"])],8,re)),[[o,{placement:"top",content:"Open WindPress plugin"}]]),L((u(),d("div",ie,[Qe(" WindPress ")])),[[o,{placement:"top",content:`v${a.windpressbuilderius._version}`}]]),L((u(),d("button",{onClick:t[0]||(t[0]=P=>l.value=!C(l)),class:"uniPanelIconButton uniIconCssMode ml:auto p:6"},[w(v,{icon:["fas","xmark"],class:"fg:$(base-2) font:16"})])),[[o,{placement:"top",content:"Close"}]])])])}}},ue={class:"flex-grow:1"},ce={key:0,class:"expansion-panel__body"},pe={__name:"ExpansionPanel",props:{namespace:{type:String,required:!0},name:{type:String,required:!0}},setup(s,{expose:n}){const l=s,c=_(null),a=it(`windpressbuilderius-variable-app.ui.expansion-panels.${l.namespace}`,{[`${l.name}`]:!1},void 0,{mergeDefaults:!0});function t(v){a.value[l.name]=v===null?!a.value[l.name]:v}function r(){c.value.scrollIntoView()}return n({togglePanel:t,scrollIntoView:r}),(v,o)=>{const P=X("font-awesome-icon");return u(),d("div",{ref_key:"sectionRef",ref:c,class:"expansion-panel m:10 mr:4"},[f("div",{onClick:o[0]||(o[0]=I=>C(a)[s.name]=!C(a)[s.name]),class:A([{"bg:$(primary-3)!":C(a)[s.name]},"expansion-panel__header flex bg:$(primary-2) bg:$(primary-3):hover justify-content:space-between p:10 r:8 cursor:pointer"])},[f("div",ue,[ae(v.$slots,"header",{},void 0,!0)]),f("div",null,[w(P,{icon:["fas","chevron-right"],class:A([{"rotate(-90)":C(a)[s.name]},"~duration:300 font:18"])},null,8,["class"])])],2),w(Be,null,{default:x(()=>[C(a)[s.name]?(u(),d("div",ce,[ae(v.$slots,"default",{},void 0,!0)])):j("",!0)]),_:3})],512)}}},B=ee(pe,[["__scopeId","data-v-6644ab81"]]),de={class:"{m:10;pb:15}>div bb:1|solid|$(primary-3)>div:not(:last-child)"},ve={class:"variable-section-title font:14 my:10"},me={class:"variable-section-items flex flex:row gap:8 flex-wrap:wrap"},be=["onClick","onMouseenter"],ye={class:"font:14"},G={__name:"CommonVariableItems",props:{variableItems:{type:Object,required:!0}},setup(s){return(n,l)=>{const c=M("tooltip");return u(),d("div",de,[(u(!0),d(D,null,F(s.variableItems,(a,t)=>(u(),d("div",{key:t,class:""},[f("div",ve,Y(t.replace("_","-")),1),f("div",me,[a.length>0?(u(!0),d(D,{key:0},F(a,(r,v)=>L((u(),d("button",{key:v,onClick:o=>n.$emit("previewChose",o,r.key),onMouseenter:o=>n.$emit("previewEnter",o,r.key),onMouseleave:l[0]||(l[0]=o=>n.$emit("previewLeave")),class:"px:12 py:8 r:8 fg:$(base-1) fg:$(accent-normal):hover bg:$(primary-3) bg:$(primary-2):hover b:0 cursor:pointer {opacity:.5}>span opacity:100:hover>span"},[f("span",ye,Y(r.label),1)],40,be)),[[c,{placement:"top",content:`var(${r.key})`}]])),128)):j("",!0)])]))),128))])}}},fe={class:"{m:10;pb:15}>div bb:1|solid|$(primary-3)>div:not(:last-child)"},he={class:"variable-section-title font:14 my:10"},ge={key:0,class:"variable-section-items"},we=["onClick","onMouseenter"],ke=["onClick","onMouseenter"],_e={__name:"ColorVariableItems",props:{variableItems:{type:Object,required:!0}},setup(s){return(n,l)=>{const c=M("tooltip");return u(),d("div",fe,[(u(!0),d(D,null,F(s.variableItems,(a,t)=>(u(),d("div",{key:t,class:""},[f("div",he,Y(t),1),a.DEFAULT?(u(),d("div",ge,[L(f("button",{onClick:r=>n.$emit("previewChose",r,a.DEFAULT.key),onMouseenter:r=>n.$emit("previewEnter",r,a.DEFAULT.key),onMouseleave:l[0]||(l[0]=r=>n.$emit("previewLeave")),class:A([`bg:$(${a.DEFAULT.key.slice(2)})`,"w:full r:4 h:24 border:1|solid|transparent border:white:hover cursor:pointer"])},null,42,we),[[c,{placement:"top",content:`var(${a.DEFAULT.key})`}]])])):j("",!0),a.shades&&Object.keys(a.shades).length>0?(u(),d("div",{key:1,class:A([[{},`grid-template-cols:repeat(${Object.keys(a.shades).length},auto)`],"variable-section-items grid r:4 overflow:hidden"])},[(u(!0),d(D,null,F(a.shades,(r,v)=>(u(),d("div",{key:v,class:"flex gap:10"},[L(f("button",{onClick:o=>n.$emit("previewChose",o,r.key),onMouseenter:o=>n.$emit("previewEnter",o,r.key),onMouseleave:l[1]||(l[1]=o=>n.$emit("previewLeave")),class:A([`bg:$(${r.key.slice(2)})`,"w:full h:24 border:1|solid|transparent border:white:hover cursor:pointer"])},null,42,ke),[[c,{placement:"top",content:`var(${r.key})`}]])]))),128))],2)):j("",!0)]))),128))])}}},H=s=>(Ze("data-v-d8e50065"),s=s(),et(),s),$e={id:"windpressbuilderius-variable-app-body",class:"rel w:full h:full overflow-y:scroll!"},Ee=H(()=>f("span",{class:"font:semibold"},"Color",-1)),Pe=H(()=>f("span",{class:"font:semibold"},"Typography",-1)),Ce=H(()=>f("span",{class:"font:semibold"},"Sizing",-1)),xe=1e3,Ie={__name:"PanelBody",setup(s){const n=_({colors:{},typography:{},sizing:{}}),l=S("focusedInput"),c=S("recentVariableSelectionTimestamp"),a=S("tempInputValue");async function t(){const m=await Je.contentWindow.wp.hooks.applyFilters("windpress.module.design_system.main_css"),i=rt(at(m));let g=document.querySelector("#windpressbuilderius-variable-app-body"),y=g.querySelector("style#windpressbuilderius-variable-app-body-style");y||(y=document.createElement("style"),y.id="windpressbuilderius-variable-app-body-style",g.appendChild(y)),y.innerHTML=`
        #windpressbuilderius-variable-app-body {
            ${i.map(e=>`${e.key}:${e.value};`).join("")}
        }
    `;const $={};i.filter(e=>e.key.startsWith("--color")).forEach(e=>{const p=e.key.slice(8),K=p.split("-");let N="";if(K.length>1){const qe=K[0],ze=K.slice(1).join("-");N=`${qe}.shades.'${ze}'`}else N=`${p}.DEFAULT`;ot($,N,e)}),n.value.colors=Object.keys($).sort().reduce((e,p)=>(e[p]=$[p],e),{});const b={font_size:[],line_height:[],letter_spacing:[]};i.filter(e=>e.key.startsWith("--font-size-")&&!e.key.endsWith("--line-height")).forEach(e=>{const p=e.key.slice(12);b.font_size.push({key:e.key,label:p,value:e.value})}),i.filter(e=>e.key.startsWith("--line-height-")||e.key.endsWith("--line-height")).forEach(e=>{const p=e.key.startsWith("--line-height-")?e.key.slice(14):e.key.slice(2,-13);b.line_height.push({key:e.key,label:p,value:e.value})}),b.line_height.sort((e,p)=>e.label.startsWith("font-size-")&&!p.label.startsWith("font-size-")?1:!e.label.startsWith("font-size-")&&p.label.startsWith("font-size-")?-1:0),i.filter(e=>e.key.startsWith("--letter-spacing-")).forEach(e=>{const p=e.key.slice(17);b.letter_spacing.push({key:e.key,label:p,value:e.value})}),n.value.typography=b;const z={spacing:[],width:[],breakpoint:[]};i.filter(e=>e.key.startsWith("--spacing-")).forEach(e=>{const p=e.key.slice(10);z.spacing.push({key:e.key,label:p,value:e.value})}),i.filter(e=>e.key.startsWith("--width-")).forEach(e=>{const p=e.key.slice(8);z.width.push({key:e.key,label:p,value:e.value})}),i.filter(e=>e.key.startsWith("--breakpoint-")).forEach(e=>{const p=e.key.slice(13);z.breakpoint.push({key:e.key,label:p,value:e.value})}),n.value.sizing=z}const r=_(null),v=_(null),o=_(null);V(l,m=>{if(m){const i=m.getAttribute("name"),g=["color","backgroundColor"].some(b=>i.includes(b)),y=["fontSize"].some(b=>i.includes(b)),$=["padding","margin","gap","width","height"].some(b=>i.includes(b));v.value.togglePanel(!1),o.value.togglePanel(!1),r.value.togglePanel(!1),g?(r.value.togglePanel(!0),r.value.scrollIntoView()):y?(v.value.togglePanel(!0),v.value.scrollIntoView()):$&&(o.value.togglePanel(!0),o.value.scrollIntoView())}});function P(m,i){const g=Object.getOwnPropertyDescriptor(m,"value").set,y=Object.getPrototypeOf(m),$=Object.getOwnPropertyDescriptor(y,"value").set;g&&g!==$?$.call(m,i):g.call(m,i);const b=new Event("input",{bubbles:!0});m.dispatchEvent(b)}function I(m,i){performance.now()-c.value<xe||l.value&&P(l.value,`var(${i})`)}function h(m){!l.value||a.value===null||P(l.value,a.value)}function k(m,i){l.value&&(P(l.value,`var(${i})`),a.value=`var(${i})`,c.value=performance.now())}return se(()=>{t()}),new BroadcastChannel("windpress").addEventListener("message",async m=>{const i=m.data;i.source==="windpress/autocomplete"&&i.task==="windpress.main_css.saved.done"&&setTimeout(()=>{t()},1e3)}),(m,i)=>(u(),d("div",$e,[w(B,{namespace:"variable",name:"color",ref_key:"sectionColor",ref:r},{header:x(()=>[Ee]),default:x(()=>[w(_e,{variableItems:n.value.colors,onPreviewEnter:I,onPreviewLeave:h,onPreviewChose:k},null,8,["variableItems"])]),_:1},512),w(B,{namespace:"variable",name:"typography",ref_key:"sectionTypography",ref:v},{header:x(()=>[Pe]),default:x(()=>[w(G,{variableItems:n.value.typography,onPreviewEnter:I,onPreviewLeave:h,onPreviewChose:k},null,8,["variableItems"])]),_:1},512),w(B,{namespace:"variable",name:"spacing",ref_key:"sectionSpacing",ref:o,class:""},{header:x(()=>[Ce]),default:x(()=>[w(G,{variableItems:n.value.sizing,onPreviewEnter:I,onPreviewLeave:h,onPreviewChose:k},null,8,["variableItems"])]),_:1},512)]))}},Le=ee(Ie,[["__scopeId","data-v-d8e50065"]]),Se={id:"windpressbuilderius-variable-app-container",class:"flex flex:column w:full h:full fg:$(base-2) bg:$(primary-1) r:10 overflow:hidden box-shadow:$(builder-box-shadow) outline:1|solid|$(accent-normal)"},We={__name:"App",setup(s){const n=S("isOpen");return(l,c)=>{const a=M("resizable");return L((u(),d("div",Se,[w(oe),(u(),tt(st,null,{default:x(()=>[w(Le)]),_:1}))])),[[He,C(n)],[a,{minWidth:300,minHeight:500},void 0,{br:!0}]])}}};function Oe({selector:s,callback:n,options:l}){const c=new MutationObserver(n),a=document.querySelector(s);if(!a){logger(`Target not found for selector: ${s}`,{module:"variable-picker",type:"error"});return}const t={childList:!0,subtree:!0};c.observe(a,Object.assign(Object.assign({},t),l))}const W=document.createElement("windpressbuilderius-variable-app");W.id="windpressbuilderius-variable-app",document.body.appendChild(W);for(const s of document.getElementById("builderius-builder-css").sheet.cssRules)if(s.selectorText&&s.selectorText.includes("#builderiusPanel"))for(let n=0;n<s.style.length;n++){const l=s.style[n];l.startsWith("--")&&W.style.setProperty(l,s.style.getPropertyValue(l).trim())}const O=_(!1),T=_(null),q=_(null),Te=_(0),U=_(null),E=Ue(We);E.config.globalProperties.windpressbuilderius=window.windpressbuilderius,E.provide("variableApp",W),E.provide("isOpen",O),E.provide("focusedInput",T),E.provide("tempInputValue",q),E.provide("recentVariableSelectionTimestamp",Te),E.use(Re,{container:"#windpressbuilderius-variable-app"}).use(Ge),E.component("font-awesome-icon",Ke).component("inline-svg",Ne),E.mount("#windpressbuilderius-variable-app");function J(s){var n;!s.shiftKey||!s.target||((n=document==null?void 0:document.getSelection())==null||n.removeAllRanges(),s.preventDefault(),s.stopPropagation(),T.value=s.target,q.value=s.target.value,O.value=!0)}function Q(s){T.value=s.target}const Ae={includedFields:["div.uniCssInput","div.uniCssColorpicker"],excludedFields:[]};function Z(){setTimeout(()=>{var l;let s=!1;Ae.includedFields.forEach(c=>{(typeof c=="string"?[...document.querySelectorAll(c)]:[...document.querySelectorAll(c.selector)].filter(a=>c.hasChild.some(t=>a.querySelector(t)))).forEach(a=>{const t=a.querySelector("input[type='text']");(t==null?void 0:t.getAttribute("windpressbuilderius-variable-app"))!=="true"&&(t==null||t.removeEventListener("click",J),t==null||t.addEventListener("click",J),t==null||t.removeEventListener("focus",Q),t==null||t.addEventListener("focus",Q),t==null||t.setAttribute("windpressbuilderius-variable-app","true"),t==null||t.parentNode.setAttribute("data-tooltip-place","top"),t==null||t.parentNode.setAttribute("data-tooltip-content","Shift + click to open the Variable Picker"),s=!0)})});const n=document.querySelector("div.uniSystemSelectClasses__valueWrapper span.uniSystemSelectClasses__placeholder")?"%root%":(l=document.querySelector("div.uniSystemSelectClasses__valueWrapper div.uniModuleCssSelectorItemSelected span"))==null?void 0:l.innerText;U.value!==n&&(U.value=n),s&&(T.value=null,q.value=null)},100)}let R=!1;Oe({selector:".uniLeftPanelOuter",options:{subtree:!0,childList:!0},callback(){R||(R=!0,Z(),setTimeout(()=>{R=!1},100))}}),Z(),document.addEventListener("keydown",s=>{s.key==="Escape"&&O.value&&(O.value=!1)}),V(O,s=>{W.style.zIndex=s?"calc(Infinity)":"-1"}),V(U,(s,n)=>{s!==n&&(T.value=null,q.value=null)}),Ye("Module loaded!",{module:"variable-picker"})});
