import{b as l,a as S}from"./constant-CWUMdlVX.js";import{_ as A}from"./lib-FVFXNsp8.js";import{__tla as I}from"./build-6XnEkjQY.js";import{__tla as O}from"./oxide_parser_wasm-8nf_WcM4.js";import{g as P}from"./intellisense-DggKt6it.js";import{l as q}from"./logger-BTW-zIW3.js";import{c as W}from"./index.browser-CJrp5d7n.js";import"./index-BHzFOpFs.js";import"./preload-helper-Tcd9XBoB.js";Promise.all([(()=>{try{return I}catch{}})(),(()=>{try{return O}catch{}})()]).then(async()=>{const m=()=>W("1234567890abcdefghijklmnopqrstuvwxyz",6)();function $(){let n=m();for(;n.match(/^\d/);)n=m();return`windpress${n}`}async function v(){l.$_state.globalVariables=l.$_state.globalVariables.filter(r=>r.category!=="windpress"),l.$_state.globalVariablesCategories.find(r=>r.id==="windpress")||l.$_state.globalVariablesCategories.push({id:"windpress",name:"WindPress"});const n=await S.contentWindow.wp.hooks.applyFilters("windpress.module.design_system.main_css");P(A(n)).forEach(r=>{l.$_state.globalVariables.push({id:$(),name:r.key.substring(2),value:r.value,category:"windpress"})})}new BroadcastChannel("windpress").addEventListener("message",async n=>{const r=n.data;r.source==="windpress/autocomplete"&&r.task==="windpress.main_css.saved.done"&&setTimeout(()=>{v()},1e3)}),v();function C(){var _,E,k,L;if(l.$_state.activePanel!=="element"||!((E=(_=l.$_state)==null?void 0:_.activeElement)!=null&&E.id)||!((k=S)!=null&&k.contentWindow))return;const n=document.querySelector(".expand .options-wrapper"),r=n==null?void 0:n.querySelector(".searchable"),c=n==null?void 0:n.querySelector(".dropdown"),p=c==null?void 0:c.querySelectorAll(".variable-picker-item:not(.title)"),o=(L=document.querySelector(".variable-picker-button.open"))==null?void 0:L.previousElementSibling;if(!o||!(p!=null&&p.length)||!n||!c||!r)return;const x=e=>{var t;const s=((t=e.querySelector("span:first-of-type"))==null?void 0:t.textContent)??"";!o||!s||y(h(s))},j=e=>{var a;const s=((a=e.querySelector("span:first-of-type"))==null?void 0:a.textContent)??"";if(!o||!s)return;const t=h(s);o.value=t,o.click()},M=(e,s)=>{e.forEach(t=>{t.isIntersecting&&!t.target.classList.contains("open")&&t.target.click()})},f=()=>{y(V);const e=o.nextElementSibling;g.observe(e),n.removeEventListener("mouseleave",f)},w=(e,s)=>{e.forEach(t=>{const[a,d]=Object.entries(t)[0]||[];s.insertAdjacentHTML("beforeend",`
                <li class="variable-picker-item">
                    <span>${a}</span>
                    <span class="option-value">${d}</span>
                </li>
            `)}),i.querySelectorAll(".variable-picker-item").forEach(t=>{t.addEventListener("mouseenter",()=>x(t)),t.addEventListener("click",()=>j(t))})},y=e=>{o.value=e,o.dispatchEvent(new Event("input")),o.focus()},h=e=>`var(--${e})`,u=[];c.remove(),p.forEach(e=>{var a,d;const s=((a=e.querySelector("span:first-of-type"))==null?void 0:a.textContent)??"",t=((d=e.querySelector("span.option-value"))==null?void 0:d.textContent)??"";u.push({[s]:t})});const i=document.createElement("ul");i.classList.add("custom-dropdown"),i.setAttribute("style",`
        max-height: calc(32px * 10);
        overflow: hidden;
        overflow-y: auto;
        position: relative;
        scrollbar-color: rgba(0, 0, 0, .4) rgba(0, 0, 0, .2);
        scrollbar-width: thin;
    `),w(u,i),n.appendChild(i),r.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation()}),r.addEventListener("input",e=>{const s=u.filter(t=>{var a;return(((a=Object.keys(t)[0])==null?void 0:a.toLowerCase())??"").includes(r.value.toLowerCase())});i.innerHTML="",w(s,i)});let V=(o==null?void 0:o.value)??" ";const g=new IntersectionObserver(M,{root:o.parentElement});n.addEventListener("mouseleave",f),g.disconnect()}const b=document.querySelector("#bricks-panel-inner:not(div.bricks-control-popup *)");if(!b)throw q("Inner panel not found, can't initialize preview of variables on hover",{module:"variables",type:"error"}),new Error("Inner panel not found, can't initialize preview of variables on hover");new MutationObserver(C).observe(b,{subtree:!0,childList:!0,attributes:!0}),q("Module loaded!",{module:"variables"})});
