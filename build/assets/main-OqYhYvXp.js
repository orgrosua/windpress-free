var B;import{l as _}from"./logger-BTW-zIW3.js";import{n as I,T as Q,H as V}from"./highlight-in-textarea-BGLYngo3.js";import{c as q,r as X}from"./_MapCache-DN36xuwU.js";import{i as Y,s as Z}from"./set-DMzY-ey4.js";import{r as F,w as ee,n as b}from"./runtime-core.esm-bundler-DpP2Prln.js";import"./index-BbP3371Q.js";var te=/\s/;function ne(e){for(var t=e.length;t--&&te.test(e.charAt(t)););return t}var ae=/^\s+/;function re(e){return e&&e.slice(0,ne(e)+1).replace(ae,"")}var P=NaN,ie=/^[-+]0x[0-9a-f]+$/i,se=/^0b[01]+$/i,oe=/^0o[0-7]+$/i,ce=parseInt;function z(e){if(typeof e=="number")return e;if(Y(e))return P;if(q(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=q(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=re(e);var n=se.test(e);return n||oe.test(e)?ce(e.slice(2),n?2:8):ie.test(e)?P:+e}var E=function(){return X.Date.now()},le="Expected a function",ue=Math.max,de=Math.min;function pe(e,t,n){var a,s,u,c,i,d,m=0,M=!1,v=!1,k=!0;if(typeof e!="function")throw new TypeError(le);t=z(t)||0,q(n)&&(M=!!n.leading,v="maxWait"in n,u=v?ue(z(n.maxWait)||0,t):u,k="trailing"in n?!!n.trailing:k);function y(r){var l=a,h=s;return a=s=void 0,m=r,c=e.apply(h,l),c}function U(r){return m=r,i=setTimeout(f,t),M?y(r):c}function G(r){var l=r-d,h=r-m,A=t-l;return v?de(A,u-h):A}function x(r){var l=r-d,h=r-m;return d===void 0||l>=t||l<0||v&&h>=u}function f(){var r=E();if(x(r))return N(r);i=setTimeout(f,G(r))}function N(r){return i=void 0,k&&a?y(r):(a=s=void 0,c)}function J(){i!==void 0&&clearTimeout(i),m=0,a=d=s=i=void 0}function K(){return i===void 0?c:N(E())}function S(){var r=E(),l=x(r);if(a=arguments,s=this,d=r,l){if(i===void 0)return U(d);if(v)return clearTimeout(i),i=setTimeout(f,t),y(d)}return i===void 0&&(i=setTimeout(f,t)),c}return S.cancel=J,S.flush=K,S}const me=document.querySelector("#app"),g=me.__vue__,C=(B=document.querySelector("#app #iframe"))==null?void 0:B.contentDocument.querySelector("#breakdance_canvas"),D=C.__vue__,o=document.createRange().createContextualFragment(`
    <textarea id="windpressbreakdance-plc-input" class="windpressbreakdance-plc-input" rows="2" spellcheck="false"></textarea>
`).querySelector("#windpressbreakdance-plc-input"),L=document.createElement("div");L.classList.add("windpressbreakdance-plc-input-container"),L.appendChild(o);const ve=document.createRange().createContextualFragment(`
    <div class="windpressbreakdance-plc-action-container">
        <div class="actions">
        </div>
    </div>
`).querySelector(".windpressbreakdance-plc-action-container"),he=ve.querySelector(".actions"),fe=document.createRange().createContextualFragment(`
    <span id="windpressbreakdance-plc-class-sort" class="bricks-svg-wrapper windpressbreakdance-plc-class-sort" data-balloon="Automatic Class Sorting" data-balloon-pos="bottom-right">
        <svg  xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round" class="bricks-svg icon icon-tabler icons-tabler-outline icon-tabler-reorder"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" /><path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" /><path d="M17 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" /><path d="M5 11v-3a3 3 0 0 1 3 -3h8a3 3 0 0 1 3 3v3" /><path d="M16.5 8.5l2.5 2.5l2.5 -2.5" /></svg>    
    </span>
`).querySelector("#windpressbreakdance-plc-class-sort");he.appendChild(fe);const W=F(!1),H=F(null);let O=null;I(o);let R=[];wp.hooks.addAction("windpressbreakdance-autocomplete-items-refresh","windpressbreakdance",()=>{R=wp.hooks.applyFilters("windpressbreakdance-autocomplete-items",[],o.value)}),wp.hooks.doAction("windpressbreakdance-autocomplete-items-refresh");const p=new Q({menuContainer:document.querySelector("#app"),containerClass:"windpressbreakdance-tribute-container",autocompleteMode:!0,menuItemLimit:50,noMatchTemplate:"",values:async function(e,t){const n=await wp.hooks.applyFilters("windpressbreakdance-autocomplete-items-query",R,e);t(n)},lookup:"value",itemClass:"class-item",menuItemTemplate:function(e){let t="";return e.original.color!==void 0&&(t+=`background-color: ${e.original.color};`),e.original.fontWeight!==void 0&&(t+=`font-weight: ${e.original.fontWeight};`),`
            <span class="class-name" data-tribute-class-name="${e.original.value}">${e.string}</span>
            <span class="class-hint" style="${t}"></span>
        `}});p.setMenuContainer=function(e){this.menuContainer=e};const be=p.events.callbacks;p.events.callbacks=function(){return{...be.call(this),up:(e,t)=>{if(this.tribute.isActive&&this.tribute.current.filteredItems){e.preventDefault(),e.stopPropagation();let n=this.tribute.current.filteredItems.length,a=this.tribute.menuSelected;n>a&&a>0?(this.tribute.menuSelected--,this.setActiveLi()):a===0&&(this.tribute.menuSelected=n-1,this.setActiveLi(),this.tribute.menu.scrollTop=this.tribute.menu.scrollHeight),j()}},down:(e,t)=>{if(this.tribute.isActive&&this.tribute.current.filteredItems){e.preventDefault(),e.stopPropagation();let n=this.tribute.current.filteredItems.length-1,a=this.tribute.menuSelected;n>a?(this.tribute.menuSelected++,this.setActiveLi()):n===a&&(this.tribute.menuSelected=0,this.setActiveLi(),this.tribute.menu.scrollTop=0),j()}}}},p.attach(o),g.$store.subscribeAction((e,t)=>{e.type==="ui/activateElement"&&(H.value=e.payload),e.type==="ui/setLeftSidebarState"&&(W.value=e.payload==="elementproperties")}),ee([H,W],(e,t)=>{e[0]!==t[0]&&b(()=>{ge(),Se()}),e[0]&&e[1]&&b(()=>{const n=document.querySelector(".breakdance-element-properties-panel .vscroll-scroll .vscroll-scroll");n.querySelector(".windpressbreakdance-plc-input")===null&&n.insertBefore(L,n.firstChild)})}),O=new V(o,{highlight:[{highlight:new RegExp("(?<=\\s|^)(?:(?!\\s).)+(?=\\s|$)","g"),className:"word"},{highlight:new RegExp("(?<=\\s)\\s","g"),className:"multispace",blank:!0}]});async function ge(){var e,t,n,a;o.value=((a=(n=(t=(e=g.$store.getters["ui/activeElement"].data.properties)==null?void 0:e.settings)==null?void 0:t.advanced)==null?void 0:n.classes)==null?void 0:a.join(" "))||""}async function we(){var a,s,u,c;if((c=(u=(s=(a=g.$store.getters["ui/activeElement"].data)==null?void 0:a.properties)==null?void 0:s.settings)==null?void 0:u.advanced)!=null&&c.classes)return!0;document.querySelector(".properties-panel-tab.breakdance-tab.breakdance-tab--id-settings").click();let e=document.querySelector("#settings .properties-panel-accordion.conditional-control-display-visible>div");for(;e===null;)e=document.querySelector("#settings .properties-panel-accordion.conditional-control-display-visible>div"),await new Promise(i=>setTimeout(i,100));e.parentElement.classList.contains("expanded")||e.click();let t=document.querySelector('#breakdance-class-input-search input[placeholder=".my-cool-class"]');for(;t===null;)t=document.querySelector('#breakdance-class-input-search input[placeholder=".my-cool-class"]'),await new Promise(i=>setTimeout(i,100));t.focus();const n="windpressbreakdance";return t.value=n,t.dispatchEvent(new Event("input",{bubbles:!0})),await new Promise(i=>setTimeout(i,100)),document.querySelector("#breakdance-class-input-search>button").click(),!0}const ke=pe(ye,50);async function ye(){if(!await we()){_("Upstream path not found!",{module:"plain-classes",type:"error"});return}o.focus(),Z(g.$store.getters["ui/activeElement"].data,"properties.settings.advanced.classes",o.value.trim().split(" ").filter(e=>e.trim()!=="")||[])}o.addEventListener("input",function(e){ke()});function Se(){b(()=>{try{O.handleInput()}catch{}I.update(o),p.hideMenu()})}const qe=new MutationObserver(function(e){e.forEach(function(t){t.type==="childList"&&t.addedNodes.length>0&&t.addedNodes.forEach(n=>{const a=n.querySelector(".class-name").dataset.tributeClassName;n.addEventListener("mouseenter",s=>{$(a)}),n.addEventListener("mouseleave",s=>{T()}),n.addEventListener("click",s=>{T(),$(a)})})})});let w=null;o.addEventListener("tribute-active-true",function(e){w===null&&(w=document.querySelector(".windpressbreakdance-tribute-container>ul")),b(()=>{w&&qe.observe(w,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class"]})})});function $(e){const t=D.$store.getters["ui/activeElement"].id,n=C.querySelector(`[data-node-id="${t}"]`);n.classList.add(e),n.dataset.tributeClassName=e}function T(){Ee()}function j(){let e=p.menu.querySelector("li.highlight>span.class-name");T(),$(e.dataset.tributeClassName)}function Ee(){const e=D.$store.getters["ui/activeElement"].id,t=C.querySelector(`[data-node-id="${e}"]`);t.dataset.tributeClassName&&(t.classList.remove(t.dataset.tributeClassName),t.dataset.tributeClassName="")}_("Module loaded!",{module:"plain-classes"});
