import{i as Ve,l as je,r as De,b as Fe,L as Be,_ as ee,T as Ue,P as He,K as Re,M as Ke,N as Ne,O as Xe,__tla as Ye}from"./_plugin-vue_export-helper-B7AYZ_fF.js";import{l as te}from"./logger-BTW-zIW3.js";import{V as Ge}from"./index-DQMxDuq3.js";import{a as se,u as Je}from"./constant-B0a9M2k0.js";import{i as S,a as ae,q as X,u as M,v as u,x as d,y as f,C as L,z as w,A as C,F as Qe,r as _,w as V,S as le,J as A,K as x,E as j,M as D,Q as F,B as Y,G as Ze,H as et,D as tt,T as st}from"./runtime-core.esm-bundler-CuuCWbwv.js";import{_ as at}from"./lib-FVFXNsp8.js";import{__tla as lt}from"./build-6XnEkjQY.js";import{__tla as nt}from"./oxide_parser_wasm-8nf_WcM4.js";import{g as it}from"./intellisense-DggKt6it.js";import{a as rt}from"./index-BtL5O8vF.js";import{s as ot}from"./set-qX46P2hw.js";import"./index-BHzFOpFs.js";import"./isObject-B5R9K1Pz.js";import"./preload-helper-Tcd9XBoB.js";import"./_MapCache-C7aBjWBU.js";import"./isSymbol-DJmTqBMq.js";Promise.all([(()=>{try{return Ye}catch{}})(),(()=>{try{return lt}catch{}})(),(()=>{try{return nt}catch{}})()]).then(async()=>{Ve({scope:"#windpressbuilderius-variable-app"}),je.add(De,Fe);const ne={id:"windpressbuilderius-variable-app-header",class:"bg:$(primary-1) cursor:grab bb:1|solid|$(primary-3)"},ie={class:"flex gap:10 align-items:center px:12 py:10 fg:$(base-2)"},re=["href"],oe={class:"text-transform:none font:medium flex gap:10 align-items:center cursor:default"},ue={__name:"PanelHeader",setup(s){const l=S("variableApp"),n=S("isOpen");function c(){const a=l.querySelector("#windpressbuilderius-variable-app-header");let t=_(!1),i=0,v=0;V(t,h=>{h?(document.body.style.userSelect="none",se.style.pointerEvents="none",a.style.cursor="grabbing"):(document.body.style.removeProperty("user-select"),se.style.removeProperty("pointer-events"),a.style.cursor="grab")});const o=h=>{t.value=!0;const k=a.getBoundingClientRect();i=h.clientX-k.left,v=h.clientY-k.top};a.removeEventListener("mousedown",o),a.addEventListener("mousedown",o);const P=h=>{if(!t.value)return;const k=a.getBoundingClientRect(),m=h.clientX,r=h.clientY,g=m-i,y=r-v,$=g<0?0:g>window.innerWidth-k.width?window.innerWidth-k.width:g,b=y<0?0:y>window.innerHeight-k.height?window.innerHeight-k.height:y;l.style.left=`${$}px`,l.style.top=`${b}px`};document.removeEventListener("mousemove",P),document.addEventListener("mousemove",P);const I=h=>{t.value=!1};document.removeEventListener("mouseup",I),document.addEventListener("mouseup",I)}return ae(()=>{c()}),(a,t)=>{const i=X("inline-svg"),v=X("font-awesome-icon"),o=M("tooltip");return u(),d("div",ne,[f("div",ie,[L((u(),d("a",{href:a.windpressbuilderius.site_meta.admin_url,target:"_blank",class:"flex align-items:center fg:$(base-2) fg:$(accent-normal):hover"},[w(i,{src:C(Be),class:"inline-svg fill:current font:24"},null,8,["src"])],8,re)),[[o,{placement:"top",content:"Open WindPress plugin"}]]),L((u(),d("div",oe,[Qe(" WindPress ")])),[[o,{placement:"top",content:`v${a.windpressbuilderius._version}`}]]),L((u(),d("button",{onClick:t[0]||(t[0]=P=>n.value=!C(n)),class:"uniPanelIconButton uniIconCssMode ml:auto p:6"},[w(v,{icon:["fas","xmark"],class:"fg:$(base-2) font:16"})])),[[o,{placement:"top",content:"Close"}]])])])}}},ce={class:"flex-grow:1"},pe={key:0,class:"expansion-panel__body"},de={__name:"ExpansionPanel",props:{namespace:{type:String,required:!0},name:{type:String,required:!0}},setup(s,{expose:l}){const n=s,c=_(null),a=rt(`windpressbuilderius-variable-app.ui.expansion-panels.${n.namespace}`,{[`${n.name}`]:!1},void 0,{mergeDefaults:!0});function t(v){a.value[n.name]=v===null?!a.value[n.name]:v}function i(){c.value.scrollIntoView()}return l({togglePanel:t,scrollIntoView:i}),(v,o)=>{const P=X("font-awesome-icon");return u(),d("div",{ref_key:"sectionRef",ref:c,class:"expansion-panel m:10 mr:4"},[f("div",{onClick:o[0]||(o[0]=I=>C(a)[s.name]=!C(a)[s.name]),class:A([{"bg:$(primary-3)!":C(a)[s.name]},"expansion-panel__header flex bg:$(primary-2) bg:$(primary-3):hover justify-content:space-between p:10 r:8 cursor:pointer"])},[f("div",ce,[le(v.$slots,"header",{},void 0,!0)]),f("div",null,[w(P,{icon:["fas","chevron-right"],class:A([{"rotate(-90)":C(a)[s.name]},"~duration:300 font:18"])},null,8,["class"])])],2),w(Ue,null,{default:x(()=>[C(a)[s.name]?(u(),d("div",pe,[le(v.$slots,"default",{},void 0,!0)])):j("",!0)]),_:3})],512)}}},B=ee(de,[["__scopeId","data-v-6644ab81"]]),ve={class:"{m:10;pb:15}>div bb:1|solid|$(primary-3)>div:not(:last-child)"},me={class:"variable-section-title font:14 my:10"},be={class:"variable-section-items flex flex:row gap:8 flex-wrap:wrap"},ye=["onClick","onMouseenter"],fe={class:"font:14"},G={__name:"CommonVariableItems",props:{variableItems:{type:Object,required:!0}},setup(s){return(l,n)=>{const c=M("tooltip");return u(),d("div",ve,[(u(!0),d(D,null,F(s.variableItems,(a,t)=>(u(),d("div",{key:t,class:""},[f("div",me,Y(t.replace("_","-")),1),f("div",be,[a.length>0?(u(!0),d(D,{key:0},F(a,(i,v)=>L((u(),d("button",{key:v,onClick:o=>l.$emit("previewChose",o,i.key),onMouseenter:o=>l.$emit("previewEnter",o,i.key),onMouseleave:n[0]||(n[0]=o=>l.$emit("previewLeave")),class:"px:12 py:8 r:8 fg:$(base-1) fg:$(accent-normal):hover bg:$(primary-3) bg:$(primary-2):hover b:0 cursor:pointer {opacity:.5}>span opacity:100:hover>span"},[f("span",fe,Y(i.label),1)],40,ye)),[[c,{placement:"top",content:`var(${i.key}, ${i.value})`}]])),128)):j("",!0)])]))),128))])}}},he={class:"{m:10;pb:15}>div bb:1|solid|$(primary-3)>div:not(:last-child)"},ge={class:"variable-section-title font:14 my:10"},we={key:0,class:"variable-section-items"},ke=["onClick","onMouseenter"],_e=["onClick","onMouseenter"],$e={__name:"ColorVariableItems",props:{variableItems:{type:Object,required:!0}},setup(s){return(l,n)=>{const c=M("tooltip");return u(),d("div",he,[(u(!0),d(D,null,F(s.variableItems,(a,t)=>(u(),d("div",{key:t,class:""},[f("div",ge,Y(t),1),a.DEFAULT?(u(),d("div",we,[L(f("button",{onClick:i=>l.$emit("previewChose",i,a.DEFAULT.key),onMouseenter:i=>l.$emit("previewEnter",i,a.DEFAULT.key),onMouseleave:n[0]||(n[0]=i=>l.$emit("previewLeave")),class:A([`bg:$(${a.DEFAULT.key.slice(2)})`,"w:full r:4 h:24 border:1|solid|transparent border:white:hover cursor:pointer"])},null,42,ke),[[c,{placement:"top",content:`var(${a.DEFAULT.key}, ${a.DEFAULT.value})`}]])])):j("",!0),a.shades&&Object.keys(a.shades).length>0?(u(),d("div",{key:1,class:A([[{},`grid-template-cols:repeat(${Object.keys(a.shades).length},auto)`],"variable-section-items grid r:4 overflow:hidden"])},[(u(!0),d(D,null,F(a.shades,(i,v)=>(u(),d("div",{key:v,class:"flex gap:10"},[L(f("button",{onClick:o=>l.$emit("previewChose",o,i.key),onMouseenter:o=>l.$emit("previewEnter",o,i.key),onMouseleave:n[1]||(n[1]=o=>l.$emit("previewLeave")),class:A([`bg:$(${i.key.slice(2)})`,"w:full h:24 border:1|solid|transparent border:white:hover cursor:pointer"])},null,42,_e),[[c,{placement:"top",content:`var(${i.key}, ${i.value})`}]])]))),128))],2)):j("",!0)]))),128))])}}},U=s=>(Ze("data-v-b63bc21c"),s=s(),et(),s),Ee={id:"windpressbuilderius-variable-app-body",class:"rel w:full h:full overflow-y:scroll!"},Pe=U(()=>f("span",{class:"font:semibold"},"Color",-1)),Ce=U(()=>f("span",{class:"font:semibold"},"Typography",-1)),xe=U(()=>f("span",{class:"font:semibold"},"Sizing",-1)),Ie=1e3,Le={__name:"PanelBody",setup(s){const l=_({colors:{},typography:{},sizing:{}}),n=S("focusedInput"),c=S("recentVariableSelectionTimestamp"),a=S("tempInputValue");async function t(){const m=await Je.contentWindow.wp.hooks.applyFilters("windpress.module.design_system.main_css"),r=it(at(m));let g=document.querySelector("#windpressbuilderius-variable-app-body"),y=g.querySelector("style#windpressbuilderius-variable-app-body-style");y||(y=document.createElement("style"),y.id="windpressbuilderius-variable-app-body-style",g.appendChild(y)),y.innerHTML=`
        #windpressbuilderius-variable-app-body {
            ${r.map(e=>`${e.key}:${e.value};`).join("")}
        }
    `;const $={};r.filter(e=>e.key.startsWith("--color")).forEach(e=>{const p=e.key.slice(8),K=p.split("-");let N="";if(K.length>1){const ze=K[0],Me=K.slice(1).join("-");N=`${ze}.shades.'${Me}'`}else N=`${p}.DEFAULT`;ot($,N,e)}),l.value.colors=Object.keys($).sort().reduce((e,p)=>(e[p]=$[p],e),{});const b={font_size:[],line_height:[],letter_spacing:[]};r.filter(e=>e.key.startsWith("--font-size-")&&!e.key.endsWith("--line-height")).forEach(e=>{const p=e.key.slice(12);b.font_size.push({key:e.key,label:p,value:e.value})}),r.filter(e=>e.key.startsWith("--line-height-")||e.key.endsWith("--line-height")).forEach(e=>{const p=e.key.startsWith("--line-height-")?e.key.slice(14):e.key.slice(2,-13);b.line_height.push({key:e.key,label:p,value:e.value})}),b.line_height.sort((e,p)=>e.label.startsWith("font-size-")&&!p.label.startsWith("font-size-")?1:!e.label.startsWith("font-size-")&&p.label.startsWith("font-size-")?-1:0),r.filter(e=>e.key.startsWith("--letter-spacing-")).forEach(e=>{const p=e.key.slice(17);b.letter_spacing.push({key:e.key,label:p,value:e.value})}),l.value.typography=b;const z={spacing:[],width:[],breakpoint:[]};r.filter(e=>e.key.startsWith("--spacing-")).forEach(e=>{const p=e.key.slice(10);z.spacing.push({key:e.key,label:p,value:e.value})}),r.filter(e=>e.key.startsWith("--width-")).forEach(e=>{const p=e.key.slice(8);z.width.push({key:e.key,label:p,value:e.value})}),r.filter(e=>e.key.startsWith("--breakpoint-")).forEach(e=>{const p=e.key.slice(13);z.breakpoint.push({key:e.key,label:p,value:e.value})}),l.value.sizing=z}const i=_(null),v=_(null),o=_(null);V(n,m=>{if(m){const r=m.getAttribute("name"),g=["color","backgroundColor"].some(b=>r.includes(b)),y=["fontSize"].some(b=>r.includes(b)),$=["padding","margin","gap","width","height"].some(b=>r.includes(b));v.value.togglePanel(!1),o.value.togglePanel(!1),i.value.togglePanel(!1),g?(i.value.togglePanel(!0),i.value.scrollIntoView()):y?(v.value.togglePanel(!0),v.value.scrollIntoView()):$&&(o.value.togglePanel(!0),o.value.scrollIntoView())}});function P(m,r){const g=Object.getOwnPropertyDescriptor(m,"value").set,y=Object.getPrototypeOf(m),$=Object.getOwnPropertyDescriptor(y,"value").set;g&&g!==$?$.call(m,r):g.call(m,r);const b=new Event("input",{bubbles:!0});m.dispatchEvent(b)}function I(m,r){performance.now()-c.value<Ie||n.value&&P(n.value,`var(${r})`)}function h(m){!n.value||a.value===null||P(n.value,a.value)}function k(m,r){n.value&&(P(n.value,`var(${r})`),a.value=`var(${r})`,c.value=performance.now())}return ae(()=>{t()}),new BroadcastChannel("windpress").addEventListener("message",async m=>{const r=m.data;r.source==="windpress/autocomplete"&&r.task==="windpress.main_css.saved.done"&&setTimeout(()=>{t()},1e3)}),(m,r)=>(u(),d("div",Ee,[w(B,{namespace:"variable",name:"color",ref_key:"sectionColor",ref:i},{header:x(()=>[Pe]),default:x(()=>[w($e,{variableItems:l.value.colors,onPreviewEnter:I,onPreviewLeave:h,onPreviewChose:k},null,8,["variableItems"])]),_:1},512),w(B,{namespace:"variable",name:"typography",ref_key:"sectionTypography",ref:v},{header:x(()=>[Ce]),default:x(()=>[w(G,{variableItems:l.value.typography,onPreviewEnter:I,onPreviewLeave:h,onPreviewChose:k},null,8,["variableItems"])]),_:1},512),w(B,{namespace:"variable",name:"spacing",ref_key:"sectionSpacing",ref:o,class:""},{header:x(()=>[xe]),default:x(()=>[w(G,{variableItems:l.value.sizing,onPreviewEnter:I,onPreviewLeave:h,onPreviewChose:k},null,8,["variableItems"])]),_:1},512)]))}},Se=ee(Le,[["__scopeId","data-v-b63bc21c"]]),We={id:"windpressbuilderius-variable-app-container",class:"flex flex:column w:full h:full fg:$(base-2) bg:$(primary-1) r:10 overflow:hidden box-shadow:$(builder-box-shadow) outline:1|solid|$(accent-normal)"},Te={__name:"App",setup(s){const l=S("isOpen");return(n,c)=>{const a=M("resizable");return L((u(),d("div",We,[w(ue),(u(),tt(st,null,{default:x(()=>[w(Se)]),_:1}))])),[[He,C(l)],[a,{minWidth:300,minHeight:500},void 0,{br:!0}]])}}};function Oe({selector:s,callback:l,options:n}){const c=new MutationObserver(l),a=document.querySelector(s);if(!a){te(`Target not found for selector: ${s}`,{module:"variable-picker",type:"error"});return}const t={childList:!0,subtree:!0};c.observe(a,Object.assign(Object.assign({},t),n))}const W=document.createElement("windpressbuilderius-variable-app");W.id="windpressbuilderius-variable-app",document.body.appendChild(W);for(const s of document.getElementById("builderius-builder-css").sheet.cssRules)if(s.selectorText&&s.selectorText.includes("#builderiusPanel"))for(let l=0;l<s.style.length;l++){const n=s.style[l];n.startsWith("--")&&W.style.setProperty(n,s.style.getPropertyValue(n).trim())}const T=_(!1),O=_(null),q=_(null),Ae=_(0),H=_(null),E=Re(Te);E.config.globalProperties.windpressbuilderius=window.windpressbuilderius,E.provide("variableApp",W),E.provide("isOpen",T),E.provide("focusedInput",O),E.provide("tempInputValue",q),E.provide("recentVariableSelectionTimestamp",Ae),E.use(Ke,{container:"#windpressbuilderius-variable-app"}).use(Ge),E.component("font-awesome-icon",Ne).component("inline-svg",Xe),E.mount("#windpressbuilderius-variable-app");function J(s){var l;!s.shiftKey||!s.target||((l=document==null?void 0:document.getSelection())==null||l.removeAllRanges(),s.preventDefault(),s.stopPropagation(),O.value=s.target,q.value=s.target.value,T.value=!0)}function Q(s){O.value=s.target}const qe={includedFields:["div.uniCssInput","div.uniCssColorpicker"],excludedFields:[]};function Z(){setTimeout(()=>{var n;let s=!1;qe.includedFields.forEach(c=>{(typeof c=="string"?[...document.querySelectorAll(c)]:[...document.querySelectorAll(c.selector)].filter(a=>c.hasChild.some(t=>a.querySelector(t)))).forEach(a=>{const t=a.querySelector("input[type='text']");(t==null?void 0:t.getAttribute("windpressbuilderius-variable-app"))!=="true"&&(t==null||t.removeEventListener("click",J),t==null||t.addEventListener("click",J),t==null||t.removeEventListener("focus",Q),t==null||t.addEventListener("focus",Q),t==null||t.setAttribute("windpressbuilderius-variable-app","true"),t==null||t.parentNode.setAttribute("data-tooltip-place","top"),t==null||t.parentNode.setAttribute("data-tooltip-content","Shift + click to open the Variable Picker"),s=!0)})});const l=document.querySelector("div.uniSystemSelectClasses__valueWrapper span.uniSystemSelectClasses__placeholder")?"%root%":(n=document.querySelector("div.uniSystemSelectClasses__valueWrapper div.uniModuleCssSelectorItemSelected span"))==null?void 0:n.innerText;H.value!==l&&(H.value=l),s&&(O.value=null,q.value=null)},100)}let R=!1;Oe({selector:".uniLeftPanelOuter",options:{subtree:!0,childList:!0},callback(){R||(R=!0,Z(),setTimeout(()=>{R=!1},100))}}),Z(),document.addEventListener("keydown",s=>{s.key==="Escape"&&T.value&&(T.value=!1)}),V(T,s=>{W.style.zIndex=s?"calc(Infinity)":"-1"}),V(H,(s,l)=>{s!==l&&(O.value=null,q.value=null)}),te("Module loaded!",{module:"variable-picker"})});
