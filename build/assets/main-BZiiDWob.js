import{l as q}from"./logger-BTW-zIW3.js";import{n as p,T as E,H as I}from"./highlight-in-textarea-BGLYngo3.js";import{i as o,o as m,a as g}from"./constant-Cdlzk0w4.js";import{r as v,w as F,n as c}from"./runtime-core.esm-bundler-DpP2Prln.js";import"./index-BbP3371Q.js";const i=document.createRange().createContextualFragment(`
    <textarea id="windpressoxygen-plc-input" class="windpressoxygen-plc-input" rows="2" spellcheck="false"></textarea>
`).querySelector("#windpressoxygen-plc-input"),w=document.createRange().createContextualFragment(`
    <div class="windpressoxygen-plc-action-container">
        <div class="actions">
        </div>
    </div>
`).querySelector(".windpressoxygen-plc-action-container"),N=w.querySelector(".actions"),b=document.createRange().createContextualFragment(`
        <span id="windpressoxygen-plc-class-sort" class="oxygen-svg-wrapper windpressoxygen-plc-class-sort">
            <svg  xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round" class="oxygen-svg icon icon-tabler icons-tabler-outline icon-tabler-reorder"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" /><path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" /><path d="M17 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" /><path d="M5 11v-3a3 3 0 0 1 3 -3h8a3 3 0 0 1 3 3v3" /><path d="M16.5 8.5l2.5 2.5l2.5 -2.5" /></svg>    
        </span>
`).querySelector("#windpressoxygen-plc-class-sort");N.appendChild(b);const f=v(!1),h=v(null);let y=null;p(i);let x=[];wp.hooks.addAction("windpressoxygen-autocomplete-items-refresh","windpressoxygen",()=>{x=wp.hooks.applyFilters("windpressoxygen-autocomplete-items",[],i.value)}),wp.hooks.doAction("windpressoxygen-autocomplete-items-refresh");const r=new E({containerClass:"windpressoxygen-tribute-container",autocompleteMode:!0,menuItemLimit:40,noMatchTemplate:"",values:async function(e,n){const t=await wp.hooks.applyFilters("windpressoxygen-autocomplete-items-query",x,e);n(t)},lookup:"value",itemClass:"class-item",menuItemTemplate:function(e){let n="";return e.original.color!==void 0&&(n+=`background-color: ${e.original.color};`),e.original.fontWeight!==void 0&&(n+=`font-weight: ${e.original.fontWeight};`),`
            <span class="class-name" data-tribute-class-name="${e.original.value}">${e.string}</span>
            <span class="class-hint" style="${n}"></span>
        `}});r.setMenuContainer=function(e){this.menuContainer=e};const $=r.events.callbacks;r.events.callbacks=function(){return{...$.call(this),up:(e,n)=>{if(this.tribute.isActive&&this.tribute.current.filteredItems){e.preventDefault(),e.stopPropagation();let t=this.tribute.current.filteredItems.length,s=this.tribute.menuSelected;t>s&&s>0?(this.tribute.menuSelected--,this.setActiveLi()):s===0&&(this.tribute.menuSelected=t-1,this.setActiveLi(),this.tribute.menu.scrollTop=this.tribute.menu.scrollHeight),M()}},down:(e,n)=>{if(this.tribute.isActive&&this.tribute.current.filteredItems){e.preventDefault(),e.stopPropagation();let t=this.tribute.current.filteredItems.length-1,s=this.tribute.menuSelected;t>s?(this.tribute.menuSelected++,this.setActiveLi()):t===s&&(this.tribute.menuSelected=0,this.setActiveLi(),this.tribute.menu.scrollTop=0),M()}}}},r.attach(i);const T=new MutationObserver(function(e){f.value=!e[0].target.classList.contains("ng-hide")});T.observe(document.querySelector(".oxygen-sidebar-currently-editing"),{attributes:!0,attributeFilter:["class"]});const W=o.activateComponent;o.activateComponent=function(e,n,t){W(e,n,t),h.value=o.component.active.id};function C(e){const n=o.component.active.id,t=o.component.active.name;if(n===0)return;const s=o.component.options[n];if(s.model===void 0)return;s.model["custom-attributes"]===void 0&&g.addCustomAttribute("plainclass",e);const a=s.model["custom-attributes"],l=a.find(d=>d.name==="plainclass");l?l.value=e:a.push({name:"plainclass",value:e}),o.component.options[n].model["custom-attributes"]=a,o.setOption(n,t,"custom-attributes"),o.applyCustomAttributes(n)}F([h,f],(e,n)=>{e[0]!==n[0]&&c(()=>{var l;const t=o.component.active.id;if(t===0)return;const s=o.component.options[t];if(s.model===void 0)return;s.model["custom-attributes"]===void 0&&g.addCustomAttribute("plainclass","");const a=s.model["custom-attributes"];i.value=((l=a==null?void 0:a.find(d=>d.name==="plainclass"))==null?void 0:l.value)||"",S()}),e[0]&&e[1]&&c(()=>{const t=document.querySelector(".oxygen-sidebar-currently-editing");t.querySelector(".windpressoxygen-plc-input")===null&&(t.appendChild(w),window.tippy(".windpressoxygen-plc-class-sort",{content:"Automatic Class Sorting",animation:"shift-toward",placement:"right"}),t.appendChild(i),y=new I(i,{highlight:[{highlight:new RegExp("(?<=\\s|^)(?:(?!\\s).)+(?=\\s|$)","g"),className:"word"},{highlight:new RegExp("(?<=\\s)\\s","g"),className:"multispace",blank:!0}]}),p.update(i))})}),i.addEventListener("input",function(e){C(e.target.value)});function S(){c(()=>{try{y.handleInput()}catch{}p.update(i),r.hideMenu()})}i.addEventListener("highlights-updated",function(e){});const z=new MutationObserver(function(e){e.forEach(function(n){n.type==="childList"&&n.addedNodes.length>0&&n.addedNodes.forEach(t=>{t.addEventListener("mouseenter",s=>{const a=t.querySelector(".class-name").dataset.tributeClassName;k(a)}),t.addEventListener("mouseleave",s=>{L()}),t.addEventListener("click",s=>{L()})})})});let u=null;i.addEventListener("tribute-active-true",function(e){u===null&&(u=document.querySelector(".windpressoxygen-tribute-container>ul")),c(()=>{u&&z.observe(u,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class"]})})}),b.addEventListener("click",async function(e){var n,t,s;((s=(t=(n=m.contentWindow.windpress)==null?void 0:n.loaded)==null?void 0:t.module)==null?void 0:s.classSorter)===!0&&(i.value=await m.contentWindow.windpress.module.classSorter.sort(i.value),C(i.value),S())});function k(e){A({action:"windpressoxygen-preview-class",do:"add",elementId:h.value,className:e})}function L(){A({action:"windpressoxygen-preview-class",do:"remove"})}function M(){c(()=>{let e=r.menu.querySelector("li.highlight>span.class-name");k(e.dataset.tributeClassName)})}function A(e){m.contentWindow.postMessage(e,"*")}q("Module loaded!",{module:"plain-classes"});
