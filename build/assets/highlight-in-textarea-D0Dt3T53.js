var rn=Object.defineProperty;var on=(o,e,t)=>e in o?rn(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var h=(o,e,t)=>on(o,typeof e!="symbol"?e+"":e,t);import{B as nt}from"./index-BHzFOpFs.js";var te=new Map;function sn(o){var e=te.get(o);e&&e.destroy()}function an(o){var e=te.get(o);e&&e.update()}var ne=null;typeof window>"u"?((ne=function(o){return o}).destroy=function(o){return o},ne.update=function(o){return o}):((ne=function(o,e){return o&&Array.prototype.forEach.call(o.length?o:[o],function(t){return function(n){if(n&&n.nodeName&&n.nodeName==="TEXTAREA"&&!te.has(n)){var r,s=null,i=window.getComputedStyle(n),l=(r=n.value,function(){c({testForHeightReduction:r===""||!n.value.startsWith(r),restoreTextAlign:null}),r=n.value}),a=(function(p){n.removeEventListener("autosize:destroy",a),n.removeEventListener("autosize:update",u),n.removeEventListener("input",l),window.removeEventListener("resize",u),Object.keys(p).forEach(function(d){return n.style[d]=p[d]}),te.delete(n)}).bind(n,{height:n.style.height,resize:n.style.resize,textAlign:n.style.textAlign,overflowY:n.style.overflowY,overflowX:n.style.overflowX,wordWrap:n.style.wordWrap});n.addEventListener("autosize:destroy",a),n.addEventListener("autosize:update",u),n.addEventListener("input",l),window.addEventListener("resize",u),n.style.overflowX="hidden",n.style.wordWrap="break-word",te.set(n,{destroy:a,update:u}),u()}function c(p){var d,m,f=p.restoreTextAlign,g=f===void 0?null:f,y=p.testForHeightReduction,_=y===void 0||y,C=i.overflowY;if(n.scrollHeight!==0&&(i.resize==="vertical"?n.style.resize="none":i.resize==="both"&&(n.style.resize="horizontal"),_&&(d=function(v){for(var w=[];v&&v.parentNode&&v.parentNode instanceof Element;)v.parentNode.scrollTop&&w.push([v.parentNode,v.parentNode.scrollTop]),v=v.parentNode;return function(){return w.forEach(function(k){var N=k[0],O=k[1];N.style.scrollBehavior="auto",N.scrollTop=O,N.style.scrollBehavior=null})}}(n),n.style.height=""),m=i.boxSizing==="content-box"?n.scrollHeight-(parseFloat(i.paddingTop)+parseFloat(i.paddingBottom)):n.scrollHeight+parseFloat(i.borderTopWidth)+parseFloat(i.borderBottomWidth),i.maxHeight!=="none"&&m>parseFloat(i.maxHeight)?(i.overflowY==="hidden"&&(n.style.overflow="scroll"),m=parseFloat(i.maxHeight)):i.overflowY!=="hidden"&&(n.style.overflow="hidden"),n.style.height=m+"px",g&&(n.style.textAlign=g),d&&d(),s!==m&&(n.dispatchEvent(new Event("autosize:resized",{bubbles:!0})),s=m),C!==i.overflow&&!g)){var S=i.textAlign;i.overflow==="hidden"&&(n.style.textAlign=S==="start"?"end":"start"),c({restoreTextAlign:S,testForHeightReduction:!0})}}function u(){c({testForHeightReduction:!0,restoreTextAlign:null})}}(t)}),o}).destroy=function(o){return o&&Array.prototype.forEach.call(o.length?o:[o],sn),o},ne.update=function(o){return o&&Array.prototype.forEach.call(o.length?o:[o],an),o});var ln=ne;if(Array.prototype.find||(Array.prototype.find=function(o){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof o!="function")throw new TypeError("predicate must be a function");for(var e=Object(this),t=e.length>>>0,n=arguments[1],r,s=0;s<t;s++)if(r=e[s],o.call(n,r,s,e))return r}),window&&typeof window.CustomEvent!="function"){let o=function(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n};typeof window.Event<"u"&&(o.prototype=window.Event.prototype),window.CustomEvent=o}class Ee{constructor(e){this.tribute=e,this.tribute.events=this}static keys(){return[{key:9,value:"TAB"},{key:8,value:"DELETE"},{key:13,value:"ENTER"},{key:27,value:"ESCAPE"},{key:32,value:"SPACE"},{key:38,value:"UP"},{key:40,value:"DOWN"}]}bind(e){e.boundKeydown=this.keydown.bind(e,this),e.boundKeyup=this.keyup.bind(e,this),e.boundInput=this.input.bind(e,this),e.addEventListener("keydown",e.boundKeydown,!1),e.addEventListener("keyup",e.boundKeyup,!1),e.addEventListener("input",e.boundInput,!1)}unbind(e){e.removeEventListener("keydown",e.boundKeydown,!1),e.removeEventListener("keyup",e.boundKeyup,!1),e.removeEventListener("input",e.boundInput,!1),delete e.boundKeydown,delete e.boundKeyup,delete e.boundInput}keydown(e,t){e.shouldDeactivate(t)&&(e.tribute.isActive=!1,e.tribute.hideMenu());let n=this;e.commandEvent=!1,Ee.keys().forEach(r=>{r.key===t.keyCode&&(e.commandEvent=!0,e.callbacks()[r.value.toLowerCase()](t,n))})}input(e,t){e.inputEvent=!0,e.keyup.call(this,e,t)}click(e,t){let n=e.tribute;if(n.menu&&n.menu.contains(t.target)){let r=t.target;for(t.preventDefault(),t.stopPropagation();r.nodeName.toLowerCase()!=="li";)if(r=r.parentNode,!r||r===n.menu)throw new Error("cannot find the <li> container for the click");n.selectItemAtIndex(r.getAttribute("data-index"),t),n.hideMenu()}else n.current.element&&!n.current.externalTrigger&&(n.current.externalTrigger=!1,setTimeout(()=>n.hideMenu()))}keyup(e,t){if(e.inputEvent&&(e.inputEvent=!1),e.updateSelection(this),t.keyCode!==27){if(!e.tribute.allowSpaces&&e.tribute.hasTrailingSpace){e.tribute.hasTrailingSpace=!1,e.commandEvent=!0,e.callbacks().space(t,this);return}if(!e.tribute.isActive)if(e.tribute.autocompleteMode)e.callbacks().triggerChar(t,this,"");else{let n=e.getKeyCode(e,this,t);if(isNaN(n)||!n)return;let r=e.tribute.triggers().find(s=>s.charCodeAt(0)===n);typeof r<"u"&&e.callbacks().triggerChar(t,this,r)}e.tribute.current.mentionText.length<e.tribute.current.collection.menuShowMinLength||((e.tribute.current.trigger||e.tribute.autocompleteMode)&&e.commandEvent===!1||e.tribute.isActive&&t.keyCode===8)&&e.tribute.showMenuFor(this,!0)}}shouldDeactivate(e){if(!this.tribute.isActive)return!1;if(this.tribute.current.mentionText.length===0){let t=!1;return Ee.keys().forEach(n=>{e.keyCode===n.key&&(t=!0)}),!t}return!1}getKeyCode(e,t,n){let r=e.tribute,s=r.range.getTriggerInfo(!1,r.hasTrailingSpace,!0,r.allowSpaces,r.autocompleteMode);return s?s.mentionTriggerChar.charCodeAt(0):!1}updateSelection(e){this.tribute.current.element=e;let t=this.tribute.range.getTriggerInfo(!1,this.tribute.hasTrailingSpace,!0,this.tribute.allowSpaces,this.tribute.autocompleteMode);t&&(this.tribute.current.selectedPath=t.mentionSelectedPath,this.tribute.current.mentionText=t.mentionText,this.tribute.current.selectedOffset=t.mentionSelectedOffset)}callbacks(){return{triggerChar:(e,t,n)=>{let r=this.tribute;r.current.trigger=n;let s=r.collection.find(i=>i.trigger===n);r.current.collection=s,r.current.mentionText.length>=r.current.collection.menuShowMinLength&&r.inputEvent&&r.showMenuFor(t,!0)},enter:(e,t)=>{this.tribute.isActive&&this.tribute.current.filteredItems&&(e.preventDefault(),e.stopPropagation(),setTimeout(()=>{this.tribute.selectItemAtIndex(this.tribute.menuSelected,e),this.tribute.hideMenu()},0))},escape:(e,t)=>{this.tribute.isActive&&(e.preventDefault(),e.stopPropagation(),this.tribute.isActive=!1,this.tribute.hideMenu())},tab:(e,t)=>{this.callbacks().enter(e,t)},space:(e,t)=>{this.tribute.isActive&&(this.tribute.spaceSelectsMatch?this.callbacks().enter(e,t):this.tribute.allowSpaces||(e.stopPropagation(),setTimeout(()=>{this.tribute.hideMenu(),this.tribute.isActive=!1},0)))},up:(e,t)=>{if(this.tribute.isActive&&this.tribute.current.filteredItems){e.preventDefault(),e.stopPropagation();let n=this.tribute.current.filteredItems.length,r=this.tribute.menuSelected;n>r&&r>0?(this.tribute.menuSelected--,this.setActiveLi()):r===0&&(this.tribute.menuSelected=n-1,this.setActiveLi(),this.tribute.menu.scrollTop=this.tribute.menu.scrollHeight)}},down:(e,t)=>{if(this.tribute.isActive&&this.tribute.current.filteredItems){e.preventDefault(),e.stopPropagation();let n=this.tribute.current.filteredItems.length-1,r=this.tribute.menuSelected;n>r?(this.tribute.menuSelected++,this.setActiveLi()):n===r&&(this.tribute.menuSelected=0,this.setActiveLi(),this.tribute.menu.scrollTop=0)}},delete:(e,t)=>{this.tribute.isActive&&this.tribute.current.mentionText.length<1?this.tribute.hideMenu():this.tribute.isActive&&this.tribute.showMenuFor(t)}}}setActiveLi(e){let t=this.tribute.menu.querySelectorAll("li"),n=t.length>>>0;e&&(this.tribute.menuSelected=parseInt(e));for(let r=0;r<n;r++){let s=t[r];if(r===this.tribute.menuSelected){s.classList.add(this.tribute.current.collection.selectClass);let i=s.getBoundingClientRect(),l=this.tribute.menu.getBoundingClientRect();if(i.bottom>l.bottom){let a=i.bottom-l.bottom;this.tribute.menu.scrollTop+=a}else if(i.top<l.top){let a=l.top-i.top;this.tribute.menu.scrollTop-=a}}else s.classList.remove(this.tribute.current.collection.selectClass)}}getFullHeight(e,t){let n=e.getBoundingClientRect().height;if(t){let r=e.currentStyle||window.getComputedStyle(e);return n+parseFloat(r.marginTop)+parseFloat(r.marginBottom)}return n}}class cn{constructor(e){this.tribute=e,this.tribute.menuEvents=this,this.menu=this.tribute.menu}bind(e){this.menuClickEvent=this.tribute.events.click.bind(null,this),this.menuContainerScrollEvent=this.debounce(()=>{this.tribute.isActive&&this.tribute.hideMenu()},10,!1),this.windowResizeEvent=this.debounce(()=>{this.tribute.isActive&&this.tribute.hideMenu()},10,!1),this.tribute.range.getDocument().addEventListener("MSPointerDown",this.menuClickEvent,!1),this.tribute.range.getDocument().addEventListener("mousedown",this.menuClickEvent,!1),window.addEventListener("resize",this.windowResizeEvent),this.menuContainer?this.menuContainer.addEventListener("scroll",this.menuContainerScrollEvent,!1):window.addEventListener("scroll",this.menuContainerScrollEvent)}unbind(e){this.tribute.range.getDocument().removeEventListener("mousedown",this.menuClickEvent,!1),this.tribute.range.getDocument().removeEventListener("MSPointerDown",this.menuClickEvent,!1),window.removeEventListener("resize",this.windowResizeEvent),this.menuContainer?this.menuContainer.removeEventListener("scroll",this.menuContainerScrollEvent,!1):window.removeEventListener("scroll",this.menuContainerScrollEvent)}debounce(e,t,n){var r;return()=>{var s=this,i=arguments,l=()=>{r=null,n||e.apply(s,i)},a=n&&!r;clearTimeout(r),r=setTimeout(l,t),a&&e.apply(s,i)}}}class un{constructor(e){this.tribute=e,this.tribute.range=this}getDocument(){let e;return this.tribute.current.collection&&(e=this.tribute.current.collection.iframe),e?e.contentWindow.document:document}positionMenuAtCaret(e){let t=this.tribute.current,n,r=this.getTriggerInfo(!1,this.tribute.hasTrailingSpace,!0,this.tribute.allowSpaces,this.tribute.autocompleteMode);if(typeof r<"u"){if(!this.tribute.positionMenu){this.tribute.menu.style.cssText="display: block;";return}this.isContentEditable(t.element)?n=this.getContentEditableCaretPosition(r.mentionPosition):n=this.getTextAreaOrInputUnderlinePosition(this.tribute.current.element,r.mentionPosition),this.tribute.menu.style.cssText=`top: ${n.top}px;
                                     left: ${n.left}px;
                                     right: ${n.right}px;
                                     bottom: ${n.bottom}px;
                                     max-height: ${n.maxHeight||500}px;
                                     max-width: ${n.maxWidth||300}px;
                                     position: ${n.position||"absolute"};
                                     display: block;`,n.left==="auto"&&(this.tribute.menu.style.left="auto"),n.top==="auto"&&(this.tribute.menu.style.top="auto"),e&&this.scrollIntoView()}else this.tribute.menu.style.cssText="display: none"}get menuContainerIsBody(){return this.tribute.menuContainer===document.body||!this.tribute.menuContainer}selectElement(e,t,n){let r,s=e;if(t)for(var i=0;i<t.length;i++){if(s=s.childNodes[t[i]],s===void 0)return;for(;s.length<n;)n-=s.length,s=s.nextSibling;s.childNodes.length===0&&!s.length&&(s=s.previousSibling)}let l=this.getWindowSelection();r=this.getDocument().createRange(),r.setStart(s,n),r.setEnd(s,n),r.collapse(!0);try{l.removeAllRanges()}catch{}l.addRange(r),e.focus()}replaceTriggerText(e,t,n,r,s){let i=this.getTriggerInfo(!0,n,t,this.tribute.allowSpaces,this.tribute.autocompleteMode);if(i!==void 0){let l=this.tribute.current,a=new CustomEvent("tribute-replaced",{detail:{item:s,instance:l,context:i,event:r}});if(this.isContentEditable(l.element)){let c=typeof this.tribute.replaceTextSuffix=="string"?this.tribute.replaceTextSuffix:"\xA0";e+=c;let u=i.mentionPosition+i.mentionText.length;this.tribute.autocompleteMode||(u+=i.mentionTriggerChar.length),this.pasteHtml(e,i.mentionPosition,u)}else{let c=this.tribute.current.element,u=typeof this.tribute.replaceTextSuffix=="string"?this.tribute.replaceTextSuffix:" ";e+=u;let p=i.mentionPosition,d=i.mentionPosition+i.mentionText.length+u.length;this.tribute.autocompleteMode||(d+=i.mentionTriggerChar.length-1),c.value=c.value.substring(0,p)+e+c.value.substring(d,c.value.length),c.selectionStart=p+e.length,c.selectionEnd=p+e.length}l.element.dispatchEvent(new CustomEvent("input",{bubbles:!0})),l.element.dispatchEvent(a)}}pasteHtml(e,t,n){let r,s;s=this.getWindowSelection(),r=this.getDocument().createRange(),r.setStart(s.anchorNode,t),r.setEnd(s.anchorNode,n),r.deleteContents();let i=this.getDocument().createElement("div");i.innerHTML=e;let l=this.getDocument().createDocumentFragment(),a,c;for(;a=i.firstChild;)c=l.appendChild(a);r.insertNode(l),c&&(r=r.cloneRange(),r.setStartAfter(c),r.collapse(!0),s.removeAllRanges(),s.addRange(r))}getWindowSelection(){return this.tribute.collection.iframe?this.tribute.collection.iframe.contentWindow.getSelection():window.getSelection()}getNodePositionInParent(e){if(e.parentNode===null)return 0;for(var t=0;t<e.parentNode.childNodes.length;t++)if(e.parentNode.childNodes[t]===e)return t}getContentEditableSelectedPath(e){let t=this.getWindowSelection(),n=t.anchorNode,r=[],s;if(n!=null){let i,l=n.contentEditable;for(;n!==null&&l!=="true";)i=this.getNodePositionInParent(n),r.push(i),n=n.parentNode,n!==null&&(l=n.contentEditable);return r.reverse(),s=t.getRangeAt(0).startOffset,{selected:n,path:r,offset:s}}}getTextPrecedingCurrentSelection(){let e=this.tribute.current,t="";if(this.isContentEditable(e.element)){let n=this.getWindowSelection().anchorNode;if(n!=null){let r=n.textContent,s=this.getWindowSelection().getRangeAt(0).startOffset;r&&s>=0&&(t=r.substring(0,s))}}else{let n=this.tribute.current.element;if(n){let r=n.selectionStart;n.value&&r>=0&&(t=n.value.substring(0,r))}}return t}getLastWordInText(e){e=e.replace(/\u00A0/g," ");var t;this.tribute.autocompleteSeparator?t=e.split(this.tribute.autocompleteSeparator):t=e.split(/\s+/);var n=t.length-1;return t[n].trim()}getTriggerInfo(e,t,n,r,s){let i=this.tribute.current,l,a,c;if(!this.isContentEditable(i.element))l=this.tribute.current.element;else{let d=this.getContentEditableSelectedPath(i);d&&(l=d.selected,a=d.path,c=d.offset)}let u=this.getTextPrecedingCurrentSelection(),p=this.getLastWordInText(u);if(s)return{mentionPosition:u.length-p.length,mentionText:p,mentionSelectedElement:l,mentionSelectedPath:a,mentionSelectedOffset:c};if(u!=null){let d=-1,m;if(this.tribute.collection.forEach(f=>{let g=f.trigger,y=f.requireLeadingSpace?this.lastIndexWithLeadingSpace(u,g):u.lastIndexOf(g);y>d&&(d=y,m=g,n=f.requireLeadingSpace)}),d>=0&&(d===0||!n||/[\xA0\s]/g.test(u.substring(d-1,d)))){let f=u.substring(d+m.length,u.length);m=u.substring(d,d+m.length);let g=f.substring(0,1),y=f.length>0&&(g===" "||g==="\xA0");t&&(f=f.trim());let _=r?/[^\S ]/g:/[\xA0\s]/g;if(this.tribute.hasTrailingSpace=_.test(f),!y&&(e||!_.test(f)))return{mentionPosition:d,mentionText:f,mentionSelectedElement:l,mentionSelectedPath:a,mentionSelectedOffset:c,mentionTriggerChar:m}}}}lastIndexWithLeadingSpace(e,t){let n=e.split("").reverse().join(""),r=-1;for(let s=0,i=e.length;s<i;s++){let l=s===e.length-1,a=/\s/.test(n[s+1]),c=!0;for(let u=t.length-1;u>=0;u--)if(t[u]!==n[s-u]){c=!1;break}if(c&&(l||a)){r=e.length-1-s;break}}return r}isContentEditable(e){return e.nodeName!=="INPUT"&&e.nodeName!=="TEXTAREA"}isMenuOffScreen(e,t){let n=window.innerWidth,r=window.innerHeight,s=document.documentElement,i=(window.pageXOffset||s.scrollLeft)-(s.clientLeft||0),l=(window.pageYOffset||s.scrollTop)-(s.clientTop||0),a=typeof e.top=="number"?e.top:l+r-e.bottom-t.height,c=typeof e.right=="number"?e.right:e.left+t.width,u=typeof e.bottom=="number"?e.bottom:e.top+t.height,p=typeof e.left=="number"?e.left:i+n-e.right-t.width;return{top:a<Math.floor(l),right:c>Math.ceil(i+n),bottom:u>Math.ceil(l+r),left:p<Math.floor(i)}}getMenuDimensions(){let e={width:null,height:null};return this.tribute.menu.style.cssText=`top: 0px;
                                 left: 0px;
                                 position: fixed;
                                 display: block;
                                 visibility; hidden;
                                 max-height:500px;`,e.width=this.tribute.menu.offsetWidth,e.height=this.tribute.menu.offsetHeight,this.tribute.menu.style.cssText="display: none;",e}getTextAreaOrInputUnderlinePosition(e,t,n){let r=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing"],s=this.getDocument().createElement("div");s.id="input-textarea-caret-position-mirror-div",this.getDocument().body.appendChild(s);let i=s.style,l=window.getComputedStyle?getComputedStyle(e):e.currentStyle;i.whiteSpace="pre-wrap",e.nodeName!=="INPUT"&&(i.wordWrap="break-word"),i.position="absolute",i.visibility="hidden",r.forEach(m=>{i[m]=l[m]});let a=document.createElement("span");a.textContent=e.value.substring(0,t),s.appendChild(a),e.nodeName==="INPUT"&&(s.textContent=s.textContent.replace(/\s/g,"\xA0"));let c=this.getDocument().createElement("span");c.textContent="&#x200B;",s.appendChild(c);let u=this.getDocument().createElement("span");u.textContent=e.value.substring(t),s.appendChild(u);let p=e.getBoundingClientRect();s.style.position="fixed",s.style.left=p.left+"px",s.style.top=p.top+"px",s.style.width=p.width+"px",s.style.height=p.height+"px",s.scrollTop=e.scrollTop;var d=c.getBoundingClientRect();return this.getDocument().body.removeChild(s),this.getFixedCoordinatesRelativeToRect(d)}getContentEditableCaretPosition(e){let t,n=this.getWindowSelection();t=this.getDocument().createRange(),t.setStart(n.anchorNode,e),t.setEnd(n.anchorNode,e),t.collapse(!1);let r=t.getBoundingClientRect();return this.getFixedCoordinatesRelativeToRect(r)}getFixedCoordinatesRelativeToRect(e){let t={position:"fixed",left:e.left,top:e.top+e.height},n=this.getMenuDimensions();var r=e.top,s=window.innerHeight-(e.top+e.height);s<n.height&&(r>=n.height||r>s?(t.top="auto",t.bottom=window.innerHeight-e.top,s<n.height&&(t.maxHeight=r)):r<n.height&&(t.maxHeight=s));var i=e.left,l=window.innerWidth-e.left;return l<n.width&&(i>=n.width||i>l?(t.left="auto",t.right=window.innerWidth-e.left,l<n.width&&(t.maxWidth=i)):i<n.width&&(t.maxWidth=l)),t}scrollIntoView(e){let t=20,n,r=100,s=this.menu;if(typeof s>"u")return;for(;n===void 0||n.height===0;)if(n=s.getBoundingClientRect(),n.height===0&&(s=s.childNodes[0],s===void 0||!s.getBoundingClientRect))return;let i=n.top,l=i+n.height;if(i<0)window.scrollTo(0,window.pageYOffset+n.top-t);else if(l>window.innerHeight){let a=window.pageYOffset+n.top-t;a-window.pageYOffset>r&&(a=window.pageYOffset+r);let c=window.pageYOffset-(window.innerHeight-l);c>a&&(c=a),window.scrollTo(0,c)}}}class hn{constructor(e){this.tribute=e,this.tribute.search=this}simpleFilter(e,t){return t.filter(n=>this.test(e,n))}test(e,t){return this.match(e,t)!==null}match(e,t,n){n=n||{},t.length;let r=n.pre||"",s=n.post||"",i=n.caseSensitive&&t||t.toLowerCase();if(n.skip)return{rendered:t,score:0};e=n.caseSensitive&&e||e.toLowerCase();let l=this.traverse(i,e,0,0,[]);return l?{rendered:this.render(t,l.cache,r,s),score:l.score}:null}traverse(e,t,n,r,s){if(this.tribute.autocompleteSeparator&&(t=t.split(this.tribute.autocompleteSeparator).splice(-1)[0]),t.length===r)return{score:this.calculateScore(s),cache:s.slice()};if(e.length===n||t.length-r>e.length-n)return;let i=t[r],l=e.indexOf(i,n),a,c;for(;l>-1;){if(s.push(l),c=this.traverse(e,t,l+1,r+1,s),s.pop(),!c)return a;(!a||a.score<c.score)&&(a=c),l=e.indexOf(i,l+1)}return a}calculateScore(e){let t=0,n=1;return e.forEach((r,s)=>{s>0&&(e[s-1]+1===r?n+=n+1:n=1),t+=n}),t}render(e,t,n,r){var s=e.substring(0,t[0]);return t.forEach((i,l)=>{s+=n+e[i]+r+e.substring(i+1,t[l+1]?t[l+1]:e.length)}),s}filter(e,t,n){return n=n||{},t.reduce((r,s,i,l)=>{let a=s;n.extract&&(a=n.extract(s),a||(a=""));let c=this.match(e,a,n);return c!=null&&(r[r.length]={string:c.rendered,score:c.score,index:i,original:s}),r},[]).sort((r,s)=>s.score-r.score||r.index-s.index)}}class K{constructor({values:e=null,loadingItemTemplate:t=null,iframe:n=null,selectClass:r="highlight",containerClass:s="tribute-container",itemClass:i="",trigger:l="@",autocompleteMode:a=!1,autocompleteSeparator:c=null,selectTemplate:u=null,menuItemTemplate:p=null,lookup:d="key",fillAttr:m="value",collection:f=null,menuContainer:g=null,noMatchTemplate:y=null,requireLeadingSpace:_=!0,allowSpaces:C=!1,replaceTextSuffix:S=null,positionMenu:v=!0,spaceSelectsMatch:w=!1,searchOpts:k={},menuItemLimit:N=null,menuShowMinLength:O=0}){if(this.autocompleteMode=a,this.autocompleteSeparator=c,this.menuSelected=0,this.current={},this.inputEvent=!1,this.isActive=!1,this.menuContainer=g,this.allowSpaces=C,this.replaceTextSuffix=S,this.positionMenu=v,this.hasTrailingSpace=!1,this.spaceSelectsMatch=w,this.autocompleteMode&&(l="",C=!1),e)this.collection=[{trigger:l,iframe:n,selectClass:r,containerClass:s,itemClass:i,selectTemplate:(u||K.defaultSelectTemplate).bind(this),menuItemTemplate:(p||K.defaultMenuItemTemplate).bind(this),noMatchTemplate:(x=>typeof x=="string"?x.trim()===""?null:x:typeof x=="function"?x.bind(this):y||(function(){return"<li>No Match Found!</li>"}).bind(this))(y),lookup:d,fillAttr:m,values:e,loadingItemTemplate:t,requireLeadingSpace:_,searchOpts:k,menuItemLimit:N,menuShowMinLength:O}];else if(f)this.autocompleteMode&&console.warn("Tribute in autocomplete mode does not work for collections"),this.collection=f.map(x=>({trigger:x.trigger||l,iframe:x.iframe||n,selectClass:x.selectClass||r,containerClass:x.containerClass||s,itemClass:x.itemClass||i,selectTemplate:(x.selectTemplate||K.defaultSelectTemplate).bind(this),menuItemTemplate:(x.menuItemTemplate||K.defaultMenuItemTemplate).bind(this),noMatchTemplate:(j=>typeof j=="string"?j.trim()===""?null:j:typeof j=="function"?j.bind(this):y||(function(){return"<li>No Match Found!</li>"}).bind(this))(y),lookup:x.lookup||d,fillAttr:x.fillAttr||m,values:x.values,loadingItemTemplate:x.loadingItemTemplate,requireLeadingSpace:x.requireLeadingSpace,searchOpts:x.searchOpts||k,menuItemLimit:x.menuItemLimit||N,menuShowMinLength:x.menuShowMinLength||O}));else throw new Error("[Tribute] No collection specified.");new un(this),new Ee(this),new cn(this),new hn(this)}get isActive(){return this._isActive}set isActive(e){if(this._isActive!=e&&(this._isActive=e,this.current.element)){let t=new CustomEvent(`tribute-active-${e}`);this.current.element.dispatchEvent(t)}}static defaultSelectTemplate(e){return typeof e>"u"?`${this.current.collection.trigger}${this.current.mentionText}`:this.range.isContentEditable(this.current.element)?'<span class="tribute-mention">'+(this.current.collection.trigger+e.original[this.current.collection.fillAttr])+"</span>":this.current.collection.trigger+e.original[this.current.collection.fillAttr]}static defaultMenuItemTemplate(e){return e.string}static inputTypes(){return["TEXTAREA","INPUT"]}triggers(){return this.collection.map(e=>e.trigger)}attach(e){if(!e)throw new Error("[Tribute] Must pass in a DOM node or NodeList.");if(typeof jQuery<"u"&&e instanceof jQuery&&(e=e.get()),e.constructor===NodeList||e.constructor===HTMLCollection||e.constructor===Array){let n=e.length;for(var t=0;t<n;++t)this._attach(e[t])}else this._attach(e)}_attach(e){e.hasAttribute("data-tribute")&&console.warn("Tribute was already bound to "+e.nodeName),this.ensureEditable(e),this.events.bind(e),e.setAttribute("data-tribute",!0)}ensureEditable(e){if(K.inputTypes().indexOf(e.nodeName)===-1)if(e.contentEditable)e.contentEditable=!0;else throw new Error("[Tribute] Cannot bind to "+e.nodeName)}createMenu(e){let t=this.range.getDocument().createElement("div"),n=this.range.getDocument().createElement("ul");return t.className=e,t.appendChild(n),this.menuContainer?this.menuContainer.appendChild(t):this.range.getDocument().body.appendChild(t)}showMenuFor(e,t){if(this.isActive&&this.current.element===e&&this.current.mentionText===this.currentMentionTextSnapshot)return;this.currentMentionTextSnapshot=this.current.mentionText,this.menu||(this.menu=this.createMenu(this.current.collection.containerClass),e.tributeMenu=this.menu,this.menuEvents.bind(this.menu)),this.isActive=!0,this.menuSelected=0,this.current.mentionText||(this.current.mentionText="");const n=r=>{if(!this.isActive)return;let s=this.search.filter(this.current.mentionText,r,{pre:this.current.collection.searchOpts.pre||"<span>",post:this.current.collection.searchOpts.post||"</span>",skip:this.current.collection.searchOpts.skip,extract:a=>{if(typeof this.current.collection.lookup=="string")return a[this.current.collection.lookup];if(typeof this.current.collection.lookup=="function")return this.current.collection.lookup(a,this.current.mentionText);throw new Error("Invalid lookup attribute, lookup must be string or function.")}});this.current.collection.menuItemLimit&&(s=s.slice(0,this.current.collection.menuItemLimit)),this.current.filteredItems=s;let i=this.menu.querySelector("ul");if(!s.length){let a=new CustomEvent("tribute-no-match",{detail:this.menu});this.current.element.dispatchEvent(a),typeof this.current.collection.noMatchTemplate=="function"&&!this.current.collection.noMatchTemplate()||!this.current.collection.noMatchTemplate?this.hideMenu():(typeof this.current.collection.noMatchTemplate=="function"?i.innerHTML=this.current.collection.noMatchTemplate():i.innerHTML=this.current.collection.noMatchTemplate,this.range.positionMenuAtCaret(t));return}i.innerHTML="";let l=this.range.getDocument().createDocumentFragment();s.forEach((a,c)=>{let u=this.range.getDocument().createElement("li");u.setAttribute("data-index",c),u.className=this.current.collection.itemClass,u.addEventListener("mousemove",p=>{let[d,m]=this._findLiTarget(p.target);p.movementY!==0&&this.events.setActiveLi(m)}),this.menuSelected===c&&u.classList.add(this.current.collection.selectClass),u.innerHTML=this.current.collection.menuItemTemplate(a),l.appendChild(u)}),i.appendChild(l),this.range.positionMenuAtCaret(t)};typeof this.current.collection.values=="function"?(this.current.collection.loadingItemTemplate&&(this.menu.querySelector("ul").innerHTML=this.current.collection.loadingItemTemplate,this.range.positionMenuAtCaret(t)),this.current.collection.values(this.current.mentionText,n)):n(this.current.collection.values)}_findLiTarget(e){if(!e)return[];const t=e.getAttribute("data-index");return t?[e,t]:this._findLiTarget(e.parentNode)}showMenuForCollection(e,t){e!==document.activeElement&&this.placeCaretAtEnd(e),this.current.collection=this.collection[t||0],this.current.externalTrigger=!0,this.current.element=e,e.isContentEditable?this.insertTextAtCursor(this.current.collection.trigger):this.insertAtCaret(e,this.current.collection.trigger),this.showMenuFor(e)}placeCaretAtEnd(e){if(e.focus(),typeof window.getSelection<"u"&&typeof document.createRange<"u"){var t=document.createRange();t.selectNodeContents(e),t.collapse(!1);var n=window.getSelection();n.removeAllRanges(),n.addRange(t)}else if(typeof document.body.createTextRange<"u"){var r=document.body.createTextRange();r.moveToElementText(e),r.collapse(!1),r.select()}}insertTextAtCursor(e){var t,n;t=window.getSelection(),n=t.getRangeAt(0),n.deleteContents();var r=document.createTextNode(e);n.insertNode(r),n.selectNodeContents(r),n.collapse(!1),t.removeAllRanges(),t.addRange(n)}insertAtCaret(e,t){var n=e.scrollTop,r=e.selectionStart,s=e.value.substring(0,r),i=e.value.substring(e.selectionEnd,e.value.length);e.value=s+t+i,r=r+t.length,e.selectionStart=r,e.selectionEnd=r,e.focus(),e.scrollTop=n}hideMenu(){this.menu&&(this.menu.style.cssText="display: none;",this.isActive=!1,this.menuSelected=0,this.current={})}selectItemAtIndex(e,t){if(e=parseInt(e),typeof e!="number"||isNaN(e))return;let n=this.current.filteredItems[e],r=this.current.collection.selectTemplate(n);r!==null&&this.replaceText(r,t,n)}replaceText(e,t,n){this.range.replaceTriggerText(e,!0,!0,t,n)}_append(e,t,n){if(typeof e.values=="function")throw new Error("Unable to append to values, as it is a function.");n?e.values=t:e.values=e.values.concat(t)}append(e,t,n){let r=parseInt(e);if(typeof r!="number")throw new Error("please provide an index for the collection to update.");let s=this.collection[r];this._append(s,t,n)}appendCurrent(e,t){if(this.isActive)this._append(this.current.collection,e,t);else throw new Error("No active state. Please use append instead and pass an index.")}detach(e){if(!e)throw new Error("[Tribute] Must pass in a DOM node or NodeList.");if(typeof jQuery<"u"&&e instanceof jQuery&&(e=e.get()),e.constructor===NodeList||e.constructor===HTMLCollection||e.constructor===Array){let n=e.length;for(var t=0;t<n;++t)this._detach(e[t])}else this._detach(e)}_detach(e){this.events.unbind(e),e.tributeMenu&&this.menuEvents.unbind(e.tributeMenu),setTimeout(()=>{e.removeAttribute("data-tribute"),this.isActive=!1,e.tributeMenu&&e.tributeMenu.remove()})}}var U;(function(o){o[o.NotSet=-1]="NotSet",o[o.None=0]="None",o[o.Italic=1]="Italic",o[o.Bold=2]="Bold",o[o.Underline=4]="Underline"})(U||(U={}));var X;(function(o){function e(u){return u.toString(2).padStart(32,"0")}o.toBinaryStr=e;function t(u){const p=o.getLanguageId(u),d=o.getTokenType(u),m=o.getFontStyle(u),f=o.getForeground(u),g=o.getBackground(u);console.log({languageId:p,tokenType:d,fontStyle:m,foreground:f,background:g})}o.print=t;function n(u){return(u&255)>>>0}o.getLanguageId=n;function r(u){return(u&768)>>>8}o.getTokenType=r;function s(u){return(u&1024)!==0}o.containsBalancedBrackets=s;function i(u){return(u&30720)>>>11}o.getFontStyle=i;function l(u){return(u&16744448)>>>15}o.getForeground=l;function a(u){return(u&4278190080)>>>24}o.getBackground=a;function c(u,p,d,m,f,g,y){let _=o.getLanguageId(u),C=o.getTokenType(u),S=o.containsBalancedBrackets(u)?1:0,v=o.getFontStyle(u),w=o.getForeground(u),k=o.getBackground(u);return p!==0&&(_=p),d!==8&&(C=d),m!==null&&(S=m?1:0),f!==-1&&(v=f),g!==0&&(w=g),y!==0&&(k=y),(_<<0|C<<8|S<<10|v<<11|w<<15|k<<24)>>>0}o.set=c})(X||(X={}));function de(o,e){const t=[],n=dn(o);let r=n.next();for(;r!==null;){let a=0;if(r.length===2&&r.charAt(1)===":"){switch(r.charAt(0)){case"R":a=1;break;case"L":a=-1;break;default:console.log(`Unknown priority ${r} in scope selector`)}r=n.next()}let c=i();if(t.push({matcher:c,priority:a}),r!==",")break;r=n.next()}return t;function s(){if(r==="-"){r=n.next();const a=s();return c=>!!a&&!a(c)}if(r==="("){r=n.next();const a=l();return r===")"&&(r=n.next()),a}if(rt(r)){const a=[];do a.push(r),r=n.next();while(rt(r));return c=>e(a,c)}return null}function i(){const a=[];let c=s();for(;c;)a.push(c),c=s();return u=>a.every(p=>p(u))}function l(){const a=[];let c=i();for(;c&&(a.push(c),r==="|"||r===",");){do r=n.next();while(r==="|"||r===",");c=i()}return u=>a.some(p=>p(u))}}function rt(o){return!!o&&!!o.match(/[\w\.:]+/)}function dn(o){let e=/([LR]:|[\w\.:][\w\.:\-]*|[\,\|\-\(\)])/g,t=e.exec(o);return{next:()=>{if(!t)return null;const n=t[0];return t=e.exec(o),n}}}function ot(o){typeof o.dispose=="function"&&o.dispose()}function pn(o){return Ie(o)}function Ie(o){return Array.isArray(o)?gn(o):typeof o=="object"?mn(o):o}function gn(o){let e=[];for(let t=0,n=o.length;t<n;t++)e[t]=Ie(o[t]);return e}function mn(o){let e={};for(let t in o)e[t]=Ie(o[t]);return e}function st(o,...e){return e.forEach(t=>{for(let n in t)o[n]=t[n]}),o}function it(o){const e=~o.lastIndexOf("/")||~o.lastIndexOf("\\");return e===0?o:~e===o.length-1?it(o.substring(0,o.length-1)):o.substr(~e+1)}let Me=/\$(\d+)|\${(\d+):\/(downcase|upcase)}/g;class pe{static hasCaptures(e){return e===null?!1:(Me.lastIndex=0,Me.test(e))}static replaceCaptures(e,t,n){return e.replace(Me,(r,s,i,l)=>{let a=n[parseInt(s||i,10)];if(a){let c=t.substring(a.start,a.end);for(;c[0]===".";)c=c.substring(1);switch(l){case"downcase":return c.toLowerCase();case"upcase":return c.toUpperCase();default:return c}}else return r})}}function at(o,e){return o<e?-1:o>e?1:0}function lt(o,e){if(o===null&&e===null)return 0;if(!o)return-1;if(!e)return 1;let t=o.length,n=e.length;if(t===n){for(let r=0;r<t;r++){let s=at(o[r],e[r]);if(s!==0)return s}return 0}return t-n}function ct(o){return!!(/^#[0-9a-f]{6}$/i.test(o)||/^#[0-9a-f]{8}$/i.test(o)||/^#[0-9a-f]{3}$/i.test(o)||/^#[0-9a-f]{4}$/i.test(o))}function ut(o){return o.replace(/[\-\\\{\}\*\+\?\|\^\$\.\,\[\]\(\)\#\s]/g,"\\$&")}class ht{constructor(e){h(this,"fn");h(this,"cache",new Map);this.fn=e}get(e){if(this.cache.has(e))return this.cache.get(e);const t=this.fn(e);return this.cache.set(e,t),t}}class re{constructor(e){h(this,"scopeName");this.scopeName=e}toKey(){return this.scopeName}}class fn{constructor(e,t){h(this,"scopeName");h(this,"ruleName");this.scopeName=e,this.ruleName=t}toKey(){return`${this.scopeName}#${this.ruleName}`}}class bn{constructor(){h(this,"_references",[]);h(this,"_seenReferenceKeys",new Set);h(this,"visitedRule",new Set)}get references(){return this._references}add(e){const t=e.toKey();this._seenReferenceKeys.has(t)||(this._seenReferenceKeys.add(t),this._references.push(e))}}class yn{constructor(e,t){h(this,"repo");h(this,"initialScopeName");h(this,"seenFullScopeRequests",new Set);h(this,"seenPartialScopeRequests",new Set);h(this,"Q");this.repo=e,this.initialScopeName=t,this.seenFullScopeRequests.add(this.initialScopeName),this.Q=[new re(this.initialScopeName)]}processQueue(){const e=this.Q;this.Q=[];const t=new bn;for(const n of e)Sn(n,this.initialScopeName,this.repo,t);for(const n of t.references)if(n instanceof re){if(this.seenFullScopeRequests.has(n.scopeName))continue;this.seenFullScopeRequests.add(n.scopeName),this.Q.push(n)}else{if(this.seenFullScopeRequests.has(n.scopeName)||this.seenPartialScopeRequests.has(n.toKey()))continue;this.seenPartialScopeRequests.add(n.toKey()),this.Q.push(n)}}}function Sn(o,e,t,n){const r=t.lookup(o.scopeName);if(!r){if(o.scopeName===e)throw new Error(`No grammar provided for <${e}>`);return}const s=t.lookup(e);o instanceof re?ge({baseGrammar:s,selfGrammar:r},n):Oe(o.ruleName,{baseGrammar:s,selfGrammar:r,repository:r.repository},n);const i=t.injections(o.scopeName);if(i)for(const l of i)n.add(new re(l))}function Oe(o,e,t){if(e.repository&&e.repository[o]){const n=e.repository[o];me([n],e,t)}}function ge(o,e){o.selfGrammar.patterns&&Array.isArray(o.selfGrammar.patterns)&&me(o.selfGrammar.patterns,{...o,repository:o.selfGrammar.repository},e),o.selfGrammar.injections&&me(Object.values(o.selfGrammar.injections),{...o,repository:o.selfGrammar.repository},e)}function me(o,e,t){for(const n of o){if(t.visitedRule.has(n))continue;t.visitedRule.add(n);const r=n.repository?st({},e.repository,n.repository):e.repository;Array.isArray(n.patterns)&&me(n.patterns,{...e,repository:r},t);const s=n.include;if(!s)continue;const i=dt(s);switch(i.kind){case 0:ge({...e,selfGrammar:e.baseGrammar},t);break;case 1:ge(e,t);break;case 2:Oe(i.ruleName,{...e,repository:r},t);break;case 3:case 4:const l=i.scopeName===e.selfGrammar.scopeName?e.selfGrammar:i.scopeName===e.baseGrammar.scopeName?e.baseGrammar:void 0;if(l){const a={baseGrammar:e.baseGrammar,selfGrammar:l,repository:r};i.kind===4?Oe(i.ruleName,a,t):ge(a,t)}else i.kind===4?t.add(new fn(i.scopeName,i.ruleName)):t.add(new re(i.scopeName));break}}}class vn{constructor(){h(this,"kind",0)}}class _n{constructor(){h(this,"kind",1)}}class wn{constructor(e){h(this,"ruleName");h(this,"kind",2);this.ruleName=e}}class Cn{constructor(e){h(this,"scopeName");h(this,"kind",3);this.scopeName=e}}class kn{constructor(e,t){h(this,"scopeName");h(this,"ruleName");h(this,"kind",4);this.scopeName=e,this.ruleName=t}}function dt(o){if(o==="$base")return new vn;if(o==="$self")return new _n;const e=o.indexOf("#");if(e===-1)return new Cn(o);if(e===0)return new wn(o.substring(1));{const t=o.substring(0,e),n=o.substring(e+1);return new kn(t,n)}}const Tn=/\\(\d+)/,pt=/\\(\d+)/g,An=-1,gt=-2;class oe{constructor(e,t,n,r){h(this,"$location");h(this,"id");h(this,"_nameIsCapturing");h(this,"_name");h(this,"_contentNameIsCapturing");h(this,"_contentName");this.$location=e,this.id=t,this._name=n||null,this._nameIsCapturing=pe.hasCaptures(this._name),this._contentName=r||null,this._contentNameIsCapturing=pe.hasCaptures(this._contentName)}get debugName(){const e=this.$location?`${it(this.$location.filename)}:${this.$location.line}`:"unknown";return`${this.constructor.name}#${this.id} @ ${e}`}getName(e,t){return!this._nameIsCapturing||this._name===null||e===null||t===null?this._name:pe.replaceCaptures(this._name,e,t)}getContentName(e,t){return!this._contentNameIsCapturing||this._contentName===null?this._contentName:pe.replaceCaptures(this._contentName,e,t)}}class xn extends oe{constructor(t,n,r,s,i){super(t,n,r,s);h(this,"retokenizeCapturedWithRuleId");this.retokenizeCapturedWithRuleId=i}dispose(){}collectPatterns(t,n){throw new Error("Not supported!")}compile(t,n){throw new Error("Not supported!")}compileAG(t,n,r,s){throw new Error("Not supported!")}}class Nn extends oe{constructor(t,n,r,s,i){super(t,n,r,null);h(this,"_match");h(this,"captures");h(this,"_cachedCompiledPatterns");this._match=new Y(s,this.id),this.captures=i,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}get debugMatchRegExp(){return`${this._match.source}`}collectPatterns(t,n){n.push(this._match)}compile(t,n){return this._getCachedCompiledPatterns(t).compile(t)}compileAG(t,n,r,s){return this._getCachedCompiledPatterns(t).compileAG(t,r,s)}_getCachedCompiledPatterns(t){return this._cachedCompiledPatterns||(this._cachedCompiledPatterns=new se,this.collectPatterns(t,this._cachedCompiledPatterns)),this._cachedCompiledPatterns}}class mt extends oe{constructor(t,n,r,s,i){super(t,n,r,s);h(this,"hasMissingPatterns");h(this,"patterns");h(this,"_cachedCompiledPatterns");this.patterns=i.patterns,this.hasMissingPatterns=i.hasMissingPatterns,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}collectPatterns(t,n){for(const r of this.patterns)t.getRule(r).collectPatterns(t,n)}compile(t,n){return this._getCachedCompiledPatterns(t).compile(t)}compileAG(t,n,r,s){return this._getCachedCompiledPatterns(t).compileAG(t,r,s)}_getCachedCompiledPatterns(t){return this._cachedCompiledPatterns||(this._cachedCompiledPatterns=new se,this.collectPatterns(t,this._cachedCompiledPatterns)),this._cachedCompiledPatterns}}class De extends oe{constructor(t,n,r,s,i,l,a,c,u,p){super(t,n,r,s);h(this,"_begin");h(this,"beginCaptures");h(this,"_end");h(this,"endHasBackReferences");h(this,"endCaptures");h(this,"applyEndPatternLast");h(this,"hasMissingPatterns");h(this,"patterns");h(this,"_cachedCompiledPatterns");this._begin=new Y(i,this.id),this.beginCaptures=l,this._end=new Y(a||"\uFFFF",-1),this.endHasBackReferences=this._end.hasBackReferences,this.endCaptures=c,this.applyEndPatternLast=u||!1,this.patterns=p.patterns,this.hasMissingPatterns=p.hasMissingPatterns,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}get debugBeginRegExp(){return`${this._begin.source}`}get debugEndRegExp(){return`${this._end.source}`}getEndWithResolvedBackReferences(t,n){return this._end.resolveBackReferences(t,n)}collectPatterns(t,n){n.push(this._begin)}compile(t,n){return this._getCachedCompiledPatterns(t,n).compile(t)}compileAG(t,n,r,s){return this._getCachedCompiledPatterns(t,n).compileAG(t,r,s)}_getCachedCompiledPatterns(t,n){if(!this._cachedCompiledPatterns){this._cachedCompiledPatterns=new se;for(const r of this.patterns)t.getRule(r).collectPatterns(t,this._cachedCompiledPatterns);this.applyEndPatternLast?this._cachedCompiledPatterns.push(this._end.hasBackReferences?this._end.clone():this._end):this._cachedCompiledPatterns.unshift(this._end.hasBackReferences?this._end.clone():this._end)}return this._end.hasBackReferences&&(this.applyEndPatternLast?this._cachedCompiledPatterns.setSource(this._cachedCompiledPatterns.length()-1,n):this._cachedCompiledPatterns.setSource(0,n)),this._cachedCompiledPatterns}}class fe extends oe{constructor(t,n,r,s,i,l,a,c,u){super(t,n,r,s);h(this,"_begin");h(this,"beginCaptures");h(this,"whileCaptures");h(this,"_while");h(this,"whileHasBackReferences");h(this,"hasMissingPatterns");h(this,"patterns");h(this,"_cachedCompiledPatterns");h(this,"_cachedCompiledWhilePatterns");this._begin=new Y(i,this.id),this.beginCaptures=l,this.whileCaptures=c,this._while=new Y(a,gt),this.whileHasBackReferences=this._while.hasBackReferences,this.patterns=u.patterns,this.hasMissingPatterns=u.hasMissingPatterns,this._cachedCompiledPatterns=null,this._cachedCompiledWhilePatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null),this._cachedCompiledWhilePatterns&&(this._cachedCompiledWhilePatterns.dispose(),this._cachedCompiledWhilePatterns=null)}get debugBeginRegExp(){return`${this._begin.source}`}get debugWhileRegExp(){return`${this._while.source}`}getWhileWithResolvedBackReferences(t,n){return this._while.resolveBackReferences(t,n)}collectPatterns(t,n){n.push(this._begin)}compile(t,n){return this._getCachedCompiledPatterns(t).compile(t)}compileAG(t,n,r,s){return this._getCachedCompiledPatterns(t).compileAG(t,r,s)}_getCachedCompiledPatterns(t){if(!this._cachedCompiledPatterns){this._cachedCompiledPatterns=new se;for(const n of this.patterns)t.getRule(n).collectPatterns(t,this._cachedCompiledPatterns)}return this._cachedCompiledPatterns}compileWhile(t,n){return this._getCachedCompiledWhilePatterns(t,n).compile(t)}compileWhileAG(t,n,r,s){return this._getCachedCompiledWhilePatterns(t,n).compileAG(t,r,s)}_getCachedCompiledWhilePatterns(t,n){return this._cachedCompiledWhilePatterns||(this._cachedCompiledWhilePatterns=new se,this._cachedCompiledWhilePatterns.push(this._while.hasBackReferences?this._while.clone():this._while)),this._while.hasBackReferences&&this._cachedCompiledWhilePatterns.setSource(0,n||"\uFFFF"),this._cachedCompiledWhilePatterns}}class I{static createCaptureRule(e,t,n,r,s){return e.registerRule(i=>new xn(t,i,n,r,s))}static getCompiledRuleId(e,t,n){return e.id||t.registerRule(r=>{if(e.id=r,e.match)return new Nn(e.$vscodeTextmateLocation,e.id,e.name,e.match,I._compileCaptures(e.captures,t,n));if(typeof e.begin>"u"){e.repository&&(n=st({},n,e.repository));let s=e.patterns;return typeof s>"u"&&e.include&&(s=[{include:e.include}]),new mt(e.$vscodeTextmateLocation,e.id,e.name,e.contentName,I._compilePatterns(s,t,n))}return e.while?new fe(e.$vscodeTextmateLocation,e.id,e.name,e.contentName,e.begin,I._compileCaptures(e.beginCaptures||e.captures,t,n),e.while,I._compileCaptures(e.whileCaptures||e.captures,t,n),I._compilePatterns(e.patterns,t,n)):new De(e.$vscodeTextmateLocation,e.id,e.name,e.contentName,e.begin,I._compileCaptures(e.beginCaptures||e.captures,t,n),e.end,I._compileCaptures(e.endCaptures||e.captures,t,n),e.applyEndPatternLast,I._compilePatterns(e.patterns,t,n))}),e.id}static _compileCaptures(e,t,n){let r=[];if(e){let s=0;for(const i in e){if(i==="$vscodeTextmateLocation")continue;const l=parseInt(i,10);l>s&&(s=l)}for(let i=0;i<=s;i++)r[i]=null;for(const i in e){if(i==="$vscodeTextmateLocation")continue;const l=parseInt(i,10);let a=0;e[i].patterns&&(a=I.getCompiledRuleId(e[i],t,n)),r[l]=I.createCaptureRule(t,e[i].$vscodeTextmateLocation,e[i].name,e[i].contentName,a)}}return r}static _compilePatterns(e,t,n){let r=[];if(e)for(let s=0,i=e.length;s<i;s++){const l=e[s];let a=-1;if(l.include){const c=dt(l.include);switch(c.kind){case 0:case 1:a=I.getCompiledRuleId(n[l.include],t,n);break;case 2:let u=n[c.ruleName];u&&(a=I.getCompiledRuleId(u,t,n));break;case 3:case 4:const p=c.scopeName,d=c.kind===4?c.ruleName:null,m=t.getExternalGrammar(p,n);if(m)if(d){let f=m.repository[d];f&&(a=I.getCompiledRuleId(f,t,m.repository))}else a=I.getCompiledRuleId(m.repository.$self,t,m.repository);break}}else a=I.getCompiledRuleId(l,t,n);if(a!==-1){const c=t.getRule(a);let u=!1;if((c instanceof mt||c instanceof De||c instanceof fe)&&c.hasMissingPatterns&&c.patterns.length===0&&(u=!0),u)continue;r.push(a)}}return{patterns:r,hasMissingPatterns:(e?e.length:0)!==r.length}}}class Y{constructor(e,t){h(this,"source");h(this,"ruleId");h(this,"hasAnchor");h(this,"hasBackReferences");h(this,"_anchorCache");if(e){const n=e.length;let r=0,s=[],i=!1;for(let l=0;l<n;l++)if(e.charAt(l)==="\\"&&l+1<n){const a=e.charAt(l+1);a==="z"?(s.push(e.substring(r,l)),s.push("$(?!\\n)(?<!\\n)"),r=l+2):(a==="A"||a==="G")&&(i=!0),l++}this.hasAnchor=i,r===0?this.source=e:(s.push(e.substring(r,n)),this.source=s.join(""))}else this.hasAnchor=!1,this.source=e;this.hasAnchor?this._anchorCache=this._buildAnchorCache():this._anchorCache=null,this.ruleId=t,this.hasBackReferences=Tn.test(this.source)}clone(){return new Y(this.source,this.ruleId)}setSource(e){this.source!==e&&(this.source=e,this.hasAnchor&&(this._anchorCache=this._buildAnchorCache()))}resolveBackReferences(e,t){let n=t.map(r=>e.substring(r.start,r.end));return pt.lastIndex=0,this.source.replace(pt,(r,s)=>ut(n[parseInt(s,10)]||""))}_buildAnchorCache(){let e=[],t=[],n=[],r=[],s,i,l,a;for(s=0,i=this.source.length;s<i;s++)l=this.source.charAt(s),e[s]=l,t[s]=l,n[s]=l,r[s]=l,l==="\\"&&s+1<i&&(a=this.source.charAt(s+1),a==="A"?(e[s+1]="\uFFFF",t[s+1]="\uFFFF",n[s+1]="A",r[s+1]="A"):a==="G"?(e[s+1]="\uFFFF",t[s+1]="G",n[s+1]="\uFFFF",r[s+1]="G"):(e[s+1]=a,t[s+1]=a,n[s+1]=a,r[s+1]=a),s++);return{A0_G0:e.join(""),A0_G1:t.join(""),A1_G0:n.join(""),A1_G1:r.join("")}}resolveAnchors(e,t){return!this.hasAnchor||!this._anchorCache?this.source:e?t?this._anchorCache.A1_G1:this._anchorCache.A1_G0:t?this._anchorCache.A0_G1:this._anchorCache.A0_G0}}class se{constructor(){h(this,"_items");h(this,"_hasAnchors");h(this,"_cached");h(this,"_anchorCache");this._items=[],this._hasAnchors=!1,this._cached=null,this._anchorCache={A0_G0:null,A0_G1:null,A1_G0:null,A1_G1:null}}dispose(){this._disposeCaches()}_disposeCaches(){this._cached&&(this._cached.dispose(),this._cached=null),this._anchorCache.A0_G0&&(this._anchorCache.A0_G0.dispose(),this._anchorCache.A0_G0=null),this._anchorCache.A0_G1&&(this._anchorCache.A0_G1.dispose(),this._anchorCache.A0_G1=null),this._anchorCache.A1_G0&&(this._anchorCache.A1_G0.dispose(),this._anchorCache.A1_G0=null),this._anchorCache.A1_G1&&(this._anchorCache.A1_G1.dispose(),this._anchorCache.A1_G1=null)}push(e){this._items.push(e),this._hasAnchors=this._hasAnchors||e.hasAnchor}unshift(e){this._items.unshift(e),this._hasAnchors=this._hasAnchors||e.hasAnchor}length(){return this._items.length}setSource(e,t){this._items[e].source!==t&&(this._disposeCaches(),this._items[e].setSource(t))}compile(e){if(!this._cached){let t=this._items.map(n=>n.source);this._cached=new ft(e,t,this._items.map(n=>n.ruleId))}return this._cached}compileAG(e,t,n){return this._hasAnchors?t?n?(this._anchorCache.A1_G1||(this._anchorCache.A1_G1=this._resolveAnchors(e,t,n)),this._anchorCache.A1_G1):(this._anchorCache.A1_G0||(this._anchorCache.A1_G0=this._resolveAnchors(e,t,n)),this._anchorCache.A1_G0):n?(this._anchorCache.A0_G1||(this._anchorCache.A0_G1=this._resolveAnchors(e,t,n)),this._anchorCache.A0_G1):(this._anchorCache.A0_G0||(this._anchorCache.A0_G0=this._resolveAnchors(e,t,n)),this._anchorCache.A0_G0):this.compile(e)}_resolveAnchors(e,t,n){let r=this._items.map(s=>s.resolveAnchors(t,n));return new ft(e,r,this._items.map(s=>s.ruleId))}}class ft{constructor(e,t,n){h(this,"regExps");h(this,"rules");h(this,"scanner");this.regExps=t,this.rules=n,this.scanner=e.createOnigScanner(t)}dispose(){typeof this.scanner.dispose=="function"&&this.scanner.dispose()}toString(){const e=[];for(let t=0,n=this.rules.length;t<n;t++)e.push("   - "+this.rules[t]+": "+this.regExps[t]);return e.join(`
`)}findNextMatchSync(e,t,n){const r=this.scanner.findNextMatchSync(e,t,n);return r?{ruleId:this.rules[r.index],captureIndices:r.captureIndices}:null}}class be{constructor(e,t,n){h(this,"_colorMap");h(this,"_defaults");h(this,"_root");h(this,"_cachedMatchRoot",new ht(e=>this._root.match(e)));this._colorMap=e,this._defaults=t,this._root=n}static createFromRawTheme(e,t){return this.createFromParsedTheme(Pn(e),t)}static createFromParsedTheme(e,t){return In(e,t)}getColorMap(){return this._colorMap.getColorMap()}getDefaults(){return this._defaults}match(e){if(e===null)return this._defaults;const t=e.scopeName,n=this._cachedMatchRoot.get(t).find(r=>En(e.parent,r.parentScopes));return n?new bt(n.fontStyle,n.foreground,n.background):null}}class V{constructor(e,t){h(this,"parent");h(this,"scopeName");this.parent=e,this.scopeName=t}static push(e,t){for(const n of t)e=new V(e,n);return e}static from(...e){let t=null;for(let n=0;n<e.length;n++)t=new V(t,e[n]);return t}push(e){return new V(this,e)}getSegments(){let e=this;const t=[];for(;e;)t.push(e.scopeName),e=e.parent;return t.reverse(),t}toString(){return this.getSegments().join(" ")}extends(e){return this===e?!0:this.parent===null?!1:this.parent.extends(e)}getExtensionIfDefined(e){const t=[];let n=this;for(;n&&n!==e;)t.push(n.scopeName),n=n.parent;return n===e?t.reverse():void 0}}function En(o,e){if(e===null)return!0;let t=0,n=e[t];for(;o;){if(Ln(o.scopeName,n)){if(t++,t===e.length)return!0;n=e[t]}o=o.parent}return!1}function Ln(o,e){return e===o||o.startsWith(e)&&o[e.length]==="."}class bt{constructor(e,t,n){h(this,"fontStyle");h(this,"foregroundId");h(this,"backgroundId");this.fontStyle=e,this.foregroundId=t,this.backgroundId=n}}function Pn(o){if(!o)return[];if(!o.settings||!Array.isArray(o.settings))return[];let e=o.settings,t=[],n=0;for(let r=0,s=e.length;r<s;r++){let i=e[r];if(!i.settings)continue;let l;if(typeof i.scope=="string"){let p=i.scope;p=p.replace(/^[,]+/,""),p=p.replace(/[,]+$/,""),l=p.split(",")}else Array.isArray(i.scope)?l=i.scope:l=[""];let a=-1;if(typeof i.settings.fontStyle=="string"){a=0;let p=i.settings.fontStyle.split(" ");for(let d=0,m=p.length;d<m;d++)switch(p[d]){case"italic":a=a|1;break;case"bold":a=a|2;break;case"underline":a=a|4;break;case"strikethrough":a=a|8;break}}let c=null;typeof i.settings.foreground=="string"&&ct(i.settings.foreground)&&(c=i.settings.foreground);let u=null;typeof i.settings.background=="string"&&ct(i.settings.background)&&(u=i.settings.background);for(let p=0,d=l.length;p<d;p++){let m=l[p].trim().split(" "),f=m[m.length-1],g=null;m.length>1&&(g=m.slice(0,m.length-1),g.reverse()),t[n++]=new Rn(f,g,r,a,c,u)}}return t}class Rn{constructor(e,t,n,r,s,i){h(this,"scope");h(this,"parentScopes");h(this,"index");h(this,"fontStyle");h(this,"foreground");h(this,"background");this.scope=e,this.parentScopes=t,this.index=n,this.fontStyle=r,this.foreground=s,this.background=i}}function In(o,e){o.sort((a,c)=>{let u=at(a.scope,c.scope);return u!==0||(u=lt(a.parentScopes,c.parentScopes),u!==0)?u:a.index-c.index});let t=0,n="#000000",r="#ffffff";for(;o.length>=1&&o[0].scope==="";){let a=o.shift();a.fontStyle!==-1&&(t=a.fontStyle),a.foreground!==null&&(n=a.foreground),a.background!==null&&(r=a.background)}let s=new Mn(e),i=new bt(t,s.getId(n),s.getId(r)),l=new he(new ue(0,null,-1,0,0),[]);for(let a=0,c=o.length;a<c;a++){let u=o[a];l.insert(0,u.scope,u.parentScopes,u.fontStyle,s.getId(u.foreground),s.getId(u.background))}return new be(s,i,l)}class Mn{constructor(e){h(this,"_isFrozen");h(this,"_lastColorId");h(this,"_id2color");h(this,"_color2id");if(this._lastColorId=0,this._id2color=[],this._color2id=Object.create(null),Array.isArray(e)){this._isFrozen=!0;for(let t=0,n=e.length;t<n;t++)this._color2id[e[t]]=t,this._id2color[t]=e[t]}else this._isFrozen=!1}getId(e){if(e===null)return 0;e=e.toUpperCase();let t=this._color2id[e];if(t)return t;if(this._isFrozen)throw new Error(`Missing color in color map - ${e}`);return t=++this._lastColorId,this._color2id[e]=t,this._id2color[t]=e,t}getColorMap(){return this._id2color.slice(0)}}class ue{constructor(e,t,n,r,s){h(this,"scopeDepth");h(this,"parentScopes");h(this,"fontStyle");h(this,"foreground");h(this,"background");this.scopeDepth=e,this.parentScopes=t,this.fontStyle=n,this.foreground=r,this.background=s}clone(){return new ue(this.scopeDepth,this.parentScopes,this.fontStyle,this.foreground,this.background)}static cloneArr(e){let t=[];for(let n=0,r=e.length;n<r;n++)t[n]=e[n].clone();return t}acceptOverwrite(e,t,n,r){this.scopeDepth>e?console.log("how did this happen?"):this.scopeDepth=e,t!==-1&&(this.fontStyle=t),n!==0&&(this.foreground=n),r!==0&&(this.background=r)}}class he{constructor(e,t=[],n={}){h(this,"_mainRule");h(this,"_children");h(this,"_rulesWithParentScopes");this._mainRule=e,this._children=n,this._rulesWithParentScopes=t}static _sortBySpecificity(e){return e.length===1||e.sort(this._cmpBySpecificity),e}static _cmpBySpecificity(e,t){if(e.scopeDepth===t.scopeDepth){const n=e.parentScopes,r=t.parentScopes;let s=n===null?0:n.length,i=r===null?0:r.length;if(s===i)for(let l=0;l<s;l++){const a=n[l].length,c=r[l].length;if(a!==c)return c-a}return i-s}return t.scopeDepth-e.scopeDepth}match(e){if(e==="")return he._sortBySpecificity([].concat(this._mainRule).concat(this._rulesWithParentScopes));let t=e.indexOf("."),n,r;return t===-1?(n=e,r=""):(n=e.substring(0,t),r=e.substring(t+1)),this._children.hasOwnProperty(n)?this._children[n].match(r):he._sortBySpecificity([].concat(this._mainRule).concat(this._rulesWithParentScopes))}insert(e,t,n,r,s,i){if(t===""){this._doInsertHere(e,n,r,s,i);return}let l=t.indexOf("."),a,c;l===-1?(a=t,c=""):(a=t.substring(0,l),c=t.substring(l+1));let u;this._children.hasOwnProperty(a)?u=this._children[a]:(u=new he(this._mainRule.clone(),ue.cloneArr(this._rulesWithParentScopes)),this._children[a]=u),u.insert(e+1,c,n,r,s,i)}_doInsertHere(e,t,n,r,s){if(t===null){this._mainRule.acceptOverwrite(e,n,r,s);return}for(let i=0,l=this._rulesWithParentScopes.length;i<l;i++){let a=this._rulesWithParentScopes[i];if(lt(a.parentScopes,t)===0){a.acceptOverwrite(e,n,r,s);return}}n===-1&&(n=this._mainRule.fontStyle),r===0&&(r=this._mainRule.foreground),s===0&&(s=this._mainRule.background),this._rulesWithParentScopes.push(new ue(e,t,n,r,s))}}class Be{constructor(e,t){h(this,"languageId");h(this,"tokenType");this.languageId=e,this.tokenType=t}}const ee=class ee{constructor(e,t){h(this,"_defaultAttributes");h(this,"_embeddedLanguagesMatcher");h(this,"_getBasicScopeAttributes",new ht(e=>{const t=this._scopeToLanguage(e),n=this._toStandardTokenType(e);return new Be(t,n)}));this._defaultAttributes=new Be(e,8),this._embeddedLanguagesMatcher=new On(Object.entries(t||{}))}getDefaultAttributes(){return this._defaultAttributes}getBasicScopeAttributes(e){return e===null?ee._NULL_SCOPE_METADATA:this._getBasicScopeAttributes.get(e)}_scopeToLanguage(e){return this._embeddedLanguagesMatcher.match(e)||0}_toStandardTokenType(e){const t=e.match(ee.STANDARD_TOKEN_TYPE_REGEXP);if(!t)return 8;switch(t[1]){case"comment":return 1;case"string":return 2;case"regex":return 3;case"meta.embedded":return 0}throw new Error("Unexpected match for standard token type!")}};h(ee,"_NULL_SCOPE_METADATA",new Be(0,0)),h(ee,"STANDARD_TOKEN_TYPE_REGEXP",/\b(comment|string|regex|meta\.embedded)\b/);let Fe=ee;class On{constructor(e){h(this,"values");h(this,"scopesRegExp");if(e.length===0)this.values=null,this.scopesRegExp=null;else{this.values=new Map(e);const t=e.map(([n,r])=>ut(n));t.sort(),t.reverse(),this.scopesRegExp=new RegExp(`^((${t.join(")|(")}))($|\\.)`,"")}}match(e){if(!this.scopesRegExp)return;const t=e.match(this.scopesRegExp);if(t)return this.values.get(t[1])}}class yt{constructor(e,t){h(this,"stack");h(this,"stoppedEarly");this.stack=e,this.stoppedEarly=t}}function St(o,e,t,n,r,s,i,l){const a=e.content.length;let c=!1,u=-1;if(i){const m=Dn(o,e,t,n,r,s);r=m.stack,n=m.linePos,t=m.isFirstLine,u=m.anchorPosition}const p=Date.now();for(;!c;){if(l!==0&&Date.now()-p>l)return new yt(r,!0);d()}return new yt(r,!1);function d(){const m=Bn(o,e,t,n,r,u);if(!m){s.produce(r,a),c=!0;return}const f=m.captureIndices,g=m.matchedRuleId,y=f&&f.length>0?f[0].end>n:!1;if(g===An){const _=r.getRule(o);s.produce(r,f[0].start),r=r.withContentNameScopesList(r.nameScopesList),ie(o,e,t,r,s,_.endCaptures,f),s.produce(r,f[0].end);const C=r;if(r=r.parent,u=C.getAnchorPos(),!y&&C.getEnterPos()===n){r=C,s.produce(r,a),c=!0;return}}else{const _=o.getRule(g);s.produce(r,f[0].start);const C=r,S=_.getName(e.content,f),v=r.contentNameScopesList.pushAttributed(S,o);if(r=r.push(g,n,u,f[0].end===a,null,v,v),_ instanceof De){const w=_;ie(o,e,t,r,s,w.beginCaptures,f),s.produce(r,f[0].end),u=f[0].end;const k=w.getContentName(e.content,f),N=v.pushAttributed(k,o);if(r=r.withContentNameScopesList(N),w.endHasBackReferences&&(r=r.withEndRule(w.getEndWithResolvedBackReferences(e.content,f))),!y&&C.hasSameRuleAs(r)){r=r.pop(),s.produce(r,a),c=!0;return}}else if(_ instanceof fe){const w=_;ie(o,e,t,r,s,w.beginCaptures,f),s.produce(r,f[0].end),u=f[0].end;const k=w.getContentName(e.content,f),N=v.pushAttributed(k,o);if(r=r.withContentNameScopesList(N),w.whileHasBackReferences&&(r=r.withEndRule(w.getWhileWithResolvedBackReferences(e.content,f))),!y&&C.hasSameRuleAs(r)){r=r.pop(),s.produce(r,a),c=!0;return}}else if(ie(o,e,t,r,s,_.captures,f),s.produce(r,f[0].end),r=r.pop(),!y){r=r.safePop(),s.produce(r,a),c=!0;return}}f[0].end>n&&(n=f[0].end,t=!1)}}function Dn(o,e,t,n,r,s){let i=r.beginRuleCapturedEOL?0:-1;const l=[];for(let a=r;a;a=a.pop()){const c=a.getRule(o);c instanceof fe&&l.push({rule:c,stack:a})}for(let a=l.pop();a;a=l.pop()){const{ruleScanner:c,findOptions:u}=Un(a.rule,o,a.stack.endRule,t,n===i),p=c.findNextMatchSync(e,n,u);if(p){if(p.ruleId!==gt){r=a.stack.pop();break}p.captureIndices&&p.captureIndices.length&&(s.produce(a.stack,p.captureIndices[0].start),ie(o,e,t,a.stack,s,a.rule.whileCaptures,p.captureIndices),s.produce(a.stack,p.captureIndices[0].end),i=p.captureIndices[0].end,p.captureIndices[0].end>n&&(n=p.captureIndices[0].end,t=!1))}else{r=a.stack.pop();break}}return{stack:r,linePos:n,anchorPosition:i,isFirstLine:t}}function Bn(o,e,t,n,r,s){const i=Fn(o,e,t,n,r,s),l=o.getInjections();if(l.length===0)return i;const a=Gn(l,o,e,t,n,r,s);if(!a)return i;if(!i)return a;const c=i.captureIndices[0].start,u=a.captureIndices[0].start;return u<c||a.priorityMatch&&u===c?a:i}function Fn(o,e,t,n,r,s){const i=r.getRule(o),{ruleScanner:l,findOptions:a}=vt(i,o,r.endRule,t,n===s),c=l.findNextMatchSync(e,n,a);return c?{captureIndices:c.captureIndices,matchedRuleId:c.ruleId}:null}function Gn(o,e,t,n,r,s,i){let l=Number.MAX_VALUE,a=null,c,u=0;const p=s.contentNameScopesList.getScopeNames();for(let d=0,m=o.length;d<m;d++){const f=o[d];if(!f.matcher(p))continue;const g=e.getRule(f.ruleId),{ruleScanner:y,findOptions:_}=vt(g,e,null,n,r===i),C=y.findNextMatchSync(t,r,_);if(!C)continue;const S=C.captureIndices[0].start;if(!(S>=l)&&(l=S,a=C.captureIndices,c=C.ruleId,u=f.priority,l===r))break}return a?{priorityMatch:u===-1,captureIndices:a,matchedRuleId:c}:null}function vt(o,e,t,n,r){return{ruleScanner:o.compileAG(e,t,n,r),findOptions:0}}function Un(o,e,t,n,r){return{ruleScanner:o.compileWhileAG(e,t,n,r),findOptions:0}}function ie(o,e,t,n,r,s,i){if(s.length===0)return;const l=e.content,a=Math.min(s.length,i.length),c=[],u=i[0].end;for(let p=0;p<a;p++){const d=s[p];if(d===null)continue;const m=i[p];if(m.length===0)continue;if(m.start>u)break;for(;c.length>0&&c[c.length-1].endPos<=m.start;)r.produceFromScopes(c[c.length-1].scopes,c[c.length-1].endPos),c.pop();if(c.length>0?r.produceFromScopes(c[c.length-1].scopes,m.start):r.produce(n,m.start),d.retokenizeCapturedWithRuleId){const g=d.getName(l,i),y=n.contentNameScopesList.pushAttributed(g,o),_=d.getContentName(l,i),C=y.pushAttributed(_,o),S=n.push(d.retokenizeCapturedWithRuleId,m.start,-1,!1,null,y,C),v=o.createOnigString(l.substring(0,m.end));St(o,v,t&&m.start===0,m.start,S,r,!1,0),ot(v);continue}const f=d.getName(l,i);if(f!==null){const g=(c.length>0?c[c.length-1].scopes:n.contentNameScopesList).pushAttributed(f,o);c.push(new $n(g,m.end))}}for(;c.length>0;)r.produceFromScopes(c[c.length-1].scopes,c[c.length-1].endPos),c.pop()}class $n{constructor(e,t){h(this,"scopes");h(this,"endPos");this.scopes=e,this.endPos=t}}function Wn(o,e,t,n,r,s,i,l){return new Hn(o,e,t,n,r,s,i,l)}function _t(o,e,t,n,r){const s=de(e,ye),i=I.getCompiledRuleId(t,n,r.repository);for(const l of s)o.push({debugSelector:e,matcher:l.matcher,ruleId:i,grammar:r,priority:l.priority})}function ye(o,e){if(e.length<o.length)return!1;let t=0;return o.every(n=>{for(let r=t;r<e.length;r++)if(jn(e[r],n))return t=r+1,!0;return!1})}function jn(o,e){if(!o)return!1;if(o===e)return!0;const t=e.length;return o.length>t&&o.substr(0,t)===e&&o[t]==="."}class Hn{constructor(e,t,n,r,s,i,l,a){h(this,"_rootScopeName");h(this,"balancedBracketSelectors");h(this,"_onigLib");h(this,"_rootId");h(this,"_lastRuleId");h(this,"_ruleId2desc");h(this,"_includedGrammars");h(this,"_grammarRepository");h(this,"_grammar");h(this,"_injections");h(this,"_basicScopeAttributesProvider");h(this,"_tokenTypeMatchers");if(this._rootScopeName=e,this.balancedBracketSelectors=i,this._onigLib=a,this._basicScopeAttributesProvider=new Fe(n,r),this._rootId=-1,this._lastRuleId=0,this._ruleId2desc=[null],this._includedGrammars={},this._grammarRepository=l,this._grammar=wt(t,null),this._injections=null,this._tokenTypeMatchers=[],s)for(const c of Object.keys(s)){const u=de(c,ye);for(const p of u)this._tokenTypeMatchers.push({matcher:p.matcher,type:s[c]})}}get themeProvider(){return this._grammarRepository}dispose(){for(const e of this._ruleId2desc)e&&e.dispose()}createOnigScanner(e){return this._onigLib.createOnigScanner(e)}createOnigString(e){return this._onigLib.createOnigString(e)}getMetadataForScope(e){return this._basicScopeAttributesProvider.getBasicScopeAttributes(e)}_collectInjections(){const e={lookup:s=>s===this._rootScopeName?this._grammar:this.getExternalGrammar(s),injections:s=>this._grammarRepository.injections(s)},t=[],n=this._rootScopeName,r=e.lookup(n);if(r){const s=r.injections;if(s)for(let l in s)_t(t,l,s[l],this,r);const i=this._grammarRepository.injections(n);i&&i.forEach(l=>{const a=this.getExternalGrammar(l);if(a){const c=a.injectionSelector;c&&_t(t,c,a,this,a)}})}return t.sort((s,i)=>s.priority-i.priority),t}getInjections(){return this._injections===null&&(this._injections=this._collectInjections()),this._injections}registerRule(e){const t=++this._lastRuleId,n=e(t);return this._ruleId2desc[t]=n,n}getRule(e){return this._ruleId2desc[e]}getExternalGrammar(e,t){if(this._includedGrammars[e])return this._includedGrammars[e];if(this._grammarRepository){const n=this._grammarRepository.lookup(e);if(n)return this._includedGrammars[e]=wt(n,t&&t.$base),this._includedGrammars[e]}}tokenizeLine(e,t,n=0){const r=this._tokenize(e,t,!1,n);return{tokens:r.lineTokens.getResult(r.ruleStack,r.lineLength),ruleStack:r.ruleStack,stoppedEarly:r.stoppedEarly}}tokenizeLine2(e,t,n=0){const r=this._tokenize(e,t,!0,n);return{tokens:r.lineTokens.getBinaryResult(r.ruleStack,r.lineLength),ruleStack:r.ruleStack,stoppedEarly:r.stoppedEarly}}_tokenize(e,t,n,r){this._rootId===-1&&(this._rootId=I.getCompiledRuleId(this._grammar.repository.$self,this,this._grammar.repository),this.getInjections());let s;if(!t||t===ae.NULL){s=!0;const u=this._basicScopeAttributesProvider.getDefaultAttributes(),p=this.themeProvider.getDefaults(),d=X.set(0,u.languageId,u.tokenType,null,p.fontStyle,p.foregroundId,p.backgroundId),m=this.getRule(this._rootId).getName(null,null);let f;m?f=D.createRootAndLookUpScopeName(m,d,this):f=D.createRoot("unknown",d),t=new ae(null,this._rootId,-1,-1,!1,null,f,f)}else s=!1,t.reset();e=e+`
`;const i=this.createOnigString(e),l=i.content.length,a=new qn(n,e,this._tokenTypeMatchers,this.balancedBracketSelectors),c=St(this,i,s,0,t,a,!0,r);return ot(i),{lineLength:l,lineTokens:a,ruleStack:c.stack,stoppedEarly:c.stoppedEarly}}}function wt(o,e){return o=pn(o),o.repository=o.repository||{},o.repository.$self={$vscodeTextmateLocation:o.$vscodeTextmateLocation,patterns:o.patterns,name:o.scopeName},o.repository.$base=e||o.repository.$self,o}class D{constructor(e,t,n){h(this,"parent");h(this,"scopePath");h(this,"tokenAttributes");this.parent=e,this.scopePath=t,this.tokenAttributes=n}static fromExtension(e,t){let n=e,r=(e==null?void 0:e.scopePath)??null;for(const s of t)r=V.push(r,s.scopeNames),n=new D(n,r,s.encodedTokenAttributes);return n}static createRoot(e,t){return new D(null,new V(null,e),t)}static createRootAndLookUpScopeName(e,t,n){const r=n.getMetadataForScope(e),s=new V(null,e),i=n.themeProvider.themeMatch(s),l=D.mergeAttributes(t,r,i);return new D(null,s,l)}get scopeName(){return this.scopePath.scopeName}toString(){return this.getScopeNames().join(" ")}equals(e){return D.equals(this,e)}static equals(e,t){do{if(e===t||!e&&!t)return!0;if(!e||!t||e.scopeName!==t.scopeName||e.tokenAttributes!==t.tokenAttributes)return!1;e=e.parent,t=t.parent}while(!0)}static mergeAttributes(e,t,n){let r=-1,s=0,i=0;return n!==null&&(r=n.fontStyle,s=n.foregroundId,i=n.backgroundId),X.set(e,t.languageId,t.tokenType,null,r,s,i)}pushAttributed(e,t){if(e===null)return this;if(e.indexOf(" ")===-1)return D._pushAttributed(this,e,t);const n=e.split(/ /g);let r=this;for(const s of n)r=D._pushAttributed(r,s,t);return r}static _pushAttributed(e,t,n){const r=n.getMetadataForScope(t),s=e.scopePath.push(t),i=n.themeProvider.themeMatch(s),l=D.mergeAttributes(e.tokenAttributes,r,i);return new D(e,s,l)}getScopeNames(){return this.scopePath.getSegments()}getExtensionIfDefined(e){var r;const t=[];let n=this;for(;n&&n!==e;)t.push({encodedTokenAttributes:n.tokenAttributes,scopeNames:n.scopePath.getExtensionIfDefined(((r=n.parent)==null?void 0:r.scopePath)??null)}),n=n.parent;return n===e?t.reverse():void 0}}const $=class ${constructor(e,t,n,r,s,i,l,a){h(this,"parent");h(this,"ruleId");h(this,"beginRuleCapturedEOL");h(this,"endRule");h(this,"nameScopesList");h(this,"contentNameScopesList");h(this,"_stackElementBrand");h(this,"_enterPos");h(this,"_anchorPos");h(this,"depth");this.parent=e,this.ruleId=t,this.beginRuleCapturedEOL=s,this.endRule=i,this.nameScopesList=l,this.contentNameScopesList=a,this.depth=this.parent?this.parent.depth+1:1,this._enterPos=n,this._anchorPos=r}equals(e){return e===null?!1:$._equals(this,e)}static _equals(e,t){return e===t?!0:this._structuralEquals(e,t)?D.equals(e.contentNameScopesList,t.contentNameScopesList):!1}static _structuralEquals(e,t){do{if(e===t||!e&&!t)return!0;if(!e||!t||e.depth!==t.depth||e.ruleId!==t.ruleId||e.endRule!==t.endRule)return!1;e=e.parent,t=t.parent}while(!0)}clone(){return this}static _reset(e){for(;e;)e._enterPos=-1,e._anchorPos=-1,e=e.parent}reset(){$._reset(this)}pop(){return this.parent}safePop(){return this.parent?this.parent:this}push(e,t,n,r,s,i,l){return new $(this,e,t,n,r,s,i,l)}getEnterPos(){return this._enterPos}getAnchorPos(){return this._anchorPos}getRule(e){return e.getRule(this.ruleId)}toString(){const e=[];return this._writeString(e,0),"["+e.join(",")+"]"}_writeString(e,t){var n,r;return this.parent&&(t=this.parent._writeString(e,t)),e[t++]=`(${this.ruleId}, ${(n=this.nameScopesList)==null?void 0:n.toString()}, ${(r=this.contentNameScopesList)==null?void 0:r.toString()})`,t}withContentNameScopesList(e){return this.contentNameScopesList===e?this:this.parent.push(this.ruleId,this._enterPos,this._anchorPos,this.beginRuleCapturedEOL,this.endRule,this.nameScopesList,e)}withEndRule(e){return this.endRule===e?this:new $(this.parent,this.ruleId,this._enterPos,this._anchorPos,this.beginRuleCapturedEOL,e,this.nameScopesList,this.contentNameScopesList)}hasSameRuleAs(e){let t=this;for(;t&&t._enterPos===e._enterPos;){if(t.ruleId===e.ruleId)return!0;t=t.parent}return!1}toStateStackFrame(){var e,t,n;return{ruleId:this.ruleId,beginRuleCapturedEOL:this.beginRuleCapturedEOL,endRule:this.endRule,nameScopesList:((t=this.nameScopesList)==null?void 0:t.getExtensionIfDefined(((e=this.parent)==null?void 0:e.nameScopesList)??null))??[],contentNameScopesList:((n=this.contentNameScopesList)==null?void 0:n.getExtensionIfDefined(this.nameScopesList))??[]}}static pushFrame(e,t){const n=D.fromExtension((e==null?void 0:e.nameScopesList)??null,t.nameScopesList);return new $(e,t.ruleId,t.enterPos??-1,t.anchorPos??-1,t.beginRuleCapturedEOL,t.endRule,n,D.fromExtension(n,t.contentNameScopesList))}};h($,"NULL",new $(null,0,0,0,!1,null,null,null));let ae=$;class zn{constructor(e,t){h(this,"balancedBracketScopes");h(this,"unbalancedBracketScopes");h(this,"allowAny",!1);this.balancedBracketScopes=e.flatMap(n=>n==="*"?(this.allowAny=!0,[]):de(n,ye).map(r=>r.matcher)),this.unbalancedBracketScopes=t.flatMap(n=>de(n,ye).map(r=>r.matcher))}get matchesAlways(){return this.allowAny&&this.unbalancedBracketScopes.length===0}get matchesNever(){return this.balancedBracketScopes.length===0&&!this.allowAny}match(e){for(const t of this.unbalancedBracketScopes)if(t(e))return!1;for(const t of this.balancedBracketScopes)if(t(e))return!0;return this.allowAny}}class qn{constructor(e,t,n,r){h(this,"balancedBracketSelectors");h(this,"_emitBinaryTokens");h(this,"_lineText");h(this,"_tokens");h(this,"_binaryTokens");h(this,"_lastTokenEndIndex");h(this,"_tokenTypeOverrides");this.balancedBracketSelectors=r,this._emitBinaryTokens=e,this._tokenTypeOverrides=n,this._lineText=null,this._tokens=[],this._binaryTokens=[],this._lastTokenEndIndex=0}produce(e,t){this.produceFromScopes(e.contentNameScopesList,t)}produceFromScopes(e,t){var r;if(this._lastTokenEndIndex>=t)return;if(this._emitBinaryTokens){let s=(e==null?void 0:e.tokenAttributes)??0,i=!1;if((r=this.balancedBracketSelectors)!=null&&r.matchesAlways&&(i=!0),this._tokenTypeOverrides.length>0||this.balancedBracketSelectors&&!this.balancedBracketSelectors.matchesAlways&&!this.balancedBracketSelectors.matchesNever){const l=(e==null?void 0:e.getScopeNames())??[];for(const a of this._tokenTypeOverrides)a.matcher(l)&&(s=X.set(s,0,a.type,null,-1,0,0));this.balancedBracketSelectors&&(i=this.balancedBracketSelectors.match(l))}if(i&&(s=X.set(s,0,8,i,-1,0,0)),this._binaryTokens.length>0&&this._binaryTokens[this._binaryTokens.length-1]===s){this._lastTokenEndIndex=t;return}this._binaryTokens.push(this._lastTokenEndIndex),this._binaryTokens.push(s),this._lastTokenEndIndex=t;return}const n=(e==null?void 0:e.getScopeNames())??[];this._tokens.push({startIndex:this._lastTokenEndIndex,endIndex:t,scopes:n}),this._lastTokenEndIndex=t}getResult(e,t){return this._tokens.length>0&&this._tokens[this._tokens.length-1].startIndex===t-1&&this._tokens.pop(),this._tokens.length===0&&(this._lastTokenEndIndex=-1,this.produce(e,t),this._tokens[this._tokens.length-1].startIndex=0),this._tokens}getBinaryResult(e,t){this._binaryTokens.length>0&&this._binaryTokens[this._binaryTokens.length-2]===t-1&&(this._binaryTokens.pop(),this._binaryTokens.pop()),this._binaryTokens.length===0&&(this._lastTokenEndIndex=-1,this.produce(e,t),this._binaryTokens[this._binaryTokens.length-2]=0);const n=new Uint32Array(this._binaryTokens.length);for(let r=0,s=this._binaryTokens.length;r<s;r++)n[r]=this._binaryTokens[r];return n}}class Kn{constructor(e,t){h(this,"_onigLibPromise");h(this,"_grammars",new Map);h(this,"_rawGrammars",new Map);h(this,"_injectionGrammars",new Map);h(this,"_theme");this._onigLibPromise=t,this._theme=e}dispose(){for(const e of this._grammars.values())e.dispose()}setTheme(e){this._theme=e}getColorMap(){return this._theme.getColorMap()}addGrammar(e,t){this._rawGrammars.set(e.scopeName,e),t&&this._injectionGrammars.set(e.scopeName,t)}lookup(e){return this._rawGrammars.get(e)}injections(e){return this._injectionGrammars.get(e)}getDefaults(){return this._theme.getDefaults()}themeMatch(e){return this._theme.match(e)}async grammarForScopeName(e,t,n,r,s){if(!this._grammars.has(e)){let i=this._rawGrammars.get(e);if(!i)return null;this._grammars.set(e,Wn(e,i,t,n,r,s,this,await this._onigLibPromise))}return this._grammars.get(e)}}let Yn=class{constructor(o){h(this,"_options");h(this,"_syncRegistry");h(this,"_ensureGrammarCache");this._options=o,this._syncRegistry=new Kn(be.createFromRawTheme(o.theme,o.colorMap),o.onigLib),this._ensureGrammarCache=new Map}dispose(){this._syncRegistry.dispose()}setTheme(o,e){this._syncRegistry.setTheme(be.createFromRawTheme(o,e))}getColorMap(){return this._syncRegistry.getColorMap()}loadGrammarWithEmbeddedLanguages(o,e,t){return this.loadGrammarWithConfiguration(o,e,{embeddedLanguages:t})}loadGrammarWithConfiguration(o,e,t){return this._loadGrammar(o,e,t.embeddedLanguages,t.tokenTypes,new zn(t.balancedBracketSelectors||[],t.unbalancedBracketSelectors||[]))}loadGrammar(o){return this._loadGrammar(o,0,null,null,null)}async _loadGrammar(o,e,t,n,r){const s=new yn(this._syncRegistry,o);for(;s.Q.length>0;)await Promise.all(s.Q.map(i=>this._loadSingleGrammar(i.scopeName))),s.processQueue();return this._grammarForScopeName(o,e,t,n,r)}async _loadSingleGrammar(o){return this._ensureGrammarCache.has(o)||this._ensureGrammarCache.set(o,this._doLoadSingleGrammar(o)),this._ensureGrammarCache.get(o)}async _doLoadSingleGrammar(o){const e=await this._options.loadGrammar(o);if(e){const t=typeof this._options.getInjections=="function"?this._options.getInjections(o):void 0;this._syncRegistry.addGrammar(e,t)}}async addGrammar(o,e=[],t=0,n=null){return this._syncRegistry.addGrammar(o,e),await this._grammarForScopeName(o.scopeName,t,n)}_grammarForScopeName(o,e=0,t=null,n=null,r=null){return this._syncRegistry.grammarForScopeName(o,e,t,n,r)}};const Vn=ae.NULL,M={LANGUAGEID_MASK:255,TOKEN_TYPE_MASK:768,BALANCED_BRACKETS_MASK:1024,FONT_STYLE_MASK:14336,FOREGROUND_MASK:8372224,BACKGROUND_MASK:4286578688,LANGUAGEID_OFFSET:0,TOKEN_TYPE_OFFSET:8,BALANCED_BRACKETS_OFFSET:10,FONT_STYLE_OFFSET:11,FOREGROUND_OFFSET:15,BACKGROUND_OFFSET:24};class W{static toBinaryStr(e){let t=e.toString(2);for(;t.length<32;)t=`0${t}`;return t}static getLanguageId(e){return(e&M.LANGUAGEID_MASK)>>>M.LANGUAGEID_OFFSET}static getTokenType(e){return(e&M.TOKEN_TYPE_MASK)>>>M.TOKEN_TYPE_OFFSET}static getFontStyle(e){return(e&M.FONT_STYLE_MASK)>>>M.FONT_STYLE_OFFSET}static getForeground(e){return(e&M.FOREGROUND_MASK)>>>M.FOREGROUND_OFFSET}static getBackground(e){return(e&M.BACKGROUND_MASK)>>>M.BACKGROUND_OFFSET}static containsBalancedBrackets(e){return(e&M.BALANCED_BRACKETS_MASK)!==0}static set(e,t,n,r,s,i){let l=W.getLanguageId(e),a=W.getTokenType(e),c=W.getFontStyle(e),u=W.getForeground(e),p=W.getBackground(e);const d=W.containsBalancedBrackets(e)?1:0;return t!==0&&(l=t),n!==0&&(a=n===8?0:n),r!==U.NotSet&&(c=r),s!==0&&(u=s),i!==0&&(p=i),(l<<M.LANGUAGEID_OFFSET|a<<M.TOKEN_TYPE_OFFSET|c<<M.FONT_STYLE_OFFSET|d<<M.BALANCED_BRACKETS_OFFSET|u<<M.FOREGROUND_OFFSET|p<<M.BACKGROUND_OFFSET)>>>0}}function Se(o,e=!1){var s;const t=o.split(/(\r?\n)/g);let n=0;const r=[];for(let i=0;i<t.length;i+=2){const l=e?t[i]+(t[i+1]||""):t[i];r.push([l,n]),n+=t[i].length,n+=((s=t[i+1])==null?void 0:s.length)||0}return r}function Ge(o){return!o||["plaintext","txt","text","plain"].includes(o)}function Xn(o){return o==="ansi"||Ge(o)}function Ue(o){return o==="none"}function Qn(o){return Ue(o)}function Ct(o,e){var n;if(!e)return o;o.properties||(o.properties={}),(n=o.properties).class||(n.class=[]),typeof o.properties.class=="string"&&(o.properties.class=o.properties.class.split(/\s+/g)),Array.isArray(o.properties.class)||(o.properties.class=[]);const t=Array.isArray(e)?e:e.split(/\s+/g);for(const r of t)r&&!o.properties.class.includes(r)&&o.properties.class.push(r);return o}function Jn(o,e){let t=0;const n=[];for(const r of e)r>t&&n.push({...o,content:o.content.slice(t,r),offset:o.offset+t}),t=r;return t<o.content.length&&n.push({...o,content:o.content.slice(t),offset:o.offset+t}),n}function Zn(o,e){const t=Array.from(e instanceof Set?e:new Set(e)).sort((n,r)=>n-r);return t.length?o.map(n=>n.flatMap(r=>{const s=t.filter(i=>r.offset<i&&i<r.offset+r.content.length).map(i=>i-r.offset).sort((i,l)=>i-l);return s.length?Jn(r,s):r})):o}function ve(o,e){const t=typeof o=="string"?{}:{...o.colorReplacements},n=typeof o=="string"?o:o.name;for(const[r,s]of Object.entries((e==null?void 0:e.colorReplacements)||{}))typeof s=="string"?t[r]=s:r===n&&Object.assign(t,s);return t}function H(o,e){return o&&((e==null?void 0:e[o==null?void 0:o.toLowerCase()])||o)}function kt(o){const e={};return o.color&&(e.color=o.color),o.bgColor&&(e["background-color"]=o.bgColor),o.fontStyle&&(o.fontStyle&U.Italic&&(e["font-style"]="italic"),o.fontStyle&U.Bold&&(e["font-weight"]="bold"),o.fontStyle&U.Underline&&(e["text-decoration"]="underline")),e}function Tt(o){return Object.entries(o).map(([e,t])=>`${e}:${t}`).join(";")}function er(o){const e=Se(o,!0).map(([r])=>r);function t(r){let s=r,i=0;for(const l of e){if(s<l.length)break;s-=l.length,i++}return{line:i,character:s}}function n(r,s){let i=0;for(let l=0;l<r;l++)i+=e[l].length;return i+=s,i}return{lines:e,indexToPos:t,posToIndex:n}}var z=["black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite"],$e={1:"bold",2:"dim",3:"italic",4:"underline",7:"reverse",9:"strikethrough"};function tr(o,e){const t=o.indexOf("\x1B[",e);if(t!==-1){const n=o.indexOf("m",t);return{sequence:o.substring(t+2,n).split(";"),startPosition:t,position:n+1}}return{position:o.length}}function At(o,e){let t=1;const n=o[e+t++];let r;if(n==="2"){const s=[o[e+t++],o[e+t++],o[e+t]].map(i=>Number.parseInt(i));s.length===3&&!s.some(i=>Number.isNaN(i))&&(r={type:"rgb",rgb:s})}else if(n==="5"){const s=Number.parseInt(o[e+t]);Number.isNaN(s)||(r={type:"table",index:Number(s)})}return[t,r]}function nr(o){const e=[];for(let t=0;t<o.length;t++){const n=o[t],r=Number.parseInt(n);if(!Number.isNaN(r))if(r===0)e.push({type:"resetAll"});else if(r<=9)$e[r]&&e.push({type:"setDecoration",value:$e[r]});else if(r<=29){const s=$e[r-20];s&&e.push({type:"resetDecoration",value:s})}else if(r<=37)e.push({type:"setForegroundColor",value:{type:"named",name:z[r-30]}});else if(r===38){const[s,i]=At(o,t);i&&e.push({type:"setForegroundColor",value:i}),t+=s}else if(r===39)e.push({type:"resetForegroundColor"});else if(r<=47)e.push({type:"setBackgroundColor",value:{type:"named",name:z[r-40]}});else if(r===48){const[s,i]=At(o,t);i&&e.push({type:"setBackgroundColor",value:i}),t+=s}else r===49?e.push({type:"resetBackgroundColor"}):r>=90&&r<=97?e.push({type:"setForegroundColor",value:{type:"named",name:z[r-90+8]}}):r>=100&&r<=107&&e.push({type:"setBackgroundColor",value:{type:"named",name:z[r-100+8]}})}return e}function rr(){let o=null,e=null,t=new Set;return{parse(n){const r=[];let s=0;do{const i=tr(n,s),l=i.sequence?n.substring(s,i.startPosition):n.substring(s);if(l.length>0&&r.push({value:l,foreground:o,background:e,decorations:new Set(t)}),i.sequence){const a=nr(i.sequence);for(const c of a)c.type==="resetAll"?(o=null,e=null,t.clear()):c.type==="resetForegroundColor"?o=null:c.type==="resetBackgroundColor"?e=null:c.type==="resetDecoration"&&t.delete(c.value);for(const c of a)c.type==="setForegroundColor"?o=c.value:c.type==="setBackgroundColor"?e=c.value:c.type==="setDecoration"&&t.add(c.value)}s=i.position}while(s<n.length);return r}}}var or={black:"#000000",red:"#bb0000",green:"#00bb00",yellow:"#bbbb00",blue:"#0000bb",magenta:"#ff00ff",cyan:"#00bbbb",white:"#eeeeee",brightBlack:"#555555",brightRed:"#ff5555",brightGreen:"#00ff00",brightYellow:"#ffff55",brightBlue:"#5555ff",brightMagenta:"#ff55ff",brightCyan:"#55ffff",brightWhite:"#ffffff"};function sr(o=or){function e(l){return o[l]}function t(l){return`#${l.map(a=>Math.max(0,Math.min(a,255)).toString(16).padStart(2,"0")).join("")}`}let n;function r(){if(n)return n;n=[];for(let c=0;c<z.length;c++)n.push(e(z[c]));let l=[0,95,135,175,215,255];for(let c=0;c<6;c++)for(let u=0;u<6;u++)for(let p=0;p<6;p++)n.push(t([l[c],l[u],l[p]]));let a=8;for(let c=0;c<24;c++,a+=10)n.push(t([a,a,a]));return n}function s(l){return r()[l]}function i(l){switch(l.type){case"named":return e(l.name);case"rgb":return t(l.rgb);case"table":return s(l.index)}}return{value:i}}function ir(o,e,t){const n=ve(o,t),r=Se(e),s=sr(Object.fromEntries(z.map(l=>{var a;return[l,(a=o.colors)==null?void 0:a[`terminal.ansi${l[0].toUpperCase()}${l.substring(1)}`]]}))),i=rr();return r.map(l=>i.parse(l[0]).map(a=>{let c,u;a.decorations.has("reverse")?(c=a.background?s.value(a.background):o.bg,u=a.foreground?s.value(a.foreground):o.fg):(c=a.foreground?s.value(a.foreground):o.fg,u=a.background?s.value(a.background):void 0),c=H(c,n),u=H(u,n),a.decorations.has("dim")&&(c=ar(c));let p=U.None;return a.decorations.has("bold")&&(p|=U.Bold),a.decorations.has("italic")&&(p|=U.Italic),a.decorations.has("underline")&&(p|=U.Underline),{content:a.value,offset:l[1],color:c,bgColor:u,fontStyle:p}}))}function ar(o){const e=o.match(/#([0-9a-f]{3})([0-9a-f]{3})?([0-9a-f]{2})?/);if(e)if(e[3]){const n=Math.round(Number.parseInt(e[3],16)/2).toString(16).padStart(2,"0");return`#${e[1]}${e[2]}${n}`}else return e[2]?`#${e[1]}${e[2]}80`:`#${Array.from(e[1]).map(n=>`${n}${n}`).join("")}80`;const t=o.match(/var\((--[\w-]+-ansi-[\w-]+)\)/);return t?`var(${t[1]}-dim)`:o}class E extends Error{constructor(e){super(e),this.name="ShikiError"}}class xt{constructor(e,t,n){h(this,"_stack");h(this,"lang");h(this,"theme");this._stack=e,this.lang=t,this.theme=n}get scopes(){return lr(this._stack)}toJSON(){return{lang:this.lang,theme:this.theme,scopes:this.scopes}}}function lr(o){const e=[],t=new Set;function n(r){var i;if(t.has(r))return;t.add(r);const s=(i=r==null?void 0:r.nameScopesList)==null?void 0:i.scopeName;s&&e.push(s),r.parent&&n(r.parent)}return n(o),e}function cr(o){if(!(o instanceof xt))throw new E("Invalid grammar state");return o._stack}function We(o,e,t={}){const{lang:n="text",theme:r=o.getLoadedThemes()[0]}=t;if(Ge(n)||Ue(r))return Se(e).map(a=>[{content:a[0],offset:a[1]}]);const{theme:s,colorMap:i}=o.setTheme(r);if(n==="ansi")return ir(s,e,t);const l=o.getLanguage(n);if(t.grammarState){if(t.grammarState.lang!==l.name)throw new E(`Grammar state language "${t.grammarState.lang}" does not match highlight language "${l.name}"`);if(t.grammarState.theme!==r)throw new E(`Grammar state theme "${t.grammarState.theme}" does not match highlight theme "${r}"`)}return hr(e,l,s,i,t)}function ur(o,e,t={}){const{lang:n="text",theme:r=o.getLoadedThemes()[0]}=t;if(Ge(n)||Ue(r))throw new E("Plain language does not have grammar state");if(n==="ansi")throw new E("ANSI language does not have grammar state");const{theme:s,colorMap:i}=o.setTheme(r),l=o.getLanguage(n);return new xt(je(e,l,s,i,t).stateStack,l.name,s.name)}function hr(o,e,t,n,r){return je(o,e,t,n,r).tokens}function je(o,e,t,n,r){const s=ve(t,r),{tokenizeMaxLineLength:i=0,tokenizeTimeLimit:l=500}=r,a=Se(o);let c=r.grammarState?cr(r.grammarState):r.grammarContextCode!=null?je(r.grammarContextCode,e,t,n,{...r,grammarState:void 0,grammarContextCode:void 0}).stateStack:Vn,u=[];const p=[],d=[];if(r.includeExplanation)for(const m of t.settings){let f;switch(typeof m.scope){case"string":f=m.scope.split(/,/).map(g=>g.trim());break;case"object":f=m.scope;break;default:continue}d.push({settings:m,selectors:f.map(g=>g.split(/ /))})}for(let m=0,f=a.length;m<f;m++){const[g,y]=a[m];if(g===""){u=[],p.push([]);continue}if(i>0&&g.length>=i){u=[],p.push([{content:g,offset:y,color:"",fontStyle:0}]);continue}let _,C,S;r.includeExplanation&&(_=e.tokenizeLine(g,c),C=_.tokens,S=0);const v=e.tokenizeLine2(g,c,l),w=v.tokens.length/2;for(let k=0;k<w;k++){const N=v.tokens[2*k],O=k+1<w?v.tokens[2*k+2]:g.length;if(N===O)continue;const x=v.tokens[2*k+1],j=H(n[W.getForeground(x)],s),nn=W.getFontStyle(x),Pe={content:g.substring(N,O),offset:y+N,color:j,fontStyle:nn};if(r.includeExplanation){Pe.explanation=[];let et=0;for(;N+et<O;){const Re=C[S],tt=g.substring(Re.startIndex,Re.endIndex);et+=tt.length,Pe.explanation.push({content:tt,scopes:dr(d,Re.scopes)}),S+=1}}u.push(Pe)}p.push(u),u=[],c=v.ruleStack}return{tokens:p,stateStack:c}}function dr(o,e){const t=[];for(let n=0,r=e.length;n<r;n++){const s=e.slice(0,n),i=e[n];t[n]={scopeName:i,themeMatches:gr(o,i,s)}}return t}function Nt(o,e){return o===e||e.substring(0,o.length)===o&&e[o.length]==="."}function pr(o,e,t){if(!Nt(o[o.length-1],e))return!1;let n=o.length-2,r=t.length-1;for(;n>=0&&r>=0;)Nt(o[n],t[r])&&(n-=1),r-=1;return n===-1}function gr(o,e,t){const n=[];for(const{selectors:r,settings:s}of o)for(const i of r)if(pr(i,e,t)){n.push(s);break}return n}function Et(o,e,t){const n=Object.entries(t.themes).filter(s=>s[1]).map(s=>({color:s[0],theme:s[1]})),r=mr(...n.map(s=>We(o,e,{...t,theme:s.theme})));return r[0].map((s,i)=>s.map((l,a)=>{const c={content:l.content,variants:{},offset:l.offset};return"includeExplanation"in t&&t.includeExplanation&&(c.explanation=l.explanation),r.forEach((u,p)=>{const{content:d,explanation:m,offset:f,...g}=u[i][a];c.variants[n[p].color]=g}),c}))}function mr(...o){const e=o.map(()=>[]),t=o.length;for(let n=0;n<o[0].length;n++){const r=o.map(a=>a[n]),s=e.map(()=>[]);e.forEach((a,c)=>a.push(s[c]));const i=r.map(()=>0),l=r.map(a=>a[0]);for(;l.every(a=>a);){const a=Math.min(...l.map(c=>c.content.length));for(let c=0;c<t;c++){const u=l[c];u.content.length===a?(s[c].push(u),i[c]+=1,l[c]=r[c][i[c]]):(s[c].push({...u,content:u.content.slice(0,a)}),l[c]={...u,content:u.content.slice(a),offset:u.offset+a})}}}return e}function _e(o,e,t){let n,r,s,i,l;if("themes"in t){const{defaultColor:a="light",cssVariablePrefix:c="--shiki-"}=t,u=Object.entries(t.themes).filter(g=>g[1]).map(g=>({color:g[0],theme:g[1]})).sort((g,y)=>g.color===a?-1:y.color===a?1:0);if(u.length===0)throw new E("`themes` option must not be empty");const p=Et(o,e,t);if(a&&!u.find(g=>g.color===a))throw new E(`\`themes\` option must contain the defaultColor key \`${a}\``);const d=u.map(g=>o.getTheme(g.theme)),m=u.map(g=>g.color);s=p.map(g=>g.map(y=>fr(y,m,c,a)));const f=u.map(g=>ve(g.theme,t));r=u.map((g,y)=>(y===0&&a?"":`${c+g.color}:`)+(H(d[y].fg,f[y])||"inherit")).join(";"),n=u.map((g,y)=>(y===0&&a?"":`${c+g.color}-bg:`)+(H(d[y].bg,f[y])||"inherit")).join(";"),i=`shiki-themes ${d.map(g=>g.name).join(" ")}`,l=a?void 0:[r,n].join(";")}else if("theme"in t){const a=ve(t.theme,t.colorReplacements);s=We(o,e,t);const c=o.getTheme(t.theme);n=H(c.bg,a),r=H(c.fg,a),i=c.name}else throw new E("Invalid options, either `theme` or `themes` must be provided");return{tokens:s,fg:r,bg:n,themeName:i,rootStyle:l}}function fr(o,e,t,n){const r={content:o.content,explanation:o.explanation,offset:o.offset},s=e.map(a=>kt(o.variants[a])),i=new Set(s.flatMap(a=>Object.keys(a))),l=s.reduce((a,c,u)=>{for(const p of i){const d=c[p]||"inherit";if(u===0&&n)a[p]=d;else{const m=p==="color"?"":p==="background-color"?"-bg":`-${p}`,f=t+e[u]+(p==="color"?"":m);a[p]?a[p]+=`;${f}:${d}`:a[p]=`${f}:${d}`}}return a},{});return r.htmlStyle=n?Tt(l):Object.values(l).join(";"),r}function br(){const o=new WeakMap;function e(n){if(!o.has(n.meta)){let r=function(l){return typeof l=="number"?{...s.indexToPos(l),offset:l}:{...l,offset:s.posToIndex(l.line,l.character)}};const s=er(n.source),i=(n.options.decorations||[]).map(l=>({...l,start:r(l.start),end:r(l.end)}));t(i),o.set(n.meta,{decorations:i,converter:s,source:n.source})}return o.get(n.meta)}function t(n){for(let r=0;r<n.length;r++){const s=n[r];if(s.start.offset>s.end.offset)throw new E(`Invalid decoration range: ${JSON.stringify(s.start)} - ${JSON.stringify(s.end)}`);for(let i=r+1;i<n.length;i++){const l=n[i],a=s.start.offset<l.start.offset&&l.start.offset<s.end.offset,c=s.start.offset<l.end.offset&&l.end.offset<s.end.offset,u=l.start.offset<s.start.offset&&s.start.offset<l.end.offset,p=l.start.offset<s.end.offset&&s.end.offset<l.end.offset;if(a||c||u||p){if(c&&c||u&&p)continue;throw new E(`Decorations ${JSON.stringify(s.start)} and ${JSON.stringify(l.start)} intersect.`)}}}}return{name:"shiki:decorations",tokens(n){var s;if(!((s=this.options.decorations)!=null&&s.length))return;const r=e(this).decorations.flatMap(i=>[i.start.offset,i.end.offset]);return Zn(n,r)},code(n){var p;if(!((p=this.options.decorations)!=null&&p.length))return;const r=e(this),s=Array.from(n.children).filter(d=>d.type==="element"&&d.tagName==="span");if(s.length!==r.converter.lines.length)throw new E(`Number of lines in code element (${s.length}) does not match the number of lines in the source (${r.converter.lines.length}). Failed to apply decorations.`);function i(d,m,f,g){const y=s[d];let _="",C=-1,S=-1;function v(k){return k.type==="text"?k.value:k.type==="element"?k.children.map(v).join(""):""}if(m===0&&(C=0),f===0&&(S=0),f===Number.POSITIVE_INFINITY&&(S=y.children.length),C===-1||S===-1)for(let k=0;k<y.children.length;k++)_+=v(y.children[k]),C===-1&&_.length===m&&(C=k+1),S===-1&&_.length===f&&(S=k+1);if(C===-1)throw new E(`Failed to find start index for decoration ${JSON.stringify(g.start)}`);if(S===-1)throw new E(`Failed to find end index for decoration ${JSON.stringify(g.end)}`);const w=y.children.slice(C,S);if(!g.alwaysWrap&&w.length===y.children.length)a(y,g,"line");else if(!g.alwaysWrap&&w.length===1&&w[0].type==="element")a(w[0],g,"token");else{const k={type:"element",tagName:"span",properties:{},children:w};a(k,g,"wrapper"),y.children.splice(C,w.length,k)}}function l(d,m){s[d]=a(s[d],m,"line")}function a(d,m,f){var _;const g=m.properties||{},y=m.transform||(C=>C);return d.tagName=m.tagName||"span",d.properties={...d.properties,...g,class:d.properties.class},(_=m.properties)!=null&&_.class&&Ct(d,m.properties.class),d=y(d,f)||d,d}const c=[],u=r.decorations.sort((d,m)=>m.start.offset-d.start.offset);for(const d of u){const{start:m,end:f}=d;if(m.line===f.line)i(m.line,m.character,f.character,d);else if(m.line<f.line){i(m.line,m.character,Number.POSITIVE_INFINITY,d);for(let g=m.line+1;g<f.line;g++)c.unshift(()=>l(g,d));i(f.line,0,f.character,d)}}c.forEach(d=>d())}}}const yr=[br()];function we(o){return[...o.transformers||[],...yr]}function Ce(o,e,t,n={meta:{},options:t,codeToHast:(r,s)=>Ce(o,r,s),codeToTokens:(r,s)=>_e(o,r,s)}){var d,m;let r=e;for(const f of we(t))r=((d=f.preprocess)==null?void 0:d.call(n,r,t))||r;let{tokens:s,fg:i,bg:l,themeName:a,rootStyle:c}=_e(o,r,t);const{mergeWhitespaces:u=!0}=t;u===!0?s=vr(s):u==="never"&&(s=_r(s));const p={...n,get source(){return r}};for(const f of we(t))s=((m=f.tokens)==null?void 0:m.call(p,s))||s;return Sr(s,{...t,fg:i,bg:l,themeName:a,rootStyle:c},p)}function Sr(o,e,t){var d,m,f;const n=we(e),r=[],s={type:"root",children:[]},{structure:i="classic"}=e;let l={type:"element",tagName:"pre",properties:{class:`shiki ${e.themeName||""}`,style:e.rootStyle||`background-color:${e.bg};color:${e.fg}`,tabindex:"0",...Object.fromEntries(Array.from(Object.entries(e.meta||{})).filter(([g])=>!g.startsWith("_")))},children:[]},a={type:"element",tagName:"code",properties:{},children:r};const c=[],u={...t,structure:i,addClassToHast:Ct,get source(){return t.source},get tokens(){return o},get options(){return e},get root(){return s},get pre(){return l},get code(){return a},get lines(){return c}};if(o.forEach((g,y)=>{var S,v;y&&(i==="inline"?s.children.push({type:"element",tagName:"br",properties:{},children:[]}):i==="classic"&&r.push({type:"text",value:`
`}));let _={type:"element",tagName:"span",properties:{class:"line"},children:[]},C=0;for(const w of g){let k={type:"element",tagName:"span",properties:{},children:[{type:"text",value:w.content}]};const N=w.htmlStyle||Tt(kt(w));N&&(k.properties.style=N);for(const O of n)k=((S=O==null?void 0:O.span)==null?void 0:S.call(u,k,y+1,C,_))||k;i==="inline"?s.children.push(k):i==="classic"&&_.children.push(k),C+=w.content.length}if(i==="classic"){for(const w of n)_=((v=w==null?void 0:w.line)==null?void 0:v.call(u,_,y+1))||_;c.push(_),r.push(_)}}),i==="classic"){for(const g of n)a=((d=g==null?void 0:g.code)==null?void 0:d.call(u,a))||a;l.children.push(a);for(const g of n)l=((m=g==null?void 0:g.pre)==null?void 0:m.call(u,l))||l;s.children.push(l)}let p=s;for(const g of n)p=((f=g==null?void 0:g.root)==null?void 0:f.call(u,p))||p;return p}function vr(o){return o.map(e=>{const t=[];let n="",r=0;return e.forEach((s,i)=>{const l=!(s.fontStyle&&s.fontStyle&U.Underline);l&&s.content.match(/^\s+$/)&&e[i+1]?(r||(r=s.offset),n+=s.content):n?(l?t.push({...s,offset:r,content:n+s.content}):t.push({content:n,offset:r},s),r=0,n=""):t.push(s)}),t})}function _r(o){return o.map(e=>e.flatMap(t=>{if(t.content.match(/^\s+$/))return t;const n=t.content.match(/^(\s*)(.*?)(\s*)$/);if(!n)return t;const[,r,s,i]=n;if(!r&&!i)return t;const l=[{...t,offset:t.offset+r.length,content:s}];return r&&l.unshift({content:r,offset:t.offset}),i&&l.push({content:i,offset:t.offset+r.length+s.length}),l}))}const wr=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"];class le{constructor(e,t,n){this.property=e,this.normal=t,n&&(this.space=n)}}le.prototype.property={},le.prototype.normal={},le.prototype.space=null;function Lt(o,e){const t={},n={};let r=-1;for(;++r<o.length;)Object.assign(t,o[r].property),Object.assign(n,o[r].normal);return new le(t,n,e)}function He(o){return o.toLowerCase()}class G{constructor(e,t){this.property=e,this.attribute=t}}G.prototype.space=null,G.prototype.boolean=!1,G.prototype.booleanish=!1,G.prototype.overloadedBoolean=!1,G.prototype.number=!1,G.prototype.commaSeparated=!1,G.prototype.spaceSeparated=!1,G.prototype.commaOrSpaceSeparated=!1,G.prototype.mustUseProperty=!1,G.prototype.defined=!1;let Cr=0;const T=q(),L=q(),Pt=q(),b=q(),A=q(),Q=q(),F=q();function q(){return 2**++Cr}var ze=Object.freeze({__proto__:null,boolean:T,booleanish:L,commaOrSpaceSeparated:F,commaSeparated:Q,number:b,overloadedBoolean:Pt,spaceSeparated:A});const qe=Object.keys(ze);class Ke extends G{constructor(e,t,n,r){let s=-1;if(super(e,t),Rt(this,"space",r),typeof n=="number")for(;++s<qe.length;){const i=qe[s];Rt(this,qe[s],(n&ze[i])===ze[i])}}}Ke.prototype.defined=!0;function Rt(o,e,t){t&&(o[e]=t)}const kr={}.hasOwnProperty;function J(o){const e={},t={};let n;for(n in o.properties)if(kr.call(o.properties,n)){const r=o.properties[n],s=new Ke(n,o.transform(o.attributes||{},n),r,o.space);o.mustUseProperty&&o.mustUseProperty.includes(n)&&(s.mustUseProperty=!0),e[n]=s,t[He(n)]=n,t[He(s.attribute)]=n}return new le(e,t,o.space)}const It=J({space:"xlink",transform(o,e){return"xlink:"+e.slice(5).toLowerCase()},properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null}}),Mt=J({space:"xml",transform(o,e){return"xml:"+e.slice(3).toLowerCase()},properties:{xmlLang:null,xmlBase:null,xmlSpace:null}});function Ot(o,e){return e in o?o[e]:e}function Dt(o,e){return Ot(o,e.toLowerCase())}const Bt=J({space:"xmlns",attributes:{xmlnsxlink:"xmlns:xlink"},transform:Dt,properties:{xmlns:null,xmlnsXLink:null}}),Ft=J({transform(o,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()},properties:{ariaActiveDescendant:null,ariaAtomic:L,ariaAutoComplete:null,ariaBusy:L,ariaChecked:L,ariaColCount:b,ariaColIndex:b,ariaColSpan:b,ariaControls:A,ariaCurrent:null,ariaDescribedBy:A,ariaDetails:null,ariaDisabled:L,ariaDropEffect:A,ariaErrorMessage:null,ariaExpanded:L,ariaFlowTo:A,ariaGrabbed:L,ariaHasPopup:null,ariaHidden:L,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:A,ariaLevel:b,ariaLive:null,ariaModal:L,ariaMultiLine:L,ariaMultiSelectable:L,ariaOrientation:null,ariaOwns:A,ariaPlaceholder:null,ariaPosInSet:b,ariaPressed:L,ariaReadOnly:L,ariaRelevant:null,ariaRequired:L,ariaRoleDescription:A,ariaRowCount:b,ariaRowIndex:b,ariaRowSpan:b,ariaSelected:L,ariaSetSize:b,ariaSort:null,ariaValueMax:b,ariaValueMin:b,ariaValueNow:b,ariaValueText:null,role:null}}),Tr=J({space:"html",attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},transform:Dt,mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Q,acceptCharset:A,accessKey:A,action:null,allow:null,allowFullScreen:T,allowPaymentRequest:T,allowUserMedia:T,alt:null,as:null,async:T,autoCapitalize:null,autoComplete:A,autoFocus:T,autoPlay:T,blocking:A,capture:null,charSet:null,checked:T,cite:null,className:A,cols:b,colSpan:null,content:null,contentEditable:L,controls:T,controlsList:A,coords:b|Q,crossOrigin:null,data:null,dateTime:null,decoding:null,default:T,defer:T,dir:null,dirName:null,disabled:T,download:Pt,draggable:L,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:T,formTarget:null,headers:A,height:b,hidden:T,high:b,href:null,hrefLang:null,htmlFor:A,httpEquiv:A,id:null,imageSizes:null,imageSrcSet:null,inert:T,inputMode:null,integrity:null,is:null,isMap:T,itemId:null,itemProp:A,itemRef:A,itemScope:T,itemType:A,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:T,low:b,manifest:null,max:null,maxLength:b,media:null,method:null,min:null,minLength:b,multiple:T,muted:T,name:null,nonce:null,noModule:T,noValidate:T,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:T,optimum:b,pattern:null,ping:A,placeholder:null,playsInline:T,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:T,referrerPolicy:null,rel:A,required:T,reversed:T,rows:b,rowSpan:b,sandbox:A,scope:null,scoped:T,seamless:T,selected:T,shadowRootDelegatesFocus:T,shadowRootMode:null,shape:null,size:b,sizes:null,slot:null,span:b,spellCheck:L,src:null,srcDoc:null,srcLang:null,srcSet:null,start:b,step:null,style:null,tabIndex:b,target:null,title:null,translate:null,type:null,typeMustMatch:T,useMap:null,value:L,width:b,wrap:null,align:null,aLink:null,archive:A,axis:null,background:null,bgColor:null,border:b,borderColor:null,bottomMargin:b,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:T,declare:T,event:null,face:null,frame:null,frameBorder:null,hSpace:b,leftMargin:b,link:null,longDesc:null,lowSrc:null,marginHeight:b,marginWidth:b,noResize:T,noHref:T,noShade:T,noWrap:T,object:null,profile:null,prompt:null,rev:null,rightMargin:b,rules:null,scheme:null,scrolling:L,standby:null,summary:null,text:null,topMargin:b,valueType:null,version:null,vAlign:null,vLink:null,vSpace:b,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:T,disableRemotePlayback:T,prefix:null,property:null,results:b,security:null,unselectable:null}}),Ar=J({space:"svg",attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},transform:Ot,properties:{about:F,accentHeight:b,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:b,amplitude:b,arabicForm:null,ascent:b,attributeName:null,attributeType:null,azimuth:b,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:b,by:null,calcMode:null,capHeight:b,className:A,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:b,diffuseConstant:b,direction:null,display:null,dur:null,divisor:b,dominantBaseline:null,download:T,dx:null,dy:null,edgeMode:null,editable:null,elevation:b,enableBackground:null,end:null,event:null,exponent:b,externalResourcesRequired:null,fill:null,fillOpacity:b,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Q,g2:Q,glyphName:Q,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:b,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:b,horizOriginX:b,horizOriginY:b,id:null,ideographic:b,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:b,k:b,k1:b,k2:b,k3:b,k4:b,kernelMatrix:F,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:b,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:b,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:b,overlineThickness:b,paintOrder:null,panose1:null,path:null,pathLength:b,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:A,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:b,pointsAtY:b,pointsAtZ:b,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:F,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:F,rev:F,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:F,requiredFeatures:F,requiredFonts:F,requiredFormats:F,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:b,specularExponent:b,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:b,strikethroughThickness:b,string:null,stroke:null,strokeDashArray:F,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:b,strokeOpacity:b,strokeWidth:null,style:null,surfaceScale:b,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:F,tabIndex:b,tableValues:null,target:null,targetX:b,targetY:b,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:F,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:b,underlineThickness:b,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:b,values:null,vAlphabetic:b,vMathematical:b,vectorEffect:null,vHanging:b,vIdeographic:b,version:null,vertAdvY:b,vertOriginX:b,vertOriginY:b,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:b,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null}}),xr=/^data[-\w.:]+$/i,Gt=/-[a-z]/g,Nr=/[A-Z]/g;function Er(o,e){const t=He(e);let n=e,r=G;if(t in o.normal)return o.property[o.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&xr.test(e)){if(e.charAt(4)==="-"){const s=e.slice(5).replace(Gt,Pr);n="data"+s.charAt(0).toUpperCase()+s.slice(1)}else{const s=e.slice(4);if(!Gt.test(s)){let i=s.replace(Nr,Lr);i.charAt(0)!=="-"&&(i="-"+i),e="data"+i}}r=Ke}return new r(n,e)}function Lr(o){return"-"+o.toLowerCase()}function Pr(o){return o.charAt(1).toUpperCase()}const Rr=Lt([Mt,It,Bt,Ft,Tr],"html"),Ut=Lt([Mt,It,Bt,Ft,Ar],"svg"),$t={}.hasOwnProperty;function Ir(o,e){const t=e||{};function n(r,...s){let i=n.invalid;const l=n.handlers;if(r&&$t.call(r,o)){const a=String(r[o]);i=$t.call(l,a)?l[a]:n.unknown}if(i)return i.call(this,r,...s)}return n.handlers=t.handlers||{},n.invalid=t.invalid,n.unknown=t.unknown,n}function Mr(o,e){if(o=o.replace(e.subset?Or(e.subset):/["&'<>`]/g,n),e.subset||e.escapeOnly)return o;return o.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,t).replace(/[\x01-\t\v\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,n);function t(r,s,i){return e.format((r.charCodeAt(0)-55296)*1024+r.charCodeAt(1)-56320+65536,i.charCodeAt(s+2),e)}function n(r,s,i){return e.format(r.charCodeAt(0),i.charCodeAt(s+1),e)}}function Or(o){const e=[];let t=-1;for(;++t<o.length;)e.push(o[t].replace(/[|\\{}()[\]^$+*?.]/g,"\\$&"));return new RegExp("(?:"+e.join("|")+")","g")}function Dr(o,e,t){const n="&#x"+o.toString(16).toUpperCase();return t&&e&&!/[\dA-Fa-f]/.test(String.fromCharCode(e))?n:n+";"}function Br(o,e,t){const n="&#"+String(o);return t&&e&&!/\d/.test(String.fromCharCode(e))?n:n+";"}const Fr=["AElig","AMP","Aacute","Acirc","Agrave","Aring","Atilde","Auml","COPY","Ccedil","ETH","Eacute","Ecirc","Egrave","Euml","GT","Iacute","Icirc","Igrave","Iuml","LT","Ntilde","Oacute","Ocirc","Ograve","Oslash","Otilde","Ouml","QUOT","REG","THORN","Uacute","Ucirc","Ugrave","Uuml","Yacute","aacute","acirc","acute","aelig","agrave","amp","aring","atilde","auml","brvbar","ccedil","cedil","cent","copy","curren","deg","divide","eacute","ecirc","egrave","eth","euml","frac12","frac14","frac34","gt","iacute","icirc","iexcl","igrave","iquest","iuml","laquo","lt","macr","micro","middot","nbsp","not","ntilde","oacute","ocirc","ograve","ordf","ordm","oslash","otilde","ouml","para","plusmn","pound","quot","raquo","reg","sect","shy","sup1","sup2","sup3","szlig","thorn","times","uacute","ucirc","ugrave","uml","uuml","yacute","yen","yuml"],Ye={nbsp:"\xA0",iexcl:"\xA1",cent:"\xA2",pound:"\xA3",curren:"\xA4",yen:"\xA5",brvbar:"\xA6",sect:"\xA7",uml:"\xA8",copy:"\xA9",ordf:"\xAA",laquo:"\xAB",not:"\xAC",shy:"\xAD",reg:"\xAE",macr:"\xAF",deg:"\xB0",plusmn:"\xB1",sup2:"\xB2",sup3:"\xB3",acute:"\xB4",micro:"\xB5",para:"\xB6",middot:"\xB7",cedil:"\xB8",sup1:"\xB9",ordm:"\xBA",raquo:"\xBB",frac14:"\xBC",frac12:"\xBD",frac34:"\xBE",iquest:"\xBF",Agrave:"\xC0",Aacute:"\xC1",Acirc:"\xC2",Atilde:"\xC3",Auml:"\xC4",Aring:"\xC5",AElig:"\xC6",Ccedil:"\xC7",Egrave:"\xC8",Eacute:"\xC9",Ecirc:"\xCA",Euml:"\xCB",Igrave:"\xCC",Iacute:"\xCD",Icirc:"\xCE",Iuml:"\xCF",ETH:"\xD0",Ntilde:"\xD1",Ograve:"\xD2",Oacute:"\xD3",Ocirc:"\xD4",Otilde:"\xD5",Ouml:"\xD6",times:"\xD7",Oslash:"\xD8",Ugrave:"\xD9",Uacute:"\xDA",Ucirc:"\xDB",Uuml:"\xDC",Yacute:"\xDD",THORN:"\xDE",szlig:"\xDF",agrave:"\xE0",aacute:"\xE1",acirc:"\xE2",atilde:"\xE3",auml:"\xE4",aring:"\xE5",aelig:"\xE6",ccedil:"\xE7",egrave:"\xE8",eacute:"\xE9",ecirc:"\xEA",euml:"\xEB",igrave:"\xEC",iacute:"\xED",icirc:"\xEE",iuml:"\xEF",eth:"\xF0",ntilde:"\xF1",ograve:"\xF2",oacute:"\xF3",ocirc:"\xF4",otilde:"\xF5",ouml:"\xF6",divide:"\xF7",oslash:"\xF8",ugrave:"\xF9",uacute:"\xFA",ucirc:"\xFB",uuml:"\xFC",yacute:"\xFD",thorn:"\xFE",yuml:"\xFF",fnof:"\u0192",Alpha:"\u0391",Beta:"\u0392",Gamma:"\u0393",Delta:"\u0394",Epsilon:"\u0395",Zeta:"\u0396",Eta:"\u0397",Theta:"\u0398",Iota:"\u0399",Kappa:"\u039A",Lambda:"\u039B",Mu:"\u039C",Nu:"\u039D",Xi:"\u039E",Omicron:"\u039F",Pi:"\u03A0",Rho:"\u03A1",Sigma:"\u03A3",Tau:"\u03A4",Upsilon:"\u03A5",Phi:"\u03A6",Chi:"\u03A7",Psi:"\u03A8",Omega:"\u03A9",alpha:"\u03B1",beta:"\u03B2",gamma:"\u03B3",delta:"\u03B4",epsilon:"\u03B5",zeta:"\u03B6",eta:"\u03B7",theta:"\u03B8",iota:"\u03B9",kappa:"\u03BA",lambda:"\u03BB",mu:"\u03BC",nu:"\u03BD",xi:"\u03BE",omicron:"\u03BF",pi:"\u03C0",rho:"\u03C1",sigmaf:"\u03C2",sigma:"\u03C3",tau:"\u03C4",upsilon:"\u03C5",phi:"\u03C6",chi:"\u03C7",psi:"\u03C8",omega:"\u03C9",thetasym:"\u03D1",upsih:"\u03D2",piv:"\u03D6",bull:"\u2022",hellip:"\u2026",prime:"\u2032",Prime:"\u2033",oline:"\u203E",frasl:"\u2044",weierp:"\u2118",image:"\u2111",real:"\u211C",trade:"\u2122",alefsym:"\u2135",larr:"\u2190",uarr:"\u2191",rarr:"\u2192",darr:"\u2193",harr:"\u2194",crarr:"\u21B5",lArr:"\u21D0",uArr:"\u21D1",rArr:"\u21D2",dArr:"\u21D3",hArr:"\u21D4",forall:"\u2200",part:"\u2202",exist:"\u2203",empty:"\u2205",nabla:"\u2207",isin:"\u2208",notin:"\u2209",ni:"\u220B",prod:"\u220F",sum:"\u2211",minus:"\u2212",lowast:"\u2217",radic:"\u221A",prop:"\u221D",infin:"\u221E",ang:"\u2220",and:"\u2227",or:"\u2228",cap:"\u2229",cup:"\u222A",int:"\u222B",there4:"\u2234",sim:"\u223C",cong:"\u2245",asymp:"\u2248",ne:"\u2260",equiv:"\u2261",le:"\u2264",ge:"\u2265",sub:"\u2282",sup:"\u2283",nsub:"\u2284",sube:"\u2286",supe:"\u2287",oplus:"\u2295",otimes:"\u2297",perp:"\u22A5",sdot:"\u22C5",lceil:"\u2308",rceil:"\u2309",lfloor:"\u230A",rfloor:"\u230B",lang:"\u2329",rang:"\u232A",loz:"\u25CA",spades:"\u2660",clubs:"\u2663",hearts:"\u2665",diams:"\u2666",quot:'"',amp:"&",lt:"<",gt:">",OElig:"\u0152",oelig:"\u0153",Scaron:"\u0160",scaron:"\u0161",Yuml:"\u0178",circ:"\u02C6",tilde:"\u02DC",ensp:"\u2002",emsp:"\u2003",thinsp:"\u2009",zwnj:"\u200C",zwj:"\u200D",lrm:"\u200E",rlm:"\u200F",ndash:"\u2013",mdash:"\u2014",lsquo:"\u2018",rsquo:"\u2019",sbquo:"\u201A",ldquo:"\u201C",rdquo:"\u201D",bdquo:"\u201E",dagger:"\u2020",Dagger:"\u2021",permil:"\u2030",lsaquo:"\u2039",rsaquo:"\u203A",euro:"\u20AC"},Gr=["cent","copy","divide","gt","lt","not","para","times"],Wt={}.hasOwnProperty,Ve={};let ke;for(ke in Ye)Wt.call(Ye,ke)&&(Ve[Ye[ke]]=ke);function Ur(o,e,t,n){const r=String.fromCharCode(o);if(Wt.call(Ve,r)){const s=Ve[r],i="&"+s;return t&&Fr.includes(s)&&!Gr.includes(s)&&(!n||e&&e!==61&&/[^\da-z]/i.test(String.fromCharCode(e)))?i:i+";"}return""}function $r(o,e,t){let n=Dr(o,e,t.omitOptionalSemicolons),r;if((t.useNamedReferences||t.useShortestReferences)&&(r=Ur(o,e,t.omitOptionalSemicolons,t.attribute)),(t.useShortestReferences||!r)&&t.useShortestReferences){const s=Br(o,e,t.omitOptionalSemicolons);s.length<n.length&&(n=s)}return r&&(!t.useShortestReferences||r.length<n.length)?r:n}function Z(o,e){return Mr(o,Object.assign({format:$r},e))}const Wr=/^>|^->|<!--|-->|--!>|<!-$/g,jr=[">"],Hr=["<",">"];function zr(o,e,t,n){return n.settings.bogusComments?"<?"+Z(o.value,Object.assign({},n.settings.characterReferences,{subset:jr}))+">":"<!--"+o.value.replace(Wr,r)+"-->";function r(s){return Z(s,Object.assign({},n.settings.characterReferences,{subset:Hr}))}}function qr(o,e,t,n){return"<!"+(n.settings.upperDoctype?"DOCTYPE":"doctype")+(n.settings.tightDoctype?"":" ")+"html>"}function jt(o,e){const t=String(o);if(typeof e!="string")throw new TypeError("Expected character");let n=0,r=t.indexOf(e);for(;r!==-1;)n++,r=t.indexOf(e,r+e.length);return n}function Kr(o,e){const t=e||{};return(o[o.length-1]===""?[...o,""]:o).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}function Yr(o){return o.join(" ").trim()}const Vr=/[ \t\n\f\r]/g;function Xe(o){return typeof o=="object"?o.type==="text"?Ht(o.value):!1:Ht(o)}function Ht(o){return o.replace(Vr,"")===""}const P=qt(1),zt=qt(-1),Xr=[];function qt(o){return e;function e(t,n,r){const s=t?t.children:Xr;let i=(n||0)+o,l=s[i];if(!r)for(;l&&Xe(l);)i+=o,l=s[i];return l}}const Qr={}.hasOwnProperty;function Kt(o){return e;function e(t,n,r){return Qr.call(o,t.tagName)&&o[t.tagName](t,n,r)}}const Qe=Kt({body:Zr,caption:Je,colgroup:Je,dd:ro,dt:no,head:Je,html:Jr,li:to,optgroup:oo,option:so,p:eo,rp:Yt,rt:Yt,tbody:ao,td:Vt,tfoot:lo,th:Vt,thead:io,tr:co});function Je(o,e,t){const n=P(t,e,!0);return!n||n.type!=="comment"&&!(n.type==="text"&&Xe(n.value.charAt(0)))}function Jr(o,e,t){const n=P(t,e);return!n||n.type!=="comment"}function Zr(o,e,t){const n=P(t,e);return!n||n.type!=="comment"}function eo(o,e,t){const n=P(t,e);return n?n.type==="element"&&(n.tagName==="address"||n.tagName==="article"||n.tagName==="aside"||n.tagName==="blockquote"||n.tagName==="details"||n.tagName==="div"||n.tagName==="dl"||n.tagName==="fieldset"||n.tagName==="figcaption"||n.tagName==="figure"||n.tagName==="footer"||n.tagName==="form"||n.tagName==="h1"||n.tagName==="h2"||n.tagName==="h3"||n.tagName==="h4"||n.tagName==="h5"||n.tagName==="h6"||n.tagName==="header"||n.tagName==="hgroup"||n.tagName==="hr"||n.tagName==="main"||n.tagName==="menu"||n.tagName==="nav"||n.tagName==="ol"||n.tagName==="p"||n.tagName==="pre"||n.tagName==="section"||n.tagName==="table"||n.tagName==="ul"):!t||!(t.type==="element"&&(t.tagName==="a"||t.tagName==="audio"||t.tagName==="del"||t.tagName==="ins"||t.tagName==="map"||t.tagName==="noscript"||t.tagName==="video"))}function to(o,e,t){const n=P(t,e);return!n||n.type==="element"&&n.tagName==="li"}function no(o,e,t){const n=P(t,e);return!!(n&&n.type==="element"&&(n.tagName==="dt"||n.tagName==="dd"))}function ro(o,e,t){const n=P(t,e);return!n||n.type==="element"&&(n.tagName==="dt"||n.tagName==="dd")}function Yt(o,e,t){const n=P(t,e);return!n||n.type==="element"&&(n.tagName==="rp"||n.tagName==="rt")}function oo(o,e,t){const n=P(t,e);return!n||n.type==="element"&&n.tagName==="optgroup"}function so(o,e,t){const n=P(t,e);return!n||n.type==="element"&&(n.tagName==="option"||n.tagName==="optgroup")}function io(o,e,t){const n=P(t,e);return!!(n&&n.type==="element"&&(n.tagName==="tbody"||n.tagName==="tfoot"))}function ao(o,e,t){const n=P(t,e);return!n||n.type==="element"&&(n.tagName==="tbody"||n.tagName==="tfoot")}function lo(o,e,t){return!P(t,e)}function co(o,e,t){const n=P(t,e);return!n||n.type==="element"&&n.tagName==="tr"}function Vt(o,e,t){const n=P(t,e);return!n||n.type==="element"&&(n.tagName==="td"||n.tagName==="th")}const uo=Kt({body:go,colgroup:mo,head:po,html:ho,tbody:fo});function ho(o){const e=P(o,-1);return!e||e.type!=="comment"}function po(o){const e=o.children,t=[];let n=-1;for(;++n<e.length;){const r=e[n];if(r.type==="element"&&(r.tagName==="title"||r.tagName==="base")){if(t.includes(r.tagName))return!1;t.push(r.tagName)}}return e.length>0}function go(o){const e=P(o,-1,!0);return!e||e.type!=="comment"&&!(e.type==="text"&&Xe(e.value.charAt(0)))&&!(e.type==="element"&&(e.tagName==="meta"||e.tagName==="link"||e.tagName==="script"||e.tagName==="style"||e.tagName==="template"))}function mo(o,e,t){const n=zt(t,e),r=P(o,-1,!0);return t&&n&&n.type==="element"&&n.tagName==="colgroup"&&Qe(n,t.children.indexOf(n),t)?!1:!!(r&&r.type==="element"&&r.tagName==="col")}function fo(o,e,t){const n=zt(t,e),r=P(o,-1);return t&&n&&n.type==="element"&&(n.tagName==="thead"||n.tagName==="tbody")&&Qe(n,t.children.indexOf(n),t)?!1:!!(r&&r.type==="element"&&r.tagName==="tr")}const Te={name:[[`	
\f\r &/=>`.split(""),`	
\f\r "&'/=>\``.split("")],[`\0	
\f\r "&'/<=>`.split(""),`\0	
\f\r "&'/<=>\``.split("")]],unquoted:[[`	
\f\r &>`.split(""),`\0	
\f\r "&'<=>\``.split("")],[`\0	
\f\r "&'<=>\``.split(""),`\0	
\f\r "&'<=>\``.split("")]],single:[["&'".split(""),"\"&'`".split("")],["\0&'".split(""),"\0\"&'`".split("")]],double:[['"&'.split(""),"\"&'`".split("")],['\0"&'.split(""),"\0\"&'`".split("")]]};function bo(o,e,t,n){const r=n.schema,s=r.space==="svg"?!1:n.settings.omitOptionalTags;let i=r.space==="svg"?n.settings.closeEmptyElements:n.settings.voids.includes(o.tagName.toLowerCase());const l=[];let a;r.space==="html"&&o.tagName==="svg"&&(n.schema=Ut);const c=yo(n,o.properties),u=n.all(r.space==="html"&&o.tagName==="template"?o.content:o);return n.schema=r,u&&(i=!1),(c||!s||!uo(o,e,t))&&(l.push("<",o.tagName,c?" "+c:""),i&&(r.space==="svg"||n.settings.closeSelfClosing)&&(a=c.charAt(c.length-1),(!n.settings.tightSelfClosing||a==="/"||a&&a!=='"'&&a!=="'")&&l.push(" "),l.push("/")),l.push(">")),l.push(u),!i&&(!s||!Qe(o,e,t))&&l.push("</"+o.tagName+">"),l.join("")}function yo(o,e){const t=[];let n=-1,r;if(e){for(r in e)if(e[r]!==null&&e[r]!==void 0){const s=So(o,r,e[r]);s&&t.push(s)}}for(;++n<t.length;){const s=o.settings.tightAttributes?t[n].charAt(t[n].length-1):void 0;n!==t.length-1&&s!=='"'&&s!=="'"&&(t[n]+=" ")}return t.join("")}function So(o,e,t){const n=Er(o.schema,e),r=o.settings.allowParseErrors&&o.schema.space==="html"?0:1,s=o.settings.allowDangerousCharacters?0:1;let i=o.quote,l;if(n.overloadedBoolean&&(t===n.attribute||t==="")?t=!0:(n.boolean||n.overloadedBoolean&&typeof t!="string")&&(t=!!t),t==null||t===!1||typeof t=="number"&&Number.isNaN(t))return"";const a=Z(n.attribute,Object.assign({},o.settings.characterReferences,{subset:Te.name[r][s]}));return t===!0||(t=Array.isArray(t)?(n.commaSeparated?Kr:Yr)(t,{padLeft:!o.settings.tightCommaSeparatedLists}):String(t),o.settings.collapseEmptyAttributes&&!t)?a:(o.settings.preferUnquoted&&(l=Z(t,Object.assign({},o.settings.characterReferences,{attribute:!0,subset:Te.unquoted[r][s]}))),l!==t&&(o.settings.quoteSmart&&jt(t,i)>jt(t,o.alternative)&&(i=o.alternative),l=i+Z(t,Object.assign({},o.settings.characterReferences,{subset:(i==="'"?Te.single:Te.double)[r][s],attribute:!0}))+i),a+(l&&"="+l))}const vo=["<","&"];function Xt(o,e,t,n){return t&&t.type==="element"&&(t.tagName==="script"||t.tagName==="style")?o.value:Z(o.value,Object.assign({},n.settings.characterReferences,{subset:vo}))}function _o(o,e,t,n){return n.settings.allowDangerousHtml?o.value:Xt(o,e,t,n)}function wo(o,e,t,n){return n.all(o)}const Co=Ir("type",{invalid:ko,unknown:To,handlers:{comment:zr,doctype:qr,element:bo,raw:_o,root:wo,text:Xt}});function ko(o){throw new Error("Expected node, not `"+o+"`")}function To(o){const e=o;throw new Error("Cannot compile unknown node `"+e.type+"`")}const Ao={},xo={},No=[];function Eo(o,e){const t=Ao,n=t.quote||'"',r=n==='"'?"'":'"';if(n!=='"'&&n!=="'")throw new Error("Invalid quote `"+n+"`, expected `'` or `\"`");return{one:Lo,all:Po,settings:{omitOptionalTags:t.omitOptionalTags||!1,allowParseErrors:t.allowParseErrors||!1,allowDangerousCharacters:t.allowDangerousCharacters||!1,quoteSmart:t.quoteSmart||!1,preferUnquoted:t.preferUnquoted||!1,tightAttributes:t.tightAttributes||!1,upperDoctype:t.upperDoctype||!1,tightDoctype:t.tightDoctype||!1,bogusComments:t.bogusComments||!1,tightCommaSeparatedLists:t.tightCommaSeparatedLists||!1,tightSelfClosing:t.tightSelfClosing||!1,collapseEmptyAttributes:t.collapseEmptyAttributes||!1,allowDangerousHtml:t.allowDangerousHtml||!1,voids:t.voids||wr,characterReferences:t.characterReferences||xo,closeSelfClosing:t.closeSelfClosing||!1,closeEmptyElements:t.closeEmptyElements||!1},schema:t.space==="svg"?Ut:Rr,quote:n,alternative:r}.one(Array.isArray(o)?{type:"root",children:o}:o,void 0,void 0)}function Lo(o,e,t){return Co(o,e,t,this)}function Po(o){const e=[],t=o&&o.children||No;let n=-1;for(;++n<t.length;)e[n]=this.one(t[n],n,o);return e.join("")}function Ro(o,e,t){var s;const n={meta:{},options:t,codeToHast:(i,l)=>Ce(o,i,l),codeToTokens:(i,l)=>_e(o,i,l)};let r=Eo(Ce(o,e,t,n));for(const i of we(t))r=((s=i.postprocess)==null?void 0:s.call(n,r,t))||r;return r}async function Io(o){let e,t;const n={};function r(g){t=g,n.HEAPU8=new Uint8Array(g),n.HEAPU32=new Uint32Array(g)}function s(){return typeof performance<"u"?performance.now():Date.now()}function i(g,y,_){n.HEAPU8.copyWithin(g,y,y+_)}function l(){return 2147483648}function a(g){try{return e.grow(g-t.byteLength+65535>>>16),r(e.buffer),1}catch{}}function c(g){const y=n.HEAPU8.length;g=g>>>0;const _=l();if(g>_)return!1;const C=(S,v)=>S+(v-S%v)%v;for(let S=1;S<=4;S*=2){let v=y*(1+.2/S);v=Math.min(v,g+100663296);const w=Math.min(_,C(Math.max(g,v),65536));if(a(w))return!0}return!1}const u=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function p(g,y,_=1024){const C=y+_;let S=y;for(;g[S]&&!(S>=C);)++S;if(S-y>16&&g.buffer&&u)return u.decode(g.subarray(y,S));let v="";for(;y<S;){let w=g[y++];if(!(w&128)){v+=String.fromCharCode(w);continue}const k=g[y++]&63;if((w&224)===192){v+=String.fromCharCode((w&31)<<6|k);continue}const N=g[y++]&63;if((w&240)===224?w=(w&15)<<12|k<<6|N:w=(w&7)<<18|k<<12|N<<6|g[y++]&63,w<65536)v+=String.fromCharCode(w);else{const O=w-65536;v+=String.fromCharCode(55296|O>>10,56320|O&1023)}}return v}function d(g,y){return g?p(n.HEAPU8,g,y):""}const m={emscripten_get_now:s,emscripten_memcpy_big:i,emscripten_resize_heap:c,fd_write:()=>0};async function f(){const g=await o({env:m,wasi_snapshot_preview1:m});e=g.memory,r(e.buffer),Object.assign(n,g),n.UTF8ToString=d}return await f(),n}let R=null,Mo=!1;function Oo(o){throw new E(o.UTF8ToString(o.getLastOnigError()))}class Le{constructor(e){h(this,"utf16Length");h(this,"utf8Length");h(this,"utf16Value");h(this,"utf8Value");h(this,"utf16OffsetToUtf8");h(this,"utf8OffsetToUtf16");const t=e.length,n=Le._utf8ByteLength(e),r=n!==t,s=r?new Uint32Array(t+1):null;r&&(s[t]=n);const i=r?new Uint32Array(n+1):null;r&&(i[n]=t);const l=new Uint8Array(n);let a=0;for(let c=0;c<t;c++){const u=e.charCodeAt(c);let p=u,d=!1;if(u>=55296&&u<=56319&&c+1<t){const m=e.charCodeAt(c+1);m>=56320&&m<=57343&&(p=(u-55296<<10)+65536|m-56320,d=!0)}r&&(s[c]=a,d&&(s[c+1]=a),p<=127?i[a+0]=c:p<=2047?(i[a+0]=c,i[a+1]=c):p<=65535?(i[a+0]=c,i[a+1]=c,i[a+2]=c):(i[a+0]=c,i[a+1]=c,i[a+2]=c,i[a+3]=c)),p<=127?l[a++]=p:p<=2047?(l[a++]=192|(p&1984)>>>6,l[a++]=128|(p&63)>>>0):p<=65535?(l[a++]=224|(p&61440)>>>12,l[a++]=128|(p&4032)>>>6,l[a++]=128|(p&63)>>>0):(l[a++]=240|(p&1835008)>>>18,l[a++]=128|(p&258048)>>>12,l[a++]=128|(p&4032)>>>6,l[a++]=128|(p&63)>>>0),d&&c++}this.utf16Length=t,this.utf8Length=n,this.utf16Value=e,this.utf8Value=l,this.utf16OffsetToUtf8=s,this.utf8OffsetToUtf16=i}static _utf8ByteLength(e){let t=0;for(let n=0,r=e.length;n<r;n++){const s=e.charCodeAt(n);let i=s,l=!1;if(s>=55296&&s<=56319&&n+1<r){const a=e.charCodeAt(n+1);a>=56320&&a<=57343&&(i=(s-55296<<10)+65536|a-56320,l=!0)}i<=127?t+=1:i<=2047?t+=2:i<=65535?t+=3:t+=4,l&&n++}return t}createString(e){const t=e.omalloc(this.utf8Length);return e.HEAPU8.set(this.utf8Value,t),t}}const B=class B{constructor(e){h(this,"id",++B.LAST_ID);h(this,"_onigBinding");h(this,"content");h(this,"utf16Length");h(this,"utf8Length");h(this,"utf16OffsetToUtf8");h(this,"utf8OffsetToUtf16");h(this,"ptr");if(!R)throw new E("Must invoke loadWasm first.");this._onigBinding=R,this.content=e;const t=new Le(e);this.utf16Length=t.utf16Length,this.utf8Length=t.utf8Length,this.utf16OffsetToUtf8=t.utf16OffsetToUtf8,this.utf8OffsetToUtf16=t.utf8OffsetToUtf16,this.utf8Length<1e4&&!B._sharedPtrInUse?(B._sharedPtr||(B._sharedPtr=R.omalloc(1e4)),B._sharedPtrInUse=!0,R.HEAPU8.set(t.utf8Value,B._sharedPtr),this.ptr=B._sharedPtr):this.ptr=t.createString(R)}convertUtf8OffsetToUtf16(e){return this.utf8OffsetToUtf16?e<0?0:e>this.utf8Length?this.utf16Length:this.utf8OffsetToUtf16[e]:e}convertUtf16OffsetToUtf8(e){return this.utf16OffsetToUtf8?e<0?0:e>this.utf16Length?this.utf8Length:this.utf16OffsetToUtf8[e]:e}dispose(){this.ptr===B._sharedPtr?B._sharedPtrInUse=!1:this._onigBinding.ofree(this.ptr)}};h(B,"LAST_ID",0),h(B,"_sharedPtr",0),h(B,"_sharedPtrInUse",!1);let Ae=B;class Do{constructor(e){h(this,"_onigBinding");h(this,"_ptr");if(!R)throw new E("Must invoke loadWasm first.");const t=[],n=[];for(let l=0,a=e.length;l<a;l++){const c=new Le(e[l]);t[l]=c.createString(R),n[l]=c.utf8Length}const r=R.omalloc(4*e.length);R.HEAPU32.set(t,r/4);const s=R.omalloc(4*e.length);R.HEAPU32.set(n,s/4);const i=R.createOnigScanner(r,s,e.length);for(let l=0,a=e.length;l<a;l++)R.ofree(t[l]);R.ofree(s),R.ofree(r),i===0&&Oo(R),this._onigBinding=R,this._ptr=i}dispose(){this._onigBinding.freeOnigScanner(this._ptr)}findNextMatchSync(e,t,n){let r=Mo,s=0;if(typeof n=="number"?(n&8&&(r=!0),s=n):typeof n=="boolean"&&(r=n),typeof e=="string"){e=new Ae(e);const i=this._findNextMatchSync(e,t,r,s);return e.dispose(),i}return this._findNextMatchSync(e,t,r,s)}_findNextMatchSync(e,t,n,r){const s=this._onigBinding;let i;if(n?i=s.findNextOnigScannerMatchDbg(this._ptr,e.id,e.ptr,e.utf8Length,e.convertUtf16OffsetToUtf8(t),r):i=s.findNextOnigScannerMatch(this._ptr,e.id,e.ptr,e.utf8Length,e.convertUtf16OffsetToUtf8(t),r),i===0)return null;const l=s.HEAPU32;let a=i/4;const c=l[a++],u=l[a++],p=[];for(let d=0;d<u;d++){const m=e.convertUtf8OffsetToUtf16(l[a++]),f=e.convertUtf8OffsetToUtf16(l[a++]);p[d]={start:m,end:f,length:f-m}}return{index:c,captureIndices:p}}}function Bo(o){return typeof o.instantiator=="function"}function Fo(o){return typeof o.default=="function"}function Go(o){return typeof o.data<"u"}function Uo(o){return typeof Response<"u"&&o instanceof Response}function $o(o){var e,t;return typeof ArrayBuffer<"u"&&(o instanceof ArrayBuffer||ArrayBuffer.isView(o))||typeof nt<"u"&&((t=(e=nt).isBuffer)==null?void 0:t.call(e,o))||typeof SharedArrayBuffer<"u"&&o instanceof SharedArrayBuffer||typeof Uint32Array<"u"&&o instanceof Uint32Array}let xe;function Qt(o){if(xe)return xe;async function e(){R=await Io(async t=>{let n=o;return n=await n,typeof n=="function"&&(n=await n(t)),typeof n=="function"&&(n=await n(t)),Bo(n)?n=await n.instantiator(t):Fo(n)?n=await n.default(t):(Go(n)&&(n=n.data),Uo(n)?typeof WebAssembly.instantiateStreaming=="function"?n=await Wo(n)(t):n=await jo(n)(t):$o(n)?n=await Ze(n)(t):n instanceof WebAssembly.Module?n=await Ze(n)(t):"default"in n&&n.default instanceof WebAssembly.Module&&(n=await Ze(n.default)(t))),"instance"in n&&(n=n.instance),"exports"in n&&(n=n.exports),n})}return xe=e(),xe}function Ze(o){return e=>WebAssembly.instantiate(o,e)}function Wo(o){return e=>WebAssembly.instantiateStreaming(o,e)}function jo(o){return async e=>{const t=await o.arrayBuffer();return WebAssembly.instantiate(t,e)}}function Ho(o){return new Ae(o)}function zo(o){return new Do(o)}const Jt={light:"#333333",dark:"#bbbbbb"},Zt={light:"#fffffe",dark:"#1e1e1e"},en="__shiki_resolved";function tn(o){var l,a,c,u,p;if(o!=null&&o[en])return o;const e={...o};e.tokenColors&&!e.settings&&(e.settings=e.tokenColors,delete e.tokenColors),e.type||(e.type="dark"),e.colorReplacements={...e.colorReplacements},e.settings||(e.settings=[]);let{bg:t,fg:n}=e;if(!t||!n){const d=e.settings?e.settings.find(m=>!m.name&&!m.scope):void 0;(l=d==null?void 0:d.settings)!=null&&l.foreground&&(n=d.settings.foreground),(a=d==null?void 0:d.settings)!=null&&a.background&&(t=d.settings.background),!n&&((c=e==null?void 0:e.colors)!=null&&c["editor.foreground"])&&(n=e.colors["editor.foreground"]),!t&&((u=e==null?void 0:e.colors)!=null&&u["editor.background"])&&(t=e.colors["editor.background"]),n||(n=e.type==="light"?Jt.light:Jt.dark),t||(t=e.type==="light"?Zt.light:Zt.dark),e.fg=n,e.bg=t}e.settings[0]&&e.settings[0].settings&&!e.settings[0].scope||e.settings.unshift({settings:{foreground:e.fg,background:e.bg}});let r=0;const s=new Map;function i(d){var f;if(s.has(d))return s.get(d);r+=1;const m=`#${r.toString(16).padStart(8,"0").toLowerCase()}`;return(f=e.colorReplacements)!=null&&f[`#${m}`]?i(d):(s.set(d,m),m)}e.settings=e.settings.map(d=>{var y,_;const m=((y=d.settings)==null?void 0:y.foreground)&&!d.settings.foreground.startsWith("#"),f=((_=d.settings)==null?void 0:_.background)&&!d.settings.background.startsWith("#");if(!m&&!f)return d;const g={...d,settings:{...d.settings}};if(m){const C=i(d.settings.foreground);e.colorReplacements[C]=d.settings.foreground,g.settings.foreground=C}if(f){const C=i(d.settings.background);e.colorReplacements[C]=d.settings.background,g.settings.background=C}return g});for(const d of Object.keys(e.colors||{}))if((d==="editor.foreground"||d==="editor.background"||d.startsWith("terminal.ansi"))&&!((p=e.colors[d])!=null&&p.startsWith("#"))){const m=i(e.colors[d]);e.colorReplacements[m]=e.colors[d],e.colors[d]=m}return Object.defineProperty(e,en,{enumerable:!1,writable:!1,value:!0}),e}class qo extends Yn{constructor(t,n,r,s={}){super(t);h(this,"_resolver");h(this,"_themes");h(this,"_langs");h(this,"_alias");h(this,"_resolvedThemes",new Map);h(this,"_resolvedGrammars",new Map);h(this,"_langMap",new Map);h(this,"_langGraph",new Map);h(this,"_textmateThemeCache",new WeakMap);h(this,"_loadedThemesCache",null);h(this,"_loadedLanguagesCache",null);this._resolver=t,this._themes=n,this._langs=r,this._alias=s,n.forEach(i=>this.loadTheme(i)),r.forEach(i=>this.loadLanguage(i))}getTheme(t){return typeof t=="string"?this._resolvedThemes.get(t):this.loadTheme(t)}loadTheme(t){const n=tn(t);return n.name&&(this._resolvedThemes.set(n.name,n),this._loadedThemesCache=null),n}getLoadedThemes(){return this._loadedThemesCache||(this._loadedThemesCache=[...this._resolvedThemes.keys()]),this._loadedThemesCache}setTheme(t){let n=this._textmateThemeCache.get(t);n||(n=be.createFromRawTheme(t),this._textmateThemeCache.set(t,n)),this._syncRegistry.setTheme(n)}getGrammar(t){if(this._alias[t]){const n=new Set([t]);for(;this._alias[t];){if(t=this._alias[t],n.has(t))throw new E(`Circular alias \`${Array.from(n).join(" -> ")} -> ${t}\``);n.add(t)}}return this._resolvedGrammars.get(t)}async loadLanguage(t){var i,l,a,c;if(this.getGrammar(t.name))return;const n=new Set([...this._langMap.values()].filter(u=>{var p;return(p=u.embeddedLangsLazy)==null?void 0:p.includes(t.name)}));this._resolver.addLanguage(t);const r={balancedBracketSelectors:t.balancedBracketSelectors||["*"],unbalancedBracketSelectors:t.unbalancedBracketSelectors||[]};this._syncRegistry._rawGrammars.set(t.scopeName,t);const s=await this.loadGrammarWithConfiguration(t.scopeName,1,r);if(s.name=t.name,this._resolvedGrammars.set(t.name,s),t.aliases&&t.aliases.forEach(u=>{this._alias[u]=t.name}),this._loadedLanguagesCache=null,n.size)for(const u of n)this._resolvedGrammars.delete(u.name),this._loadedLanguagesCache=null,(l=(i=this._syncRegistry)==null?void 0:i._injectionGrammars)==null||l.delete(u.scopeName),(c=(a=this._syncRegistry)==null?void 0:a._grammars)==null||c.delete(u.scopeName),await this.loadLanguage(this._langMap.get(u.name))}async init(){this._themes.map(t=>this.loadTheme(t)),await this.loadLanguages(this._langs)}dispose(){super.dispose(),this._resolvedThemes.clear(),this._resolvedGrammars.clear(),this._langMap.clear(),this._langGraph.clear(),this._loadedThemesCache=null}async loadLanguages(t){for(const s of t)this.resolveEmbeddedLanguages(s);const n=Array.from(this._langGraph.entries()),r=n.filter(([s,i])=>!i);if(r.length){const s=n.filter(([i,l])=>{var a;return l&&((a=l.embeddedLangs)==null?void 0:a.some(c=>r.map(([u])=>u).includes(c)))}).filter(i=>!r.includes(i));throw new E(`Missing languages ${r.map(([i])=>`\`${i}\``).join(", ")}, required by ${s.map(([i])=>`\`${i}\``).join(", ")}`)}for(const[s,i]of n)this._resolver.addLanguage(i);for(const[s,i]of n)await this.loadLanguage(i)}getLoadedLanguages(){return this._loadedLanguagesCache||(this._loadedLanguagesCache=[...new Set([...this._resolvedGrammars.keys(),...Object.keys(this._alias)])]),this._loadedLanguagesCache}resolveEmbeddedLanguages(t){if(this._langMap.set(t.name,t),this._langGraph.set(t.name,t),t.embeddedLangs)for(const n of t.embeddedLangs)this._langGraph.set(n,this._langMap.get(n))}}class Ko{constructor(e,t){h(this,"_langs",new Map);h(this,"_scopeToLang",new Map);h(this,"_injections",new Map);h(this,"_onigLibPromise");this._onigLibPromise=e,t.forEach(n=>this.addLanguage(n))}get onigLib(){return this._onigLibPromise}getLangRegistration(e){return this._langs.get(e)}async loadGrammar(e){return this._scopeToLang.get(e)}addLanguage(e){this._langs.set(e.name,e),e.aliases&&e.aliases.forEach(t=>{this._langs.set(t,e)}),this._scopeToLang.set(e.scopeName,e),e.injectTo&&e.injectTo.forEach(t=>{this._injections.get(t)||this._injections.set(t,[]),this._injections.get(t).push(e.scopeName)})}getInjections(e){const t=e.split(".");let n=[];for(let r=1;r<=t.length;r++){const s=t.slice(0,r).join(".");n=[...n,...this._injections.get(s)||[]]}return n}}let Yo,ce=0;async function Vo(o={}){ce+=1,o.warnings!==!1&&ce>=10&&ce%10===0&&console.warn(`[Shiki] ${ce} instances have been created. Shiki is supposed to be used as a singleton, consider refactoring your code to cache your highlighter instance; Or call \`highlighter.dispose()\` to release unused instances.`);let e=!1;async function t(S){return Promise.resolve(typeof S=="function"?S():S).then(v=>v.default||v)}async function n(S){return Array.from(new Set((await Promise.all(S.filter(v=>!Xn(v)).map(async v=>await t(v).then(w=>Array.isArray(w)?w:[w])))).flat()))}const r=o.loadWasm||Yo,[s,i]=await Promise.all([Promise.all((o.themes||[]).map(t)).then(S=>S.map(tn)),n(o.langs||[]),r?Qt(r):void 0]),l=new Ko(Promise.resolve({createOnigScanner(S){return zo(S)},createOnigString(S){return Ho(S)}}),i),a=new qo(l,s,i,o.langAlias);await a.init();let c;function u(S){_();const v=a.getGrammar(typeof S=="string"?S:S.name);if(!v)throw new E(`Language \`${S}\` not found, you may need to load it first`);return v}function p(S){if(S==="none")return{bg:"",fg:"",name:"none",settings:[],type:"dark"};_();const v=a.getTheme(S);if(!v)throw new E(`Theme \`${S}\` not found, you may need to load it first`);return v}function d(S){_();const v=p(S);c!==S&&(a.setTheme(v),c=S);const w=a.getColorMap();return{theme:v,colorMap:w}}function m(){return _(),a.getLoadedThemes()}function f(){return _(),a.getLoadedLanguages()}async function g(...S){_(),await a.loadLanguages(await n(S))}async function y(...S){_(),await Promise.all(S.map(async v=>Qn(v)?null:a.loadTheme(await t(v))))}function _(){if(e)throw new E("Shiki instance has been disposed")}function C(){e||(e=!0,a.dispose(),ce-=1)}return{setTheme:d,getTheme:p,getLanguage:u,getLoadedThemes:m,getLoadedLanguages:f,loadLanguage:g,loadTheme:y,dispose:C,[Symbol.dispose]:C}}async function Xo(o={}){const e=await Vo(o);return{getLastGrammarState:(t,n)=>ur(e,t,n),codeToTokensBase:(t,n)=>We(e,t,n),codeToTokensWithThemes:(t,n)=>Et(e,t,n),codeToTokens:(t,n)=>_e(e,t,n),codeToHast:(t,n)=>Ce(e,t,n),codeToHtml:(t,n)=>Ro(e,t,n),...e,getInternalContext:()=>e}}function Ne(o,e){this.init(o,e)}Ne.instance=function(o,e){return new Ne(o,e)},Ne.prototype={ID:"hit",init:function(o,e){typeof o=="string"?this.el=document.querySelector(o):this.el=o,this.getType(e)==="custom"?(this.highlight=e,this.generate()):console.error("valid config object not provided")},getType:function(o){let e=typeof o;if(o){if(Array.isArray(o))return o.length===2&&typeof o[0]=="number"&&typeof o[1]=="number"?"range":"array";if(e==="object"){if(o instanceof RegExp)return"regexp";if(o.hasOwnProperty("highlight"))return"custom"}else if(e==="function"||e==="string")return e}else return"falsey";return"other"},generate:function(){this.el.classList.add(this.ID+"-input",this.ID+"-content"),this.el.addEventListener("input",this.handleInput.bind(this)),this.el.addEventListener("scroll",this.handleScroll.bind(this)),this.highlights=document.createElement("div"),this.highlights.classList.add(this.ID+"-highlights",this.ID+"-content"),this.backdrop=document.createElement("div"),this.backdrop.classList.add(this.ID+"-backdrop"),this.backdrop.append(this.highlights),this.container=document.createElement("div"),this.container.classList.add(this.ID+"-container"),this.el.parentNode.insertBefore(this.container,this.el.nextSibling),this.container.append(this.backdrop),this.container.append(this.el),this.container.addEventListener("scroll",this.blockContainerScroll.bind(this)),this.handleInput()},handleInput:function(){let o=this.el.value,e=this.getRanges(o,this.highlight),t=this.removeStaggeredRanges(e),n=this.getBoundaries(t);this.renderMarks(n)},getRanges:function(o,e){switch(this.getType(e)){case"array":return this.getArrayRanges(o,e);case"function":return this.getFunctionRanges(o,e);case"regexp":return this.getRegExpRanges(o,e);case"string":return this.getStringRanges(o,e);case"range":return this.getRangeRanges(o,e);case"custom":return this.getCustomRanges(o,e);default:if(e)console.error("unrecognized highlight type");else return[]}},getArrayRanges:function(o,e){let t=e.map(this.getRanges.bind(this,o));return Array.prototype.concat.apply([],t)},getFunctionRanges:function(o,e){return this.getRanges(o,e(o))},getRegExpRanges:function(o,e){let t=[],n;for(;n=e.exec(o),n!==null&&(t.push([n.index,n.index+n[0].length]),!!e.global););return t},getStringRanges:function(o,e){let t=[],n=o.toLowerCase(),r=e.toLowerCase(),s=0;for(;s=n.indexOf(r,s),s!==-1;)t.push([s,s+r.length]),s+=r.length;return t},getRangeRanges:function(o,e){return[e]},getCustomRanges:function(o,e){let t=this.getRanges(o,e.highlight);return e.className&&t.forEach(function(n){n.className?n.className=e.className+" "+n.className:n.className=e.className}),e.blank&&t.forEach(function(n){n.blank=e.blank}),t},removeStaggeredRanges:function(o){let e=[];return o.forEach(function(t){e.some(function(n){let r=t[0]>n[0]&&t[0]<n[1],s=t[1]>n[0]&&t[1]<n[1];return r!==s})||e.push(t)}),e},getBoundaries:function(o){let e=[];return o.forEach(function(t){e.push({type:"start",index:t[0],className:t.className,blank:t.blank}),e.push({type:"stop",index:t[1]})}),this.sortBoundaries(e),e},sortBoundaries:function(o){o.sort(function(e,t){return e.index!==t.index?t.index-e.index:e.type==="stop"&&t.type==="start"?1:e.type==="start"&&t.type==="stop"?-1:0})},renderMarks:function(o){let e=this.el.value;const t=e;o.forEach(function(n,r){let s;n.type==="start"?s="{{hit-mark-start|"+r+"}}":s="{{hit-mark-stop}}",e=e.slice(0,n.index)+s+e.slice(n.index)}),e=e.replace(/\n({{hit-mark-stop}})?$/,`

$1`),e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;"),e=e.replace(/{{hit-mark-start\|(\d+)}}/g,function(n,r){const s=o[+r].className;if(s){let i='<mark class="'+s+'"';if(s==="word"){let l=t.slice(o[+r].index,o[+r-1].index);l=l.replace(/"/g,"&quot;"),i+=' data-word="'+l+'"'}return i+">"}else return"<mark>"}),e=e.replace(/{{hit-mark-stop}}/g,"</mark>"),e+='<mark class="placeholder"> \u26A1 </mark>',this.highlights.innerHTML=e,this.el.dispatchEvent(new CustomEvent("highlights-updated"))},handleScroll:function(){this.backdrop.scrollTop=this.el.scrollTop;let o=this.el.scrollLeft;o>0?this.backdrop.style.transform="translateX("+-o+"px)":this.backdrop.style.transform=""},blockContainerScroll:function(){this.container.scrollLeft=0},destroy:function(){this.container.parentElement.replaceChild(this.el,this.container),this.el.classList.remove(this.ID+"-content",this.ID+"-input")}};export{Ne as H,K as T,Xo as c,Qt as l,ln as n};
