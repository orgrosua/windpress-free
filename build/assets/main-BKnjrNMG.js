import{i as Me,l as De,r as Ve,b as Fe,L as Be,_ as ee,T as Ue,P as He,K as Re,M as Ke,N as Qe,O as Xe}from"./_plugin-vue_export-helper-Cps8Wh2c.js";import{l as te}from"./logger-BTW-zIW3.js";import{a as se,u as Ye}from"./constant-B0a9M2k0.js";import{i as I,a as ae,q as Q,u as X,v as p,x as v,y as b,z as w,A as L,C as S,F as Ge,r as _,w as q,S as le,J as z,K as C,E as M,M as D,Q as V,B as Y,G as Je,H as Ne,D as Ze,T as et}from"./runtime-core.esm-bundler-C0d2UZ6m.js";import{Q as tt}from"./lib-BXT8389d.js";import{__tla as st}from"./build-Km0EQ9ar.js";import{__tla as at}from"./oxide_parser_wasm-8nf_WcM4.js";import{g as lt}from"./intellisense-CgzKx6Lg.js";import{a as nt}from"./index-B-USwDm2.js";import{s as rt}from"./set-qX46P2hw.js";import"./index-BHzFOpFs.js";import"./isObject-B5R9K1Pz.js";import"./preload-helper-Tcd9XBoB.js";import"./_MapCache-C7aBjWBU.js";import"./isSymbol-DJmTqBMq.js";Promise.all([(()=>{try{return st}catch{}})(),(()=>{try{return at}catch{}})()]).then(async()=>{Me({scope:"#windpressbuilderius-variable-app"}),De.add(Ve,Fe);const ne={id:"windpressbuilderius-variable-app-header",class:"bg:$(primary-1) cursor:grab bb:1|solid|$(primary-3)"},re={class:"flex gap:10 align-items:center fg:$(base-2)"},ie={class:"flex px:12 py:2 align-items:center"},oe={class:"text-transform:none font:medium text:center flex-grow:1 gap:10 align-items:center cursor:default px:12 py:2"},ue={__name:"PanelHeader",setup(t){const l=I("variableApp"),n=I("isOpen");function u(){const s=l.querySelector("#windpressbuilderius-variable-app-header");let a=_(!1),i=0,d=0;q(a,f=>{f?(document.body.style.userSelect="none",se.style.pointerEvents="none",s.style.cursor="grabbing"):(document.body.style.removeProperty("user-select"),se.style.removeProperty("pointer-events"),s.style.cursor="grab")});const o=f=>{a.value=!0;const k=s.getBoundingClientRect();i=f.clientX-k.left,d=f.clientY-k.top};s.removeEventListener("mousedown",o),s.addEventListener("mousedown",o);const $=f=>{if(!a.value)return;const k=s.getBoundingClientRect(),A=f.clientX,m=f.clientY,r=A-i,y=m-d,x=r<0?0:r>window.innerWidth-k.width?window.innerWidth-k.width:r,h=y<0?0:y>window.innerHeight-k.height?window.innerHeight-k.height:y;l.style.left=`${x}px`,l.style.top=`${h}px`};document.removeEventListener("mousemove",$),document.addEventListener("mousemove",$);const P=f=>{a.value=!1};document.removeEventListener("mouseup",P),document.addEventListener("mouseup",P)}return ae(()=>{u()}),(s,a)=>{const i=Q("inline-svg"),d=Q("font-awesome-icon"),o=X("tooltip");return p(),v("div",ne,[b("div",re,[b("div",ie,[w(i,{src:L(Be),class:"inline-svg fill:current font:24"},null,8,["src"])]),S((p(),v("div",oe,[Ge(" WindPress ")])),[[o,{placement:"top",content:`v${s.windpressbuilderius._version}`}]]),S((p(),v("button",{onClick:a[0]||(a[0]=$=>n.value=!L(n)),class:"uniPanelIconButton r:0 bg:$(primary-3):hover py:10 px:12"},[w(d,{icon:["fas","xmark"],class:"fg:$(base-2) font:16"})])),[[o,{placement:"top",content:"Close"}]])])])}}},ce={class:"flex-grow:1"},pe={key:0,class:"expansion-panel__body"},de={__name:"ExpansionPanel",props:{namespace:{type:String,required:!0},name:{type:String,required:!0}},setup(t,{expose:l}){const n=t,u=_(null),s=nt(`windpressbuilderius-variable-app.ui.expansion-panels.${n.namespace}`,{[`${n.name}`]:!1},void 0,{mergeDefaults:!0});function a(d){s.value[n.name]=d===null?!s.value[n.name]:d}function i(){u.value.scrollIntoView()}return l({togglePanel:a,scrollIntoView:i}),(d,o)=>{const $=Q("font-awesome-icon");return p(),v("div",{ref_key:"sectionRef",ref:u,class:"expansion-panel mx:10 py:8"},[b("div",{onClick:o[0]||(o[0]=P=>L(s)[t.name]=!L(s)[t.name]),class:"expansion-panel__header flex justify-content:space-between p:10 r:8 cursor:pointer"},[b("div",ce,[le(d.$slots,"header",{},void 0,!0)]),b("div",null,[w($,{icon:["fas","chevron-right"],class:z([{"rotate(-90)":L(s)[t.name]},"~duration:300 font:18"])},null,8,["class"])])]),w(Ue,null,{default:C(()=>[L(s)[t.name]?(p(),v("div",pe,[le(d.$slots,"default",{},void 0,!0)])):M("",!0)]),_:3})],512)}}},F=ee(de,[["__scopeId","data-v-8550ec71"]]),ve={class:"{m:10;pb:15}>div"},me={class:"variable-section-title font:14 my:10"},ye={class:"variable-section-items flex flex:row gap:8 flex-wrap:wrap"},be=["onClick","onMouseenter"],fe={class:"font:14"},G={__name:"CommonVariableItems",props:{variableItems:{type:Object,required:!0}},setup(t){return(l,n)=>{const u=X("tooltip");return p(),v("div",ve,[(p(!0),v(D,null,V(t.variableItems,(s,a)=>(p(),v("div",{key:a,class:""},[b("div",me,Y(a.replace("_","-")),1),b("div",ye,[s.length>0?(p(!0),v(D,{key:0},V(s,(i,d)=>S((p(),v("button",{key:d,onClick:o=>l.$emit("previewChose",o,i.key),onMouseenter:o=>l.$emit("previewEnter",o,i.key),onMouseleave:n[0]||(n[0]=o=>l.$emit("previewLeave")),class:"px:12 py:8 r:8 fg:$(base-1) fg:$(accent-normal):hover bg:$(primary-3) bg:$(primary-2):hover b:0 flex-grow:1 flex-shrink:1 flex-basis:30% cursor:pointer {opacity:.5}>span opacity:100:hover>span"},[b("span",fe,Y(i.label),1)],40,be)),[[u,{placement:"top",content:`var(${i.key}, ${i.value})`}]])),128)):M("",!0)])]))),128))])}}},he={class:"{m:10;pb:15}>div"},ge={class:"variable-section-title font:14 my:10"},we={key:0,class:"variable-section-items"},ke=["onClick","onMouseenter"],_e=["onClick","onMouseenter"],$e={__name:"ColorVariableItems",props:{variableItems:{type:Object,required:!0}},setup(t){return(l,n)=>{const u=X("tooltip");return p(),v("div",he,[(p(!0),v(D,null,V(t.variableItems,(s,a)=>(p(),v("div",{key:a,class:""},[b("div",ge,Y(a),1),s.DEFAULT?(p(),v("div",we,[S(b("button",{onClick:i=>l.$emit("previewChose",i,s.DEFAULT.key),onMouseenter:i=>l.$emit("previewEnter",i,s.DEFAULT.key),onMouseleave:n[0]||(n[0]=i=>l.$emit("previewLeave")),class:z([`bg:$(${s.DEFAULT.key.slice(2)})`,"w:full r:4 h:24 border:1|solid|transparent border:white:hover cursor:pointer"])},null,42,ke),[[u,{placement:"top",content:`var(${s.DEFAULT.key}, ${s.DEFAULT.value})`}]])])):M("",!0),s.shades&&Object.keys(s.shades).length>0?(p(),v("div",{key:1,class:z([[{},Object.keys(s.shades).length>1?"rl:4>div:first-child>button rr:4>div:last-child>button":"",`grid-template-cols:repeat(${Object.keys(s.shades).length},auto)`],"variable-section-items grid r:4 overflow:hidden"])},[(p(!0),v(D,null,V(s.shades,(i,d)=>(p(),v("div",{key:d,class:"flex gap:10"},[S(b("button",{onClick:o=>l.$emit("previewChose",o,i.key),onMouseenter:o=>l.$emit("previewEnter",o,i.key),onMouseleave:n[1]||(n[1]=o=>l.$emit("previewLeave")),class:z([`bg:$(${i.key.slice(2)})`,"w:full h:24 border:1|solid|transparent border:white:hover cursor:pointer"])},null,42,_e),[[u,{placement:"top",content:`var(${i.key}, ${i.value})`}]])]))),128))],2)):M("",!0)]))),128))])}}},B=t=>(Je("data-v-424f778e"),t=t(),Ne(),t),Ee={id:"windpressbuilderius-variable-app-body",class:"rel w:full h:full overflow-y:scroll! bb:1|solid|$(primary-3)>div:not(:last-child)"},xe=B(()=>b("span",{class:"font:semibold"},"Color",-1)),Ce=B(()=>b("span",{class:"font:semibold"},"Typography",-1)),Pe=B(()=>b("span",{class:"font:semibold"},"Sizing",-1)),Ie=1e3,Le={__name:"PanelBody",setup(t){const l=_({colors:{},typography:{},sizing:{}}),n=I("focusedInput"),u=I("recentVariableSelectionTimestamp"),s=I("tempInputValue"),a=I("variableApp");async function i(){const m=await Ye.contentWindow.wp.hooks.applyFilters("windpress.module.design_system.main_css"),r=await lt(await tt(m));let y=a.querySelector("style#windpressbuilderius-variable-app-body-style");y||(y=document.createElement("style"),y.id="windpressbuilderius-variable-app-body-style",a.appendChild(y)),y.innerHTML=`
        #windpressbuilderius-variable-app-body {
            ${r.map(e=>`${e.key}:${e.value};`).join("")}
        }
    `;const x={};r.filter(e=>e.key.startsWith("--color")).forEach(e=>{const c=e.key.slice(8),R=c.split("-");let K="";if(R.length>1){const qe=R[0],ze=R.slice(1).join("-");K=`${qe}.shades.'${ze}'`}else K=`${c}.DEFAULT`;rt(x,K,e)}),l.value.colors=Object.keys(x).sort().reduce((e,c)=>(e[c]=x[c],e),{});const h={font_size:[],line_height:[],letter_spacing:[]};r.filter(e=>e.key.startsWith("--font-size-")&&!e.key.endsWith("--line-height")).forEach(e=>{const c=e.key.slice(12);h.font_size.push({key:e.key,label:c,value:e.value})}),r.filter(e=>e.key.startsWith("--line-height-")||e.key.endsWith("--line-height")).forEach(e=>{const c=e.key.startsWith("--line-height-")?e.key.slice(14):e.key.slice(2,-13);h.line_height.push({key:e.key,label:c,value:e.value})}),h.line_height.sort((e,c)=>e.label.startsWith("font-size-")&&!c.label.startsWith("font-size-")?1:!e.label.startsWith("font-size-")&&c.label.startsWith("font-size-")?-1:0),r.filter(e=>e.key.startsWith("--letter-spacing-")).forEach(e=>{const c=e.key.slice(17);h.letter_spacing.push({key:e.key,label:c,value:e.value})}),l.value.typography=h;const g={spacing:[],width:[],breakpoint:[]};r.filter(e=>e.key.startsWith("--spacing-")).forEach(e=>{const c=e.key.slice(10);g.spacing.push({key:e.key,label:c,value:e.value})}),r.filter(e=>e.key.startsWith("--width-")).forEach(e=>{const c=e.key.slice(8);g.width.push({key:e.key,label:c,value:e.value})}),r.filter(e=>e.key.startsWith("--breakpoint-")).forEach(e=>{const c=e.key.slice(13);g.breakpoint.push({key:e.key,label:c,value:e.value})}),l.value.sizing=g}const d=_(null),o=_(null),$=_(null);q(n,m=>{if(m){const r=m.getAttribute("name"),y=["color","backgroundColor"].some(g=>r.includes(g)),x=["fontSize"].some(g=>r.includes(g)),h=["padding","margin","gap","width","height"].some(g=>r.includes(g));o.value.togglePanel(!1),$.value.togglePanel(!1),d.value.togglePanel(!1),y?(d.value.togglePanel(!0),d.value.scrollIntoView()):x?(o.value.togglePanel(!0),o.value.scrollIntoView()):h&&($.value.togglePanel(!0),$.value.scrollIntoView())}});function P(m,r){const y=Object.getOwnPropertyDescriptor(m,"value").set,x=Object.getPrototypeOf(m),h=Object.getOwnPropertyDescriptor(x,"value").set;y&&y!==h?h.call(m,r):y.call(m,r);const g=new Event("input",{bubbles:!0});m.dispatchEvent(g)}function f(m,r){performance.now()-u.value<Ie||n.value&&P(n.value,`var(${r})`)}function k(m){!n.value||s.value===null||P(n.value,s.value)}function A(m,r){n.value&&(P(n.value,`var(${r})`),s.value=`var(${r})`,u.value=performance.now())}return ae(()=>{i()}),new BroadcastChannel("windpress").addEventListener("message",async m=>{const r=m.data;r.source==="windpress/autocomplete"&&r.task==="windpress.main_css.saved.done"&&setTimeout(()=>{i()},1e3)}),(m,r)=>(p(),v("div",Ee,[w(F,{namespace:"variable",name:"color",ref_key:"sectionColor",ref:d},{header:C(()=>[xe]),default:C(()=>[w($e,{variableItems:l.value.colors,onPreviewEnter:f,onPreviewLeave:k,onPreviewChose:A},null,8,["variableItems"])]),_:1},512),w(F,{namespace:"variable",name:"typography",ref_key:"sectionTypography",ref:o},{header:C(()=>[Ce]),default:C(()=>[w(G,{variableItems:l.value.typography,onPreviewEnter:f,onPreviewLeave:k,onPreviewChose:A},null,8,["variableItems"])]),_:1},512),w(F,{namespace:"variable",name:"spacing",ref_key:"sectionSpacing",ref:$,class:""},{header:C(()=>[Pe]),default:C(()=>[w(G,{variableItems:l.value.sizing,onPreviewEnter:f,onPreviewLeave:k,onPreviewChose:A},null,8,["variableItems"])]),_:1},512)]))}},Se=ee(Le,[["__scopeId","data-v-424f778e"]]),Te={id:"windpressbuilderius-variable-app-container",class:"flex flex:column w:full h:full fg:$(base-2) bg:$(primary-1)"},We={__name:"App",setup(t){const l=I("isOpen");return(n,u)=>S((p(),v("div",Te,[w(ue),(p(),Ze(et,null,{default:C(()=>[w(Se)]),_:1}))],512)),[[He,L(l)]])}};function Oe({selector:t,callback:l,options:n}){const u=new MutationObserver(l),s=document.querySelector(t);if(!s){te(`Target not found for selector: ${t}`,{module:"variable-picker",type:"error"});return}const a={childList:!0,subtree:!0};u.observe(s,Object.assign(Object.assign({},a),n))}const T=document.createElement("windpressbuilderius-variable-app");T.id="windpressbuilderius-variable-app",document.body.appendChild(T);for(const t of document.getElementById("builderius-builder-css").sheet.cssRules)if(t.selectorText&&t.selectorText.includes("#builderiusPanel"))for(let l=0;l<t.style.length;l++){const n=t.style[l];n.startsWith("--")&&T.style.setProperty(n,t.style.getPropertyValue(n).trim())}const W=_(!1),O=_(null),j=_(null),Ae=_(0),U=_(null),E=Re(We);E.config.globalProperties.windpressbuilderius=window.windpressbuilderius,E.provide("variableApp",T),E.provide("isOpen",W),E.provide("focusedInput",O),E.provide("tempInputValue",j),E.provide("recentVariableSelectionTimestamp",Ae),E.use(Ke,{container:"#windpressbuilderius-variable-app"}),E.component("font-awesome-icon",Qe).component("inline-svg",Xe),E.mount("#windpressbuilderius-variable-app");function J(t){var l;!t.shiftKey||!t.target||((l=document==null?void 0:document.getSelection())==null||l.removeAllRanges(),t.preventDefault(),t.stopPropagation(),O.value=t.target,j.value=t.target.value,W.value=!0)}function N(t){O.value=t.target}const je=["div.uniCssInput","div.uniCssColorpicker"];function Z(){setTimeout(()=>{var n;let t=!1;je.forEach(u=>{(typeof u=="string"?[...document.querySelectorAll(u)]:[...document.querySelectorAll(u.selector)].filter(s=>u.hasChild.some(a=>s.querySelector(a)))).forEach(s=>{const a=s.querySelector("input[type='text']");(a==null?void 0:a.getAttribute("windpressbuilderius-variable-app"))!=="listened"&&(a==null||a.removeEventListener("click",J),a==null||a.addEventListener("click",J),a==null||a.removeEventListener("focus",N),a==null||a.addEventListener("focus",N),a==null||a.setAttribute("windpressbuilderius-variable-app","listened"),t=!0)})});const l=document.querySelector("div.uniSystemSelectClasses__valueWrapper span.uniSystemSelectClasses__placeholder")?"%root%":(n=document.querySelector("div.uniSystemSelectClasses__valueWrapper div.uniModuleCssSelectorItemSelected span"))==null?void 0:n.innerText;U.value!==l&&(U.value=l),t&&(O.value=null,j.value=null)},100)}let H=!1;Oe({selector:".uniLeftPanelOuter",options:{subtree:!0,childList:!0},callback(){H||(H=!0,Z(),setTimeout(()=>{H=!1},100))}}),Z(),document.addEventListener("keydown",t=>{t.key==="Escape"&&W.value&&(W.value=!1)}),q(W,t=>{T.style.zIndex=t?"calc(Infinity)":"-1"}),q(U,(t,l)=>{t!==l&&(O.value=null,j.value=null)}),te("Module loaded!",{module:"variable-picker"})});
